Fri 04 Oct 2024 00:14:39 INFO random_seed=2024
use_gpu=True
learning_rate=6e-06
train_batch_size=32
test_batch_size=1
epoch_nums=200
test_step=10
display_train_step=1
gpu_id=5
training_resume=False
load_best_config=False
supervising_mode=fully_supervised
validset_divide=True
test_only=False
shuffle=True
model_config_file=gectoolkit/properties/model/SynGEC.json
best_config_file=gectoolkit/properties/best_config/SynGEC_Visual_YOLO_CLIP.json
dataset_config_file=gectoolkit/properties/dataset/Visual_YOLO_CLIP.json
dataset_dir=dataset/Visual_YOLO_CLIP
checkpoint_file=checkpoint/SynGEC-Visual_YOLO_CLIP.pth
log_file=log/SynGEC-Visual_YOLO_CLIP.log
output_dir=result/SynGEC-Visual_YOLO_CLIP
checkpoint_dir=checkpoint/SynGEC-Visual_YOLO_CLIP
min_word_keep=5
min_generate_keep=5
language=zh
fp16_init_scale=128
distributed_port=-1
decoder_embed_path=None
quant_noise_pq_block_size=8
best_checkpoint_metric=loss
cross_self_attention=False
validate_interval=1
tie_adaptive_weights=False
bpe=None
decoder_normalize_before=False
cpu=False
optimizer_overrides={}
quant_noise_pq=0
lr_scheduler=polynomial_decay
no_save_optimizer_state=False
train_subset=train
no_cross_attention=False
distributed_world_size=1
decoder_layerdrop=0
skip_invalid_size_inputs_valid_test=True
lr=[0.0005]
slowmo_momentum=None
log_interval=100
user_dir=./gectoolkit/model/SynGEC/src/src_syngec/syngec_model
min_loss_scale=0.0001
dual_aggregation_freeze=True
decoder_output_dim=1024
curriculum=0
scoring=bleu
optimizer=adam
adam_betas=(0.9,0.999)
share_decoder_input_output_embed=True
fp16_no_flatten_grads=False
distributed_backend=nccl
adaptive_input=False
dpd_suffix=['dpd']
attention_dropout=0.0
fp16=True
pipeline_checkpoint=never
fix_batches_to_gpus=False
fp16_scale_tolerance=0.0
valid_subset=valid
gen_subset=test
no_last_checkpoints=False
decoder_attention_heads=16
distributed_wrapper=DDP
activation_dropout=0.0
log_format=tqdm
decoder_embed_dim=1024
dual_aggregation_beta=0.5
disable_validation=False
quant_noise_scalar=0
use_bmuf=False
gat_encoder_layers=3
arch=syntax_enhanced_bart_large
eval_bleu_print_samples=False
no_scale_embedding=True
zero_sharding=none
pipeline_decoder_devices=None
save_interval_updates=0
localsgd_frequency=3
ignore_prefix_size=0
eval_bleu_args=None
encoder_layerdrop=0
syntax_type=['dep']
distributed_no_spawn=False
left_pad_source=True
decoder_layers=12
adaptive_softmax_cutoff=None
upsample_primary=1
ddp_backend=c10d
validate_after_updates=0
power=1.0
data_buffer_size=10
memory_efficient_bf16=False
num_batch_buckets=0
share_all_embeddings=True
alpha=1.0
gated_sum=False
distributed_init_method=None
report_accuracy=False
end_learning_rate=0.0
batch_size_valid=None
pipeline_devices=None
left_pad_target=False
source_word_dropout_probs=False
bf16=False
swm_suffix=swm
encoder_embed_dim=1024
force_anneal=None
no_epoch_checkpoints=False
syntax_encoder=GCN
encoder_ffn_embed_dim=4096
label_smoothing=0.1
num_shards=1
find_unused_parameters=True
no_progress_bar=False
load_alignments=False
use_old_adam=False
eval_bleu_detok_args=None
tensorboard_logdir=None
slowmo_algorithm=LocalSGD
fast_stat_sync=False
layernorm_embedding=True
encoder_layers_to_keep=None
eval_bleu_remove_bpe=None
scale_syntax_encoder_lr=None
eval_bleu=False
fp16_scale_window=None
pipeline_encoder_balance=None
pipeline_encoder_devices=None
relu_dropout=0.0
threshold_loss_scale=None
activation_fn=gelu
task=syntax-enhanced-translation
target_lang=tgt
bart_model_file_from_transformers=None
all_gather_list_size=16384
stop_time_hours=0
validate_interval_updates=0
save_interval=1
conll_suffix=['conll']
empty_cache_freq=0
encoder_learned_pos=True
tpu=False
nprocs_per_node=1
keep_last_epochs=10
device_id=0
source_lang_with_nt=src_nt
use_dpd=False
pipeline_chunks=0
cross_syntax_fuse=False
keep_interval_updates=-1
encoder_embed_path=None
adam_eps=1e-08
model_parallel_size=1
sentence_avg=False
encoder_layers=12
decoder_ffn_embed_dim=4096
dataset_impl=None
criterion=label_smoothed_cross_entropy
fixed_validation_seed=None
profile=False
distributed_rank=0
source_lang=src
eval_tokenized_bleu=False
source_word_dropout=0.2
adaptive_softmax_dropout=0
syntax_model_file=None
checkpoint_suffix=
required_seq_len_multiple=1
no_save=False
use_syntax=True
probs_suffix=['probs']
decoder_learned_pos=True
decoder_input_dim=1024
memory_efficient_fp16=False
decoder_layers_to_keep=None
gat_attention_heads=4
bucket_cap_mb=25
checkpoint_shard_count=1
pipeline_model_parallel=False
encoder_normalize_before=False
keep_best_checkpoints=-1
no_token_positional_embeddings=False
pooler_activation_fn=tanh
shard_id=0
only_dsa=False
max_update=0
encoder_attention_heads=16
freeze_bart_parameters=True
tokenizer=None
total_num_update=1000000
pipeline_decoder_balance=None
quantization_config_path=None
broadcast_buffers=False
batch_size=None
maximize_best_checkpoint_metric=False
pooler_dropout=0.0
warmup_updates=2000
min_lr=-1.0
only_gnn=True
eval_bleu_detok=space
no_seed_provided=False
truncate_source=False
pipeline_balance=None
model=SynGEC
dataset=Visual_YOLO_CLIP
augment=none
method=YOLO_CLIP
correctionmodel=SynGEC
device=cuda
map_location=cuda
gpu_nums=1


Fri 04 Oct 2024 11:42:11 INFO random_seed=2024
use_gpu=True
learning_rate=6e-06
train_batch_size=32
test_batch_size=1
epoch_nums=200
test_step=10
display_train_step=1
gpu_id=5
training_resume=False
load_best_config=False
supervising_mode=fully_supervised
validset_divide=True
test_only=False
shuffle=True
model_config_file=gectoolkit/properties/model/SynGEC.json
best_config_file=gectoolkit/properties/best_config/SynGEC_Visual_YOLO_CLIP.json
dataset_config_file=gectoolkit/properties/dataset/Visual_YOLO_CLIP.json
dataset_dir=dataset/Visual_YOLO_CLIP
checkpoint_file=checkpoint/SynGEC-Visual_YOLO_CLIP.pth
log_file=log/SynGEC-Visual_YOLO_CLIP.log
output_dir=result/SynGEC-Visual_YOLO_CLIP
checkpoint_dir=checkpoint/SynGEC-Visual_YOLO_CLIP
min_word_keep=5
min_generate_keep=5
language=zh
fp16_init_scale=128
distributed_port=-1
decoder_embed_path=None
quant_noise_pq_block_size=8
best_checkpoint_metric=loss
cross_self_attention=False
validate_interval=1
tie_adaptive_weights=False
bpe=None
decoder_normalize_before=False
cpu=False
optimizer_overrides={}
quant_noise_pq=0
lr_scheduler=polynomial_decay
no_save_optimizer_state=False
train_subset=train
no_cross_attention=False
distributed_world_size=1
decoder_layerdrop=0
skip_invalid_size_inputs_valid_test=True
lr=[0.0005]
slowmo_momentum=None
log_interval=100
user_dir=./gectoolkit/model/SynGEC/src/src_syngec/syngec_model
min_loss_scale=0.0001
dual_aggregation_freeze=True
decoder_output_dim=1024
curriculum=0
scoring=bleu
optimizer=adam
adam_betas=(0.9,0.999)
share_decoder_input_output_embed=True
fp16_no_flatten_grads=False
distributed_backend=nccl
adaptive_input=False
dpd_suffix=['dpd']
attention_dropout=0.0
fp16=True
pipeline_checkpoint=never
fix_batches_to_gpus=False
fp16_scale_tolerance=0.0
valid_subset=valid
gen_subset=test
no_last_checkpoints=False
decoder_attention_heads=16
distributed_wrapper=DDP
activation_dropout=0.0
log_format=tqdm
decoder_embed_dim=1024
dual_aggregation_beta=0.5
disable_validation=False
quant_noise_scalar=0
use_bmuf=False
gat_encoder_layers=3
arch=syntax_enhanced_bart_large
eval_bleu_print_samples=False
no_scale_embedding=True
zero_sharding=none
pipeline_decoder_devices=None
save_interval_updates=0
localsgd_frequency=3
ignore_prefix_size=0
eval_bleu_args=None
encoder_layerdrop=0
syntax_type=['dep']
distributed_no_spawn=False
left_pad_source=True
decoder_layers=12
adaptive_softmax_cutoff=None
upsample_primary=1
ddp_backend=c10d
validate_after_updates=0
power=1.0
data_buffer_size=10
memory_efficient_bf16=False
num_batch_buckets=0
share_all_embeddings=True
alpha=1.0
gated_sum=False
distributed_init_method=None
report_accuracy=False
end_learning_rate=0.0
batch_size_valid=None
pipeline_devices=None
left_pad_target=False
source_word_dropout_probs=False
bf16=False
swm_suffix=swm
encoder_embed_dim=1024
force_anneal=None
no_epoch_checkpoints=False
syntax_encoder=GCN
encoder_ffn_embed_dim=4096
label_smoothing=0.1
num_shards=1
find_unused_parameters=True
no_progress_bar=False
load_alignments=False
use_old_adam=False
eval_bleu_detok_args=None
tensorboard_logdir=None
slowmo_algorithm=LocalSGD
fast_stat_sync=False
layernorm_embedding=True
encoder_layers_to_keep=None
eval_bleu_remove_bpe=None
scale_syntax_encoder_lr=None
eval_bleu=False
fp16_scale_window=None
pipeline_encoder_balance=None
pipeline_encoder_devices=None
relu_dropout=0.0
threshold_loss_scale=None
activation_fn=gelu
task=syntax-enhanced-translation
target_lang=tgt
bart_model_file_from_transformers=None
all_gather_list_size=16384
stop_time_hours=0
validate_interval_updates=0
save_interval=1
conll_suffix=['conll']
empty_cache_freq=0
encoder_learned_pos=True
tpu=False
nprocs_per_node=1
keep_last_epochs=10
device_id=0
source_lang_with_nt=src_nt
use_dpd=False
pipeline_chunks=0
cross_syntax_fuse=False
keep_interval_updates=-1
encoder_embed_path=None
adam_eps=1e-08
model_parallel_size=1
sentence_avg=False
encoder_layers=12
decoder_ffn_embed_dim=4096
dataset_impl=None
criterion=label_smoothed_cross_entropy
fixed_validation_seed=None
profile=False
distributed_rank=0
source_lang=src
eval_tokenized_bleu=False
source_word_dropout=0.2
adaptive_softmax_dropout=0
syntax_model_file=None
checkpoint_suffix=
required_seq_len_multiple=1
no_save=False
use_syntax=True
probs_suffix=['probs']
decoder_learned_pos=True
decoder_input_dim=1024
memory_efficient_fp16=False
decoder_layers_to_keep=None
gat_attention_heads=4
bucket_cap_mb=25
checkpoint_shard_count=1
pipeline_model_parallel=False
encoder_normalize_before=False
keep_best_checkpoints=-1
no_token_positional_embeddings=False
pooler_activation_fn=tanh
shard_id=0
only_dsa=False
max_update=0
encoder_attention_heads=16
freeze_bart_parameters=True
tokenizer=None
total_num_update=1000000
pipeline_decoder_balance=None
quantization_config_path=None
broadcast_buffers=False
batch_size=None
maximize_best_checkpoint_metric=False
pooler_dropout=0.0
warmup_updates=2000
min_lr=-1.0
only_gnn=True
eval_bleu_detok=space
no_seed_provided=False
truncate_source=False
pipeline_balance=None
model=SynGEC
dataset=Visual_YOLO_CLIP
augment=none
method=YOLO_CLIP
correctionmodel=SynGEC
device=cuda
map_location=cuda
gpu_nums=1


Fri 04 Oct 2024 11:42:11 INFO [src] dictionary: 21132 types
Fri 04 Oct 2024 11:42:11 INFO [tgt] dictionary: 21132 types
Fri 04 Oct 2024 11:42:11 INFO [syntax label0] dictionary: 51 types
Fri 04 Oct 2024 11:42:11 INFO [src] dictionary: 21132 types
Fri 04 Oct 2024 11:42:11 INFO [tgt] dictionary: 21132 types
Fri 04 Oct 2024 11:42:11 INFO [syntax label0] dictionary: 51 types
Fri 04 Oct 2024 11:42:11 INFO loaded 245 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_YOLO_CLIP_with_syntax_bart/bin/valid.src-tgt.src
Fri 04 Oct 2024 11:42:11 INFO loaded 245 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_YOLO_CLIP_with_syntax_bart/bin/valid.src-tgt.tgt
Fri 04 Oct 2024 11:42:11 INFO ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_YOLO_CLIP_with_syntax_bart/bin valid src-tgt 245 examples
Fri 04 Oct 2024 11:42:11 INFO loaded 245 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_YOLO_CLIP_with_syntax_bart/bin/valid.conll.src-tgt.src
Fri 04 Oct 2024 11:42:11 INFO loaded 245 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_YOLO_CLIP_with_syntax_bart/bin/valid.dpd.src-tgt.src
Fri 04 Oct 2024 11:42:11 INFO loaded 245 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_YOLO_CLIP_with_syntax_bart/bin/valid.probs.src-tgt.src
Fri 04 Oct 2024 11:42:11 INFO success! syntax types: 1, source conll lines: 245
Fri 04 Oct 2024 11:42:11 INFO loaded 1960 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_YOLO_CLIP_with_syntax_bart/bin/train.src-tgt.src
Fri 04 Oct 2024 11:42:11 INFO loaded 1960 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_YOLO_CLIP_with_syntax_bart/bin/train.src-tgt.tgt
Fri 04 Oct 2024 11:42:11 INFO ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_YOLO_CLIP_with_syntax_bart/bin train src-tgt 1960 examples
Fri 04 Oct 2024 11:42:11 INFO loaded 1960 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_YOLO_CLIP_with_syntax_bart/bin/train.conll.src-tgt.src
Fri 04 Oct 2024 11:42:11 INFO loaded 1960 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_YOLO_CLIP_with_syntax_bart/bin/train.dpd.src-tgt.src
Fri 04 Oct 2024 11:42:11 INFO loaded 1960 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_YOLO_CLIP_with_syntax_bart/bin/train.probs.src-tgt.src
Fri 04 Oct 2024 11:42:11 INFO success! syntax types: 1, source conll lines: 1960
Fri 04 Oct 2024 11:42:11 INFO loaded 246 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_YOLO_CLIP_test_with_syntax_bart/bin/test.conll.src-tgt.src
Fri 04 Oct 2024 11:42:11 INFO loaded 246 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_YOLO_CLIP_test_with_syntax_bart/bin/test.dpd.src-tgt.src
Fri 04 Oct 2024 11:42:11 INFO loaded 246 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_YOLO_CLIP_test_with_syntax_bart/bin/test.probs.src-tgt.src
Fri 04 Oct 2024 11:42:11 INFO success! syntax types: 1, source conll lines: 246
Fri 04 Oct 2024 11:42:19 INFO detected shared parameter: encoder.sentence_encoder.embed_tokens.weight <- decoder.embed_tokens.weight
Fri 04 Oct 2024 11:42:19 INFO detected shared parameter: encoder.sentence_encoder.embed_tokens.weight <- decoder.output_projection.weight
Fri 04 Oct 2024 11:42:19 INFO ***********************CUDA enviroments for all 1 workers***********************
Fri 04 Oct 2024 11:42:19 INFO rank   0: capabilities =  8.0  ; total memory = 79.151 GB ; name = NVIDIA A800 80GB PCIe                   
Fri 04 Oct 2024 11:42:19 INFO ***********************CUDA enviroments for all 1 workers***********************
Fri 04 Oct 2024 11:42:23 INFO loaded checkpoint ./gectoolkit/properties/model/SynGEC/preprocess/gopar/chinese_Visual_YOLO_CLIP_bart_baseline/checkpoint_best.pt (epoch 16 @ 1042 updates)
Fri 04 Oct 2024 11:42:23 INFO loading train data for epoch 16
Fri 04 Oct 2024 11:42:23 INFO loaded 1960 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_YOLO_CLIP_with_syntax_bart/bin/train.src-tgt.src
Fri 04 Oct 2024 11:42:23 INFO loaded 1960 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_YOLO_CLIP_with_syntax_bart/bin/train.src-tgt.tgt
Fri 04 Oct 2024 11:42:23 INFO ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_YOLO_CLIP_with_syntax_bart/bin train src-tgt 1960 examples
Fri 04 Oct 2024 11:42:23 INFO loaded 1960 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_YOLO_CLIP_with_syntax_bart/bin/train.conll.src-tgt.src
Fri 04 Oct 2024 11:42:23 INFO loaded 1960 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_YOLO_CLIP_with_syntax_bart/bin/train.dpd.src-tgt.src
Fri 04 Oct 2024 11:42:23 INFO loaded 1960 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_YOLO_CLIP_with_syntax_bart/bin/train.probs.src-tgt.src
Fri 04 Oct 2024 11:42:23 INFO success! syntax types: 1, source conll lines: 1960
Fri 04 Oct 2024 11:42:24 INFO SynGEC(
  (model): SyntaxEnhancedBARTModel(
    (encoder): SyntaxEnhancedTransformerEncoder(
      (sentence_encoder): SyntaxEnhancedSentenceTransformerEncoder(
        (dropout_module): FairseqDropout()
        (embed_tokens): Embedding(21132, 1024, padding_idx=1)
        (embed_positions): LearnedPositionalEmbedding(514, 1024, padding_idx=1)
        (layernorm_embedding): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        (layers): ModuleList(
          (0-11): 12 x DSATransformerEncoderLayer(
            (self_attn): DSAMultiheadAttention(
              (dropout_module): FairseqDropout()
              (k_proj): Linear(in_features=1024, out_features=1024, bias=True)
              (v_proj): Linear(in_features=1024, out_features=1024, bias=True)
              (q_proj): Linear(in_features=1024, out_features=1024, bias=True)
              (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
            )
            (self_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
            (dropout_module): FairseqDropout()
            (activation_dropout_module): FairseqDropout()
            (fc1): Linear(in_features=1024, out_features=4096, bias=True)
            (fc2): Linear(in_features=4096, out_features=1024, bias=True)
            (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
      )
      (syntax_encoder): SyntaxEnhancedSyntaxGuidedTransformerEncoder(
        (dropout_module): FairseqDropout()
        (embed_tokens): Embedding(51, 1024, padding_idx=0)
        (layers): ModuleList(
          (0-2): 3 x GCNSyntaxGuidedTransformerEncoderLayer(
            (gcn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
            (dropout_module): FairseqDropout()
            (activation_dropout_module): FairseqDropout()
            (W_out): Linear(in_features=2048, out_features=1024, bias=True)
            (W_in): Linear(in_features=2048, out_features=1024, bias=True)
            (fc): Linear(in_features=1024, out_features=1024, bias=True)
            (fc1): Linear(in_features=1024, out_features=4096, bias=True)
            (fc2): Linear(in_features=4096, out_features=1024, bias=True)
            (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
      )
    )
    (decoder): SyntaxEnhancedTransformerDecoder(
      (dropout_module): FairseqDropout()
      (embed_tokens): Embedding(21132, 1024, padding_idx=1)
      (embed_positions): LearnedPositionalEmbedding(514, 1024, padding_idx=1)
      (layernorm_embedding): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      (layers): ModuleList(
        (0-11): 12 x TransformerDecoderLayer(
          (dropout_module): FairseqDropout()
          (self_attn): MultiheadAttention(
            (dropout_module): FairseqDropout()
            (k_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (v_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (q_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
          )
          (activation_dropout_module): FairseqDropout()
          (self_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          (encoder_attn): MultiheadAttention(
            (dropout_module): FairseqDropout()
            (k_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (v_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (q_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
          )
          (encoder_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          (fc1): Linear(in_features=1024, out_features=4096, bias=True)
          (fc2): Linear(in_features=4096, out_features=1024, bias=True)
          (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        )
      )
      (output_projection): Linear(in_features=1024, out_features=21132, bias=False)
    )
    (classification_heads): ModuleDict()
  )
  (criterion): LabelSmoothedCrossEntropyCriterion()
)
Fri 04 Oct 2024 11:42:24 INFO start training...
Fri 04 Oct 2024 11:42:25 INFO | supervised_trainer |NOTE: overflow detected, setting loss scale to: 64.0
Fri 04 Oct 2024 11:42:25 INFO | supervised_trainer |NOTE: overflow detected, setting loss scale to: 32.0
Fri 04 Oct 2024 11:42:26 INFO | supervised_trainer |NOTE: overflow detected, setting loss scale to: 16.0
Fri 04 Oct 2024 11:42:27 INFO | supervised_trainer |NOTE: overflow detected, setting loss scale to: 8.0
Fri 04 Oct 2024 11:42:36 INFO epoch [  1] train time 0h 0m 12s |  loss |[6050.652]
Fri 04 Oct 2024 11:42:47 INFO epoch [  2] train time 0h 0m 11s |  loss |[5363.074]
Fri 04 Oct 2024 11:42:58 INFO epoch [  3] train time 0h 0m 11s |  loss |[5221.386]
Fri 04 Oct 2024 11:43:10 INFO epoch [  4] train time 0h 0m 11s |  loss |[5123.285]
Fri 04 Oct 2024 11:43:21 INFO epoch [  5] train time 0h 0m 11s |  loss |[5056.417]
Fri 04 Oct 2024 11:43:32 INFO epoch [  6] train time 0h 0m 11s |  loss |[5003.869]
Fri 04 Oct 2024 11:43:43 INFO epoch [  7] train time 0h 0m 11s |  loss |[4956.757]
Fri 04 Oct 2024 11:43:54 INFO epoch [  8] train time 0h 0m 11s |  loss |[4915.778]
Fri 04 Oct 2024 11:44:05 INFO epoch [  9] train time 0h 0m 11s |  loss |[4879.974]
Fri 04 Oct 2024 11:44:16 INFO epoch [ 10] train time 0h 0m 11s |  loss |[4840.018]
Fri 04 Oct 2024 11:48:16 INFO ---------- valid total [245] | valid precision [0.027] | valid recall [0.026] | valid f0.5 [0.022] | valid time 0h 3m 59s
Fri 04 Oct 2024 12:00:34 INFO random_seed=2024
use_gpu=True
learning_rate=6e-06
train_batch_size=32
test_batch_size=1
epoch_nums=200
test_step=10
display_train_step=1
gpu_id=5
training_resume=False
load_best_config=False
supervising_mode=fully_supervised
validset_divide=True
test_only=False
shuffle=True
model_config_file=gectoolkit/properties/model/SynGEC.json
best_config_file=gectoolkit/properties/best_config/SynGEC_Visual_YOLO_CLIP.json
dataset_config_file=gectoolkit/properties/dataset/Visual_YOLO_CLIP.json
dataset_dir=dataset/Visual_YOLO_CLIP
checkpoint_file=checkpoint/SynGEC-Visual_YOLO_CLIP.pth
log_file=log/SynGEC-Visual_YOLO_CLIP.log
output_dir=result/SynGEC-Visual_YOLO_CLIP
checkpoint_dir=checkpoint/SynGEC-Visual_YOLO_CLIP
min_word_keep=5
min_generate_keep=5
language=zh
fp16_init_scale=128
distributed_port=-1
decoder_embed_path=None
quant_noise_pq_block_size=8
best_checkpoint_metric=loss
cross_self_attention=False
validate_interval=1
tie_adaptive_weights=False
bpe=None
decoder_normalize_before=False
cpu=False
optimizer_overrides={}
quant_noise_pq=0
lr_scheduler=polynomial_decay
no_save_optimizer_state=False
train_subset=train
no_cross_attention=False
distributed_world_size=1
decoder_layerdrop=0
skip_invalid_size_inputs_valid_test=True
lr=[0.0005]
slowmo_momentum=None
log_interval=100
user_dir=./gectoolkit/model/SynGEC/src/src_syngec/syngec_model
min_loss_scale=0.0001
dual_aggregation_freeze=True
decoder_output_dim=1024
curriculum=0
scoring=bleu
optimizer=adam
adam_betas=(0.9,0.999)
share_decoder_input_output_embed=True
fp16_no_flatten_grads=False
distributed_backend=nccl
adaptive_input=False
dpd_suffix=['dpd']
attention_dropout=0.0
fp16=True
pipeline_checkpoint=never
fix_batches_to_gpus=False
fp16_scale_tolerance=0.0
valid_subset=valid
gen_subset=test
no_last_checkpoints=False
decoder_attention_heads=16
distributed_wrapper=DDP
activation_dropout=0.0
log_format=tqdm
decoder_embed_dim=1024
dual_aggregation_beta=0.5
disable_validation=False
quant_noise_scalar=0
use_bmuf=False
gat_encoder_layers=3
arch=syntax_enhanced_bart_large
eval_bleu_print_samples=False
no_scale_embedding=True
zero_sharding=none
pipeline_decoder_devices=None
save_interval_updates=0
localsgd_frequency=3
ignore_prefix_size=0
eval_bleu_args=None
encoder_layerdrop=0
syntax_type=['dep']
distributed_no_spawn=False
left_pad_source=True
decoder_layers=12
adaptive_softmax_cutoff=None
upsample_primary=1
ddp_backend=c10d
validate_after_updates=0
power=1.0
data_buffer_size=10
memory_efficient_bf16=False
num_batch_buckets=0
share_all_embeddings=True
alpha=1.0
gated_sum=False
distributed_init_method=None
report_accuracy=False
end_learning_rate=0.0
batch_size_valid=None
pipeline_devices=None
left_pad_target=False
source_word_dropout_probs=False
bf16=False
swm_suffix=swm
encoder_embed_dim=1024
force_anneal=None
no_epoch_checkpoints=False
syntax_encoder=GCN
encoder_ffn_embed_dim=4096
label_smoothing=0.1
num_shards=1
find_unused_parameters=True
no_progress_bar=False
load_alignments=False
use_old_adam=False
eval_bleu_detok_args=None
tensorboard_logdir=None
slowmo_algorithm=LocalSGD
fast_stat_sync=False
layernorm_embedding=True
encoder_layers_to_keep=None
eval_bleu_remove_bpe=None
scale_syntax_encoder_lr=None
eval_bleu=False
fp16_scale_window=None
pipeline_encoder_balance=None
pipeline_encoder_devices=None
relu_dropout=0.0
threshold_loss_scale=None
activation_fn=gelu
task=syntax-enhanced-translation
target_lang=tgt
bart_model_file_from_transformers=None
all_gather_list_size=16384
stop_time_hours=0
validate_interval_updates=0
save_interval=1
conll_suffix=['conll']
empty_cache_freq=0
encoder_learned_pos=True
tpu=False
nprocs_per_node=1
keep_last_epochs=10
device_id=0
source_lang_with_nt=src_nt
use_dpd=False
pipeline_chunks=0
cross_syntax_fuse=False
keep_interval_updates=-1
encoder_embed_path=None
adam_eps=1e-08
model_parallel_size=1
sentence_avg=False
encoder_layers=12
decoder_ffn_embed_dim=4096
dataset_impl=None
criterion=label_smoothed_cross_entropy
fixed_validation_seed=None
profile=False
distributed_rank=0
source_lang=src
eval_tokenized_bleu=False
source_word_dropout=0.2
adaptive_softmax_dropout=0
syntax_model_file=None
checkpoint_suffix=
required_seq_len_multiple=1
no_save=False
use_syntax=True
probs_suffix=['probs']
decoder_learned_pos=True
decoder_input_dim=1024
memory_efficient_fp16=False
decoder_layers_to_keep=None
gat_attention_heads=4
bucket_cap_mb=25
checkpoint_shard_count=1
pipeline_model_parallel=False
encoder_normalize_before=False
keep_best_checkpoints=-1
no_token_positional_embeddings=False
pooler_activation_fn=tanh
shard_id=0
only_dsa=False
max_update=0
encoder_attention_heads=16
freeze_bart_parameters=True
tokenizer=None
total_num_update=1000000
pipeline_decoder_balance=None
quantization_config_path=None
broadcast_buffers=False
batch_size=None
maximize_best_checkpoint_metric=False
pooler_dropout=0.0
warmup_updates=2000
min_lr=-1.0
only_gnn=True
eval_bleu_detok=space
no_seed_provided=False
truncate_source=False
pipeline_balance=None
model=SynGEC
dataset=Visual_YOLO_CLIP
augment=none
method=YOLO_CLIP
correctionmodel=SynGEC
device=cuda
map_location=cuda
gpu_nums=1


Fri 04 Oct 2024 12:00:34 INFO [src] dictionary: 21132 types
Fri 04 Oct 2024 12:00:34 INFO [tgt] dictionary: 21132 types
Fri 04 Oct 2024 12:00:34 INFO [syntax label0] dictionary: 51 types
Fri 04 Oct 2024 12:00:34 INFO [src] dictionary: 21132 types
Fri 04 Oct 2024 12:00:34 INFO [tgt] dictionary: 21132 types
Fri 04 Oct 2024 12:00:34 INFO [syntax label0] dictionary: 51 types
Fri 04 Oct 2024 12:00:34 INFO loaded 245 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_YOLO_CLIP_with_syntax_bart/bin/valid.src-tgt.src
Fri 04 Oct 2024 12:00:34 INFO loaded 245 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_YOLO_CLIP_with_syntax_bart/bin/valid.src-tgt.tgt
Fri 04 Oct 2024 12:00:34 INFO ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_YOLO_CLIP_with_syntax_bart/bin valid src-tgt 245 examples
Fri 04 Oct 2024 12:00:34 INFO loaded 245 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_YOLO_CLIP_with_syntax_bart/bin/valid.conll.src-tgt.src
Fri 04 Oct 2024 12:00:34 INFO loaded 245 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_YOLO_CLIP_with_syntax_bart/bin/valid.dpd.src-tgt.src
Fri 04 Oct 2024 12:00:34 INFO loaded 245 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_YOLO_CLIP_with_syntax_bart/bin/valid.probs.src-tgt.src
Fri 04 Oct 2024 12:00:34 INFO success! syntax types: 1, source conll lines: 245
Fri 04 Oct 2024 12:00:34 INFO loaded 1960 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_YOLO_CLIP_with_syntax_bart/bin/train.src-tgt.src
Fri 04 Oct 2024 12:00:34 INFO loaded 1960 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_YOLO_CLIP_with_syntax_bart/bin/train.src-tgt.tgt
Fri 04 Oct 2024 12:00:34 INFO ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_YOLO_CLIP_with_syntax_bart/bin train src-tgt 1960 examples
Fri 04 Oct 2024 12:00:34 INFO loaded 1960 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_YOLO_CLIP_with_syntax_bart/bin/train.conll.src-tgt.src
Fri 04 Oct 2024 12:00:34 INFO loaded 1960 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_YOLO_CLIP_with_syntax_bart/bin/train.dpd.src-tgt.src
Fri 04 Oct 2024 12:00:34 INFO loaded 1960 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_YOLO_CLIP_with_syntax_bart/bin/train.probs.src-tgt.src
Fri 04 Oct 2024 12:00:34 INFO success! syntax types: 1, source conll lines: 1960
Fri 04 Oct 2024 12:00:34 INFO loaded 246 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_YOLO_CLIP_test_with_syntax_bart/bin/test.conll.src-tgt.src
Fri 04 Oct 2024 12:00:34 INFO loaded 246 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_YOLO_CLIP_test_with_syntax_bart/bin/test.dpd.src-tgt.src
Fri 04 Oct 2024 12:00:34 INFO loaded 246 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_YOLO_CLIP_test_with_syntax_bart/bin/test.probs.src-tgt.src
Fri 04 Oct 2024 12:00:34 INFO success! syntax types: 1, source conll lines: 246
Fri 04 Oct 2024 12:00:43 INFO detected shared parameter: encoder.sentence_encoder.embed_tokens.weight <- decoder.embed_tokens.weight
Fri 04 Oct 2024 12:00:43 INFO detected shared parameter: encoder.sentence_encoder.embed_tokens.weight <- decoder.output_projection.weight
Fri 04 Oct 2024 12:00:43 INFO ***********************CUDA enviroments for all 1 workers***********************
Fri 04 Oct 2024 12:00:43 INFO rank   0: capabilities =  8.0  ; total memory = 79.151 GB ; name = NVIDIA A800 80GB PCIe                   
Fri 04 Oct 2024 12:00:43 INFO ***********************CUDA enviroments for all 1 workers***********************
Fri 04 Oct 2024 12:00:47 INFO loaded checkpoint ./gectoolkit/properties/model/SynGEC/preprocess/gopar/chinese_Visual_YOLO_CLIP_bart_baseline/checkpoint_best.pt (epoch 16 @ 1042 updates)
Fri 04 Oct 2024 12:00:47 INFO loading train data for epoch 16
Fri 04 Oct 2024 12:00:47 INFO loaded 1960 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_YOLO_CLIP_with_syntax_bart/bin/train.src-tgt.src
Fri 04 Oct 2024 12:00:47 INFO loaded 1960 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_YOLO_CLIP_with_syntax_bart/bin/train.src-tgt.tgt
Fri 04 Oct 2024 12:00:47 INFO ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_YOLO_CLIP_with_syntax_bart/bin train src-tgt 1960 examples
Fri 04 Oct 2024 12:00:47 INFO loaded 1960 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_YOLO_CLIP_with_syntax_bart/bin/train.conll.src-tgt.src
Fri 04 Oct 2024 12:00:47 INFO loaded 1960 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_YOLO_CLIP_with_syntax_bart/bin/train.dpd.src-tgt.src
Fri 04 Oct 2024 12:00:47 INFO loaded 1960 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_YOLO_CLIP_with_syntax_bart/bin/train.probs.src-tgt.src
Fri 04 Oct 2024 12:00:47 INFO success! syntax types: 1, source conll lines: 1960
Fri 04 Oct 2024 12:00:48 INFO SynGEC(
  (model): SyntaxEnhancedBARTModel(
    (encoder): SyntaxEnhancedTransformerEncoder(
      (sentence_encoder): SyntaxEnhancedSentenceTransformerEncoder(
        (dropout_module): FairseqDropout()
        (embed_tokens): Embedding(21132, 1024, padding_idx=1)
        (embed_positions): LearnedPositionalEmbedding(514, 1024, padding_idx=1)
        (layernorm_embedding): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        (layers): ModuleList(
          (0-11): 12 x DSATransformerEncoderLayer(
            (self_attn): DSAMultiheadAttention(
              (dropout_module): FairseqDropout()
              (k_proj): Linear(in_features=1024, out_features=1024, bias=True)
              (v_proj): Linear(in_features=1024, out_features=1024, bias=True)
              (q_proj): Linear(in_features=1024, out_features=1024, bias=True)
              (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
            )
            (self_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
            (dropout_module): FairseqDropout()
            (activation_dropout_module): FairseqDropout()
            (fc1): Linear(in_features=1024, out_features=4096, bias=True)
            (fc2): Linear(in_features=4096, out_features=1024, bias=True)
            (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
      )
      (syntax_encoder): SyntaxEnhancedSyntaxGuidedTransformerEncoder(
        (dropout_module): FairseqDropout()
        (embed_tokens): Embedding(51, 1024, padding_idx=0)
        (layers): ModuleList(
          (0-2): 3 x GCNSyntaxGuidedTransformerEncoderLayer(
            (gcn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
            (dropout_module): FairseqDropout()
            (activation_dropout_module): FairseqDropout()
            (W_out): Linear(in_features=2048, out_features=1024, bias=True)
            (W_in): Linear(in_features=2048, out_features=1024, bias=True)
            (fc): Linear(in_features=1024, out_features=1024, bias=True)
            (fc1): Linear(in_features=1024, out_features=4096, bias=True)
            (fc2): Linear(in_features=4096, out_features=1024, bias=True)
            (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
      )
    )
    (decoder): SyntaxEnhancedTransformerDecoder(
      (dropout_module): FairseqDropout()
      (embed_tokens): Embedding(21132, 1024, padding_idx=1)
      (embed_positions): LearnedPositionalEmbedding(514, 1024, padding_idx=1)
      (layernorm_embedding): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      (layers): ModuleList(
        (0-11): 12 x TransformerDecoderLayer(
          (dropout_module): FairseqDropout()
          (self_attn): MultiheadAttention(
            (dropout_module): FairseqDropout()
            (k_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (v_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (q_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
          )
          (activation_dropout_module): FairseqDropout()
          (self_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          (encoder_attn): MultiheadAttention(
            (dropout_module): FairseqDropout()
            (k_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (v_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (q_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
          )
          (encoder_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          (fc1): Linear(in_features=1024, out_features=4096, bias=True)
          (fc2): Linear(in_features=4096, out_features=1024, bias=True)
          (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        )
      )
      (output_projection): Linear(in_features=1024, out_features=21132, bias=False)
    )
    (classification_heads): ModuleDict()
  )
  (criterion): LabelSmoothedCrossEntropyCriterion()
)
Fri 04 Oct 2024 12:00:48 INFO start training...
Fri 04 Oct 2024 12:00:49 INFO | supervised_trainer |NOTE: overflow detected, setting loss scale to: 64.0
Fri 04 Oct 2024 12:00:49 INFO | supervised_trainer |NOTE: overflow detected, setting loss scale to: 32.0
Fri 04 Oct 2024 12:00:50 INFO | supervised_trainer |NOTE: overflow detected, setting loss scale to: 16.0
Fri 04 Oct 2024 12:00:50 INFO | supervised_trainer |NOTE: overflow detected, setting loss scale to: 8.0
Fri 04 Oct 2024 12:01:00 INFO epoch [  1] train time 0h 0m 11s |  loss |[6050.652]
Fri 04 Oct 2024 12:01:11 INFO epoch [  2] train time 0h 0m 10s |  loss |[5363.074]
Fri 04 Oct 2024 12:01:22 INFO epoch [  3] train time 0h 0m 10s |  loss |[5221.386]
Fri 04 Oct 2024 12:01:33 INFO epoch [  4] train time 0h 0m 10s |  loss |[5123.285]
Fri 04 Oct 2024 12:01:44 INFO epoch [  5] train time 0h 0m 10s |  loss |[5056.417]
Fri 04 Oct 2024 12:01:55 INFO epoch [  6] train time 0h 0m 10s |  loss |[5003.869]
Fri 04 Oct 2024 12:02:06 INFO epoch [  7] train time 0h 0m 10s |  loss |[4956.757]
Fri 04 Oct 2024 12:02:17 INFO epoch [  8] train time 0h 0m 10s |  loss |[4915.778]
Fri 04 Oct 2024 12:02:28 INFO epoch [  9] train time 0h 0m 10s |  loss |[4879.974]
Fri 04 Oct 2024 12:02:39 INFO epoch [ 10] train time 0h 0m 11s |  loss |[4840.018]
Fri 04 Oct 2024 12:06:41 INFO ---------- valid total [245] | valid precision [0.012] | valid recall [0.016] | valid f0.5 [0.012] | valid time 0h 4m 1s
Fri 04 Oct 2024 12:10:11 INFO ---------- test total [246] | test precision [0.024] | test recall [0.023] | test f0.5 [0.012] | test time 0h 3m 30s
Fri 04 Oct 2024 12:10:13 INFO | supervised_trainer |NOTE: overflow detected, setting loss scale to: 4.0
Fri 04 Oct 2024 12:10:23 INFO epoch [ 11] train time 0h 0m 10s |  loss |[3986.911]
Fri 04 Oct 2024 12:10:34 INFO epoch [ 12] train time 0h 0m 10s |  loss |[2531.767]
Fri 04 Oct 2024 12:10:45 INFO epoch [ 13] train time 0h 0m 10s |  loss |[2092.561]
Fri 04 Oct 2024 12:10:56 INFO epoch [ 14] train time 0h 0m 10s |  loss |[1932.090]
Fri 04 Oct 2024 12:11:07 INFO epoch [ 15] train time 0h 0m 10s |  loss |[1836.218]
Fri 04 Oct 2024 12:11:18 INFO epoch [ 16] train time 0h 0m 10s |  loss |[1789.616]
Fri 04 Oct 2024 12:11:29 INFO epoch [ 17] train time 0h 0m 10s |  loss |[1750.756]
Fri 04 Oct 2024 12:11:40 INFO epoch [ 18] train time 0h 0m 10s |  loss |[1721.341]
Fri 04 Oct 2024 12:11:51 INFO epoch [ 19] train time 0h 0m 11s |  loss |[1697.425]
Fri 04 Oct 2024 12:12:02 INFO epoch [ 20] train time 0h 0m 11s |  loss |[1679.565]
Fri 04 Oct 2024 12:13:18 INFO ---------- valid total [245] | valid precision [0.306] | valid recall [0.349] | valid f0.5 [0.309] | valid time 0h 1m 16s
Fri 04 Oct 2024 12:14:35 INFO ---------- test total [246] | test precision [0.350] | test recall [0.385] | test f0.5 [0.350] | test time 0h 1m 17s
Fri 04 Oct 2024 12:14:48 INFO epoch [ 21] train time 0h 0m 10s |  loss |[1663.481]
Fri 04 Oct 2024 12:14:59 INFO epoch [ 22] train time 0h 0m 10s |  loss |[1649.244]
Fri 04 Oct 2024 12:15:04 INFO | supervised_trainer |NOTE: overflow detected, setting loss scale to: 2.0
Fri 04 Oct 2024 12:15:10 INFO epoch [ 23] train time 0h 0m 10s |  loss |[1636.185]
Fri 04 Oct 2024 12:15:21 INFO epoch [ 24] train time 0h 0m 10s |  loss |[1618.637]
Fri 04 Oct 2024 12:15:32 INFO epoch [ 25] train time 0h 0m 10s |  loss |[1612.023]
Fri 04 Oct 2024 12:15:43 INFO epoch [ 26] train time 0h 0m 10s |  loss |[1602.552]
Fri 04 Oct 2024 12:15:54 INFO epoch [ 27] train time 0h 0m 10s |  loss |[1593.486]
Fri 04 Oct 2024 12:16:05 INFO epoch [ 28] train time 0h 0m 11s |  loss |[1585.771]
Fri 04 Oct 2024 12:16:16 INFO epoch [ 29] train time 0h 0m 11s |  loss |[1580.510]
Fri 04 Oct 2024 12:16:27 INFO epoch [ 30] train time 0h 0m 11s |  loss |[1571.401]
Fri 04 Oct 2024 12:17:45 INFO ---------- valid total [245] | valid precision [0.307] | valid recall [0.338] | valid f0.5 [0.308] | valid time 0h 1m 17s
Fri 04 Oct 2024 12:19:01 INFO ---------- test total [246] | test precision [0.355] | test recall [0.393] | test f0.5 [0.352] | test time 0h 1m 16s
Fri 04 Oct 2024 12:19:12 INFO epoch [ 31] train time 0h 0m 11s |  loss |[1568.450]
Fri 04 Oct 2024 12:19:13 INFO | supervised_trainer |NOTE: overflow detected, setting loss scale to: 1.0
Fri 04 Oct 2024 12:19:24 INFO epoch [ 32] train time 0h 0m 11s |  loss |[1560.115]
Fri 04 Oct 2024 12:19:35 INFO epoch [ 33] train time 0h 0m 11s |  loss |[1551.988]
Fri 04 Oct 2024 12:19:46 INFO epoch [ 34] train time 0h 0m 11s |  loss |[1549.267]
Fri 04 Oct 2024 12:19:57 INFO epoch [ 35] train time 0h 0m 11s |  loss |[1545.835]
Fri 04 Oct 2024 12:20:08 INFO epoch [ 36] train time 0h 0m 11s |  loss |[1545.210]
Fri 04 Oct 2024 12:20:19 INFO epoch [ 37] train time 0h 0m 11s |  loss |[1539.421]
Fri 04 Oct 2024 12:20:30 INFO epoch [ 38] train time 0h 0m 11s |  loss |[1535.080]
Fri 04 Oct 2024 12:20:41 INFO epoch [ 39] train time 0h 0m 11s |  loss |[1530.872]
Fri 04 Oct 2024 12:20:53 INFO epoch [ 40] train time 0h 0m 11s |  loss |[1531.892]
Fri 04 Oct 2024 12:22:09 INFO ---------- valid total [245] | valid precision [0.305] | valid recall [0.337] | valid f0.5 [0.306] | valid time 0h 1m 16s
Fri 04 Oct 2024 12:23:26 INFO ---------- test total [246] | test precision [0.365] | test recall [0.396] | test f0.5 [0.361] | test time 0h 1m 16s
Fri 04 Oct 2024 12:23:37 INFO epoch [ 41] train time 0h 0m 11s |  loss |[1522.658]
Fri 04 Oct 2024 12:23:48 INFO epoch [ 42] train time 0h 0m 11s |  loss |[1523.274]
Fri 04 Oct 2024 12:23:59 INFO epoch [ 43] train time 0h 0m 11s |  loss |[1518.302]
Fri 04 Oct 2024 12:24:10 INFO epoch [ 44] train time 0h 0m 11s |  loss |[1509.096]
Fri 04 Oct 2024 12:24:21 INFO epoch [ 45] train time 0h 0m 11s |  loss |[1503.294]
Fri 04 Oct 2024 12:24:32 INFO epoch [ 46] train time 0h 0m 11s |  loss |[1510.048]
Fri 04 Oct 2024 12:24:44 INFO epoch [ 47] train time 0h 0m 11s |  loss |[1503.581]
Fri 04 Oct 2024 12:24:55 INFO epoch [ 48] train time 0h 0m 11s |  loss |[1503.408]
Fri 04 Oct 2024 12:25:06 INFO epoch [ 49] train time 0h 0m 11s |  loss |[1498.688]
Fri 04 Oct 2024 12:25:17 INFO epoch [ 50] train time 0h 0m 11s |  loss |[1497.480]
Fri 04 Oct 2024 12:26:34 INFO ---------- valid total [245] | valid precision [0.319] | valid recall [0.342] | valid f0.5 [0.317] | valid time 0h 1m 16s
Fri 04 Oct 2024 12:27:50 INFO ---------- test total [246] | test precision [0.355] | test recall [0.401] | test f0.5 [0.356] | test time 0h 1m 16s
Fri 04 Oct 2024 12:28:03 INFO epoch [ 51] train time 0h 0m 11s |  loss |[1489.398]
Fri 04 Oct 2024 12:28:14 INFO epoch [ 52] train time 0h 0m 11s |  loss |[1491.717]
Fri 04 Oct 2024 12:28:26 INFO epoch [ 53] train time 0h 0m 11s |  loss |[1491.969]
Fri 04 Oct 2024 12:28:37 INFO epoch [ 54] train time 0h 0m 11s |  loss |[1486.965]
Fri 04 Oct 2024 12:28:48 INFO epoch [ 55] train time 0h 0m 11s |  loss |[1487.053]
Fri 04 Oct 2024 12:28:59 INFO epoch [ 56] train time 0h 0m 11s |  loss |[1476.274]
Fri 04 Oct 2024 12:29:10 INFO epoch [ 57] train time 0h 0m 11s |  loss |[1477.522]
Fri 04 Oct 2024 12:29:21 INFO epoch [ 58] train time 0h 0m 11s |  loss |[1474.056]
Fri 04 Oct 2024 12:29:32 INFO epoch [ 59] train time 0h 0m 11s |  loss |[1478.913]
Fri 04 Oct 2024 12:29:44 INFO epoch [ 60] train time 0h 0m 11s |  loss |[1477.337]
Fri 04 Oct 2024 12:31:00 INFO ---------- valid total [245] | valid precision [0.317] | valid recall [0.347] | valid f0.5 [0.317] | valid time 0h 1m 16s
Fri 04 Oct 2024 12:32:17 INFO ---------- test total [246] | test precision [0.371] | test recall [0.403] | test f0.5 [0.367] | test time 0h 1m 16s
Fri 04 Oct 2024 12:32:29 INFO epoch [ 61] train time 0h 0m 11s |  loss |[1473.135]
Fri 04 Oct 2024 12:32:40 INFO epoch [ 62] train time 0h 0m 11s |  loss |[1471.613]
Fri 04 Oct 2024 12:32:51 INFO epoch [ 63] train time 0h 0m 11s |  loss |[1465.933]
Fri 04 Oct 2024 12:32:54 INFO | supervised_trainer |NOTE: overflow detected, setting loss scale to: 0.5
Fri 04 Oct 2024 12:33:02 INFO epoch [ 64] train time 0h 0m 11s |  loss |[1457.433]
Fri 04 Oct 2024 12:33:14 INFO epoch [ 65] train time 0h 0m 11s |  loss |[1465.952]
Fri 04 Oct 2024 12:33:25 INFO epoch [ 66] train time 0h 0m 11s |  loss |[1459.784]
Fri 04 Oct 2024 12:33:36 INFO epoch [ 67] train time 0h 0m 11s |  loss |[1452.256]
Fri 04 Oct 2024 12:33:47 INFO epoch [ 68] train time 0h 0m 11s |  loss |[1453.945]
Fri 04 Oct 2024 12:33:58 INFO epoch [ 69] train time 0h 0m 11s |  loss |[1456.894]
Fri 04 Oct 2024 12:34:10 INFO epoch [ 70] train time 0h 0m 11s |  loss |[1449.892]
Fri 04 Oct 2024 12:35:26 INFO ---------- valid total [245] | valid precision [0.324] | valid recall [0.353] | valid f0.5 [0.324] | valid time 0h 1m 16s
Fri 04 Oct 2024 12:36:43 INFO ---------- test total [246] | test precision [0.357] | test recall [0.396] | test f0.5 [0.357] | test time 0h 1m 16s
Fri 04 Oct 2024 12:36:55 INFO epoch [ 71] train time 0h 0m 11s |  loss |[1454.831]
Fri 04 Oct 2024 12:37:06 INFO epoch [ 72] train time 0h 0m 11s |  loss |[1450.364]
Fri 04 Oct 2024 12:37:17 INFO epoch [ 73] train time 0h 0m 11s |  loss |[1443.824]
Fri 04 Oct 2024 12:37:28 INFO epoch [ 74] train time 0h 0m 11s |  loss |[1440.443]
Fri 04 Oct 2024 12:37:40 INFO epoch [ 75] train time 0h 0m 11s |  loss |[1442.743]
Fri 04 Oct 2024 12:37:51 INFO epoch [ 76] train time 0h 0m 11s |  loss |[1440.751]
Fri 04 Oct 2024 12:38:02 INFO epoch [ 77] train time 0h 0m 11s |  loss |[1435.176]
Fri 04 Oct 2024 12:38:13 INFO epoch [ 78] train time 0h 0m 11s |  loss |[1435.365]
Fri 04 Oct 2024 12:38:24 INFO epoch [ 79] train time 0h 0m 11s |  loss |[1437.722]
Fri 04 Oct 2024 12:38:36 INFO epoch [ 80] train time 0h 0m 11s |  loss |[1429.866]
Fri 04 Oct 2024 12:39:52 INFO ---------- valid total [245] | valid precision [0.327] | valid recall [0.356] | valid f0.5 [0.326] | valid time 0h 1m 16s
Fri 04 Oct 2024 12:41:09 INFO ---------- test total [246] | test precision [0.368] | test recall [0.399] | test f0.5 [0.364] | test time 0h 1m 16s
Fri 04 Oct 2024 12:41:22 INFO epoch [ 81] train time 0h 0m 11s |  loss |[1438.877]
Fri 04 Oct 2024 12:41:33 INFO epoch [ 82] train time 0h 0m 11s |  loss |[1435.125]
Fri 04 Oct 2024 12:41:44 INFO epoch [ 83] train time 0h 0m 11s |  loss |[1427.177]
Fri 04 Oct 2024 12:41:55 INFO epoch [ 84] train time 0h 0m 11s |  loss |[1433.144]
Fri 04 Oct 2024 12:42:06 INFO epoch [ 85] train time 0h 0m 11s |  loss |[1428.006]
Fri 04 Oct 2024 12:42:18 INFO epoch [ 86] train time 0h 0m 11s |  loss |[1427.533]
Fri 04 Oct 2024 12:42:29 INFO epoch [ 87] train time 0h 0m 11s |  loss |[1426.778]
Fri 04 Oct 2024 12:42:40 INFO epoch [ 88] train time 0h 0m 11s |  loss |[1420.902]
Fri 04 Oct 2024 12:42:51 INFO epoch [ 89] train time 0h 0m 11s |  loss |[1424.224]
Fri 04 Oct 2024 12:43:03 INFO epoch [ 90] train time 0h 0m 11s |  loss |[1422.776]
Fri 04 Oct 2024 12:44:19 INFO ---------- valid total [245] | valid precision [0.321] | valid recall [0.345] | valid f0.5 [0.319] | valid time 0h 1m 16s
Fri 04 Oct 2024 12:45:35 INFO ---------- test total [246] | test precision [0.364] | test recall [0.395] | test f0.5 [0.360] | test time 0h 1m 15s
Fri 04 Oct 2024 12:45:46 INFO epoch [ 91] train time 0h 0m 11s |  loss |[1423.408]
Fri 04 Oct 2024 12:45:57 INFO epoch [ 92] train time 0h 0m 11s |  loss |[1418.342]
Fri 04 Oct 2024 12:46:08 INFO epoch [ 93] train time 0h 0m 11s |  loss |[1415.659]
Fri 04 Oct 2024 12:46:19 INFO epoch [ 94] train time 0h 0m 11s |  loss |[1416.360]
Fri 04 Oct 2024 12:46:30 INFO epoch [ 95] train time 0h 0m 11s |  loss |[1412.140]
Fri 04 Oct 2024 12:46:42 INFO epoch [ 96] train time 0h 0m 11s |  loss |[1411.219]
Fri 04 Oct 2024 12:46:53 INFO epoch [ 97] train time 0h 0m 11s |  loss |[1408.060]
Fri 04 Oct 2024 12:47:04 INFO epoch [ 98] train time 0h 0m 11s |  loss |[1411.264]
Fri 04 Oct 2024 12:47:15 INFO epoch [ 99] train time 0h 0m 11s |  loss |[1405.155]
Fri 04 Oct 2024 12:47:26 INFO epoch [100] train time 0h 0m 11s |  loss |[1407.192]
Fri 04 Oct 2024 12:48:43 INFO ---------- valid total [245] | valid precision [0.317] | valid recall [0.344] | valid f0.5 [0.316] | valid time 0h 1m 16s
Fri 04 Oct 2024 12:49:59 INFO ---------- test total [246] | test precision [0.360] | test recall [0.397] | test f0.5 [0.360] | test time 0h 1m 15s
Fri 04 Oct 2024 12:50:10 INFO epoch [101] train time 0h 0m 11s |  loss |[1406.378]
Fri 04 Oct 2024 12:50:21 INFO epoch [102] train time 0h 0m 11s |  loss |[1403.937]
Fri 04 Oct 2024 12:50:32 INFO epoch [103] train time 0h 0m 11s |  loss |[1402.978]
Fri 04 Oct 2024 12:50:43 INFO epoch [104] train time 0h 0m 11s |  loss |[1408.248]
Fri 04 Oct 2024 12:50:55 INFO epoch [105] train time 0h 0m 11s |  loss |[1392.215]
Fri 04 Oct 2024 12:51:06 INFO epoch [106] train time 0h 0m 11s |  loss |[1399.804]
Fri 04 Oct 2024 12:51:17 INFO epoch [107] train time 0h 0m 11s |  loss |[1396.322]
Fri 04 Oct 2024 12:51:28 INFO epoch [108] train time 0h 0m 11s |  loss |[1395.174]
Fri 04 Oct 2024 12:51:40 INFO epoch [109] train time 0h 0m 11s |  loss |[1395.865]
Fri 04 Oct 2024 12:51:51 INFO epoch [110] train time 0h 0m 11s |  loss |[1394.159]
Fri 04 Oct 2024 12:53:07 INFO ---------- valid total [245] | valid precision [0.326] | valid recall [0.351] | valid f0.5 [0.325] | valid time 0h 1m 16s
Fri 04 Oct 2024 12:54:23 INFO ---------- test total [246] | test precision [0.366] | test recall [0.395] | test f0.5 [0.361] | test time 0h 1m 16s
Fri 04 Oct 2024 12:54:34 INFO epoch [111] train time 0h 0m 11s |  loss |[1392.899]
Fri 04 Oct 2024 12:54:45 INFO epoch [112] train time 0h 0m 11s |  loss |[1389.754]
Fri 04 Oct 2024 12:54:57 INFO epoch [113] train time 0h 0m 11s |  loss |[1386.081]
Fri 04 Oct 2024 12:55:08 INFO epoch [114] train time 0h 0m 11s |  loss |[1386.306]
Fri 04 Oct 2024 12:55:19 INFO epoch [115] train time 0h 0m 11s |  loss |[1384.721]
Fri 04 Oct 2024 12:55:30 INFO epoch [116] train time 0h 0m 11s |  loss |[1387.839]
Fri 04 Oct 2024 12:55:42 INFO epoch [117] train time 0h 0m 11s |  loss |[1378.270]
Fri 04 Oct 2024 12:55:53 INFO epoch [118] train time 0h 0m 11s |  loss |[1382.520]
Fri 04 Oct 2024 12:56:04 INFO epoch [119] train time 0h 0m 11s |  loss |[1380.217]
Fri 04 Oct 2024 12:56:16 INFO epoch [120] train time 0h 0m 11s |  loss |[1377.646]
Fri 04 Oct 2024 12:57:32 INFO ---------- valid total [245] | valid precision [0.326] | valid recall [0.355] | valid f0.5 [0.326] | valid time 0h 1m 15s
Fri 04 Oct 2024 12:58:47 INFO ---------- test total [246] | test precision [0.359] | test recall [0.399] | test f0.5 [0.363] | test time 0h 1m 15s
Fri 04 Oct 2024 12:58:59 INFO epoch [121] train time 0h 0m 11s |  loss |[1381.741]
Fri 04 Oct 2024 12:59:10 INFO epoch [122] train time 0h 0m 11s |  loss |[1382.380]
Fri 04 Oct 2024 12:59:21 INFO epoch [123] train time 0h 0m 11s |  loss |[1383.270]
Fri 04 Oct 2024 12:59:32 INFO epoch [124] train time 0h 0m 11s |  loss |[1375.306]
Fri 04 Oct 2024 12:59:43 INFO epoch [125] train time 0h 0m 11s |  loss |[1375.254]
Fri 04 Oct 2024 12:59:55 INFO epoch [126] train time 0h 0m 11s |  loss |[1370.761]
Fri 04 Oct 2024 13:00:06 INFO epoch [127] train time 0h 0m 11s |  loss |[1376.538]
Fri 04 Oct 2024 13:00:17 INFO epoch [128] train time 0h 0m 11s |  loss |[1372.522]
Fri 04 Oct 2024 13:00:29 INFO epoch [129] train time 0h 0m 11s |  loss |[1371.210]
Fri 04 Oct 2024 13:00:40 INFO epoch [130] train time 0h 0m 11s |  loss |[1372.473]
Fri 04 Oct 2024 13:01:56 INFO ---------- valid total [245] | valid precision [0.331] | valid recall [0.354] | valid f0.5 [0.329] | valid time 0h 1m 16s
Fri 04 Oct 2024 13:03:12 INFO ---------- test total [246] | test precision [0.360] | test recall [0.393] | test f0.5 [0.356] | test time 0h 1m 15s
Fri 04 Oct 2024 13:03:25 INFO epoch [131] train time 0h 0m 11s |  loss |[1372.537]
Fri 04 Oct 2024 13:03:36 INFO epoch [132] train time 0h 0m 11s |  loss |[1372.793]
Fri 04 Oct 2024 13:03:47 INFO epoch [133] train time 0h 0m 11s |  loss |[1368.545]
Fri 04 Oct 2024 13:03:59 INFO epoch [134] train time 0h 0m 11s |  loss |[1363.744]
Fri 04 Oct 2024 13:04:10 INFO epoch [135] train time 0h 0m 11s |  loss |[1366.849]
Fri 04 Oct 2024 13:04:21 INFO epoch [136] train time 0h 0m 11s |  loss |[1366.844]
Fri 04 Oct 2024 13:04:32 INFO epoch [137] train time 0h 0m 11s |  loss |[1366.061]
Fri 04 Oct 2024 13:04:44 INFO epoch [138] train time 0h 0m 11s |  loss |[1363.935]
Fri 04 Oct 2024 13:04:55 INFO epoch [139] train time 0h 0m 11s |  loss |[1361.013]
Fri 04 Oct 2024 13:05:06 INFO epoch [140] train time 0h 0m 11s |  loss |[1364.042]
Fri 04 Oct 2024 13:06:23 INFO ---------- valid total [245] | valid precision [0.327] | valid recall [0.351] | valid f0.5 [0.326] | valid time 0h 1m 16s
Fri 04 Oct 2024 13:07:39 INFO ---------- test total [246] | test precision [0.364] | test recall [0.397] | test f0.5 [0.363] | test time 0h 1m 16s
Fri 04 Oct 2024 13:07:50 INFO epoch [141] train time 0h 0m 11s |  loss |[1363.367]
Fri 04 Oct 2024 13:08:01 INFO epoch [142] train time 0h 0m 11s |  loss |[1358.703]
Fri 04 Oct 2024 13:08:12 INFO epoch [143] train time 0h 0m 11s |  loss |[1363.943]
Fri 04 Oct 2024 13:08:23 INFO epoch [144] train time 0h 0m 11s |  loss |[1354.636]
Fri 04 Oct 2024 13:08:35 INFO epoch [145] train time 0h 0m 11s |  loss |[1357.159]
Fri 04 Oct 2024 13:08:46 INFO epoch [146] train time 0h 0m 11s |  loss |[1357.254]
Fri 04 Oct 2024 13:08:57 INFO epoch [147] train time 0h 0m 11s |  loss |[1354.363]
Fri 04 Oct 2024 13:09:08 INFO epoch [148] train time 0h 0m 11s |  loss |[1357.267]
Fri 04 Oct 2024 13:09:20 INFO epoch [149] train time 0h 0m 11s |  loss |[1352.729]
Fri 04 Oct 2024 13:09:31 INFO epoch [150] train time 0h 0m 11s |  loss |[1357.409]
Fri 04 Oct 2024 13:10:47 INFO ---------- valid total [245] | valid precision [0.333] | valid recall [0.359] | valid f0.5 [0.332] | valid time 0h 1m 16s
Fri 04 Oct 2024 13:12:03 INFO ---------- test total [246] | test precision [0.357] | test recall [0.393] | test f0.5 [0.360] | test time 0h 1m 16s
Fri 04 Oct 2024 13:12:16 INFO epoch [151] train time 0h 0m 11s |  loss |[1350.050]
Fri 04 Oct 2024 13:12:28 INFO epoch [152] train time 0h 0m 11s |  loss |[1350.864]
Fri 04 Oct 2024 13:12:39 INFO epoch [153] train time 0h 0m 11s |  loss |[1350.121]
Fri 04 Oct 2024 13:12:50 INFO epoch [154] train time 0h 0m 11s |  loss |[1347.739]
Fri 04 Oct 2024 13:13:01 INFO epoch [155] train time 0h 0m 11s |  loss |[1352.474]
Fri 04 Oct 2024 13:13:13 INFO epoch [156] train time 0h 0m 11s |  loss |[1347.695]
Fri 04 Oct 2024 13:13:24 INFO epoch [157] train time 0h 0m 11s |  loss |[1350.887]
Fri 04 Oct 2024 13:13:35 INFO epoch [158] train time 0h 0m 11s |  loss |[1346.783]
Fri 04 Oct 2024 13:13:47 INFO epoch [159] train time 0h 0m 11s |  loss |[1349.499]
Fri 04 Oct 2024 13:13:58 INFO epoch [160] train time 0h 0m 11s |  loss |[1338.492]
Fri 04 Oct 2024 13:15:14 INFO ---------- valid total [245] | valid precision [0.333] | valid recall [0.356] | valid f0.5 [0.331] | valid time 0h 1m 15s
Fri 04 Oct 2024 13:16:30 INFO ---------- test total [246] | test precision [0.360] | test recall [0.391] | test f0.5 [0.358] | test time 0h 1m 16s
Fri 04 Oct 2024 13:16:41 INFO epoch [161] train time 0h 0m 11s |  loss |[1339.113]
Fri 04 Oct 2024 13:16:52 INFO epoch [162] train time 0h 0m 11s |  loss |[1344.226]
Fri 04 Oct 2024 13:17:04 INFO epoch [163] train time 0h 0m 11s |  loss |[1346.056]
Fri 04 Oct 2024 13:17:15 INFO epoch [164] train time 0h 0m 11s |  loss |[1341.165]
Fri 04 Oct 2024 13:17:26 INFO epoch [165] train time 0h 0m 11s |  loss |[1341.955]
Fri 04 Oct 2024 13:17:37 INFO epoch [166] train time 0h 0m 11s |  loss |[1341.689]
Fri 04 Oct 2024 13:17:49 INFO epoch [167] train time 0h 0m 11s |  loss |[1338.344]
Fri 04 Oct 2024 13:18:00 INFO epoch [168] train time 0h 0m 11s |  loss |[1337.770]
Fri 04 Oct 2024 13:18:11 INFO epoch [169] train time 0h 0m 11s |  loss |[1339.809]
Fri 04 Oct 2024 13:18:23 INFO epoch [170] train time 0h 0m 11s |  loss |[1337.413]
Fri 04 Oct 2024 13:19:39 INFO ---------- valid total [245] | valid precision [0.330] | valid recall [0.355] | valid f0.5 [0.329] | valid time 0h 1m 16s
Fri 04 Oct 2024 13:20:55 INFO ---------- test total [246] | test precision [0.361] | test recall [0.396] | test f0.5 [0.359] | test time 0h 1m 15s
Fri 04 Oct 2024 13:21:06 INFO epoch [171] train time 0h 0m 11s |  loss |[1338.620]
Fri 04 Oct 2024 13:21:17 INFO epoch [172] train time 0h 0m 11s |  loss |[1335.245]
Fri 04 Oct 2024 13:21:28 INFO epoch [173] train time 0h 0m 11s |  loss |[1340.625]
Fri 04 Oct 2024 13:21:39 INFO epoch [174] train time 0h 0m 11s |  loss |[1330.577]
Fri 04 Oct 2024 13:21:51 INFO epoch [175] train time 0h 0m 11s |  loss |[1333.863]
Fri 04 Oct 2024 13:22:02 INFO epoch [176] train time 0h 0m 11s |  loss |[1333.365]
Fri 04 Oct 2024 13:22:13 INFO epoch [177] train time 0h 0m 11s |  loss |[1332.048]
Fri 04 Oct 2024 13:22:25 INFO epoch [178] train time 0h 0m 11s |  loss |[1328.938]
Fri 04 Oct 2024 13:22:36 INFO epoch [179] train time 0h 0m 11s |  loss |[1335.496]
Fri 04 Oct 2024 13:22:47 INFO epoch [180] train time 0h 0m 11s |  loss |[1329.944]
Fri 04 Oct 2024 13:24:04 INFO ---------- valid total [245] | valid precision [0.330] | valid recall [0.354] | valid f0.5 [0.329] | valid time 0h 1m 16s
Fri 04 Oct 2024 13:25:20 INFO ---------- test total [246] | test precision [0.366] | test recall [0.397] | test f0.5 [0.364] | test time 0h 1m 15s
Fri 04 Oct 2024 13:25:31 INFO epoch [181] train time 0h 0m 11s |  loss |[1326.664]
Fri 04 Oct 2024 13:25:42 INFO epoch [182] train time 0h 0m 11s |  loss |[1330.165]
Fri 04 Oct 2024 13:25:53 INFO epoch [183] train time 0h 0m 11s |  loss |[1325.030]
Fri 04 Oct 2024 13:26:05 INFO epoch [184] train time 0h 0m 11s |  loss |[1327.478]
Fri 04 Oct 2024 13:26:16 INFO epoch [185] train time 0h 0m 11s |  loss |[1324.642]
Fri 04 Oct 2024 13:26:27 INFO epoch [186] train time 0h 0m 11s |  loss |[1324.925]
Fri 04 Oct 2024 13:26:38 INFO epoch [187] train time 0h 0m 11s |  loss |[1322.826]
Fri 04 Oct 2024 13:26:50 INFO epoch [188] train time 0h 0m 11s |  loss |[1323.139]
Fri 04 Oct 2024 13:27:01 INFO epoch [189] train time 0h 0m 11s |  loss |[1321.494]
Fri 04 Oct 2024 13:27:13 INFO epoch [190] train time 0h 0m 11s |  loss |[1324.691]
Fri 04 Oct 2024 13:28:29 INFO ---------- valid total [245] | valid precision [0.324] | valid recall [0.348] | valid f0.5 [0.323] | valid time 0h 1m 16s
Fri 04 Oct 2024 13:29:45 INFO ---------- test total [246] | test precision [0.366] | test recall [0.398] | test f0.5 [0.364] | test time 0h 1m 16s
Fri 04 Oct 2024 13:29:56 INFO epoch [191] train time 0h 0m 11s |  loss |[1325.137]
Fri 04 Oct 2024 13:30:08 INFO epoch [192] train time 0h 0m 11s |  loss |[1322.420]
Fri 04 Oct 2024 13:30:19 INFO epoch [193] train time 0h 0m 11s |  loss |[1318.014]
Fri 04 Oct 2024 13:30:30 INFO epoch [194] train time 0h 0m 11s |  loss |[1320.562]
Fri 04 Oct 2024 13:30:41 INFO epoch [195] train time 0h 0m 11s |  loss |[1324.709]
Fri 04 Oct 2024 13:30:53 INFO epoch [196] train time 0h 0m 11s |  loss |[1322.747]
Fri 04 Oct 2024 13:32:09 INFO ---------- valid total [245] | valid precision [0.320] | valid recall [0.346] | valid f0.5 [0.320] | valid time 0h 1m 16s
Fri 04 Oct 2024 13:33:25 INFO ---------- test total [246] | test precision [0.364] | test recall [0.396] | test f0.5 [0.362] | test time 0h 1m 16s
Fri 04 Oct 2024 13:33:36 INFO epoch [197] train time 0h 0m 11s |  loss |[1320.824]
Fri 04 Oct 2024 13:34:52 INFO ---------- valid total [245] | valid precision [0.331] | valid recall [0.352] | valid f0.5 [0.329] | valid time 0h 1m 16s
Fri 04 Oct 2024 13:36:09 INFO ---------- test total [246] | test precision [0.368] | test recall [0.397] | test f0.5 [0.363] | test time 0h 1m 16s
Fri 04 Oct 2024 13:36:20 INFO epoch [198] train time 0h 0m 11s |  loss |[1319.403]
Fri 04 Oct 2024 13:37:36 INFO ---------- valid total [245] | valid precision [0.326] | valid recall [0.351] | valid f0.5 [0.325] | valid time 0h 1m 16s
Fri 04 Oct 2024 13:38:52 INFO ---------- test total [246] | test precision [0.374] | test recall [0.407] | test f0.5 [0.372] | test time 0h 1m 16s
Fri 04 Oct 2024 13:39:04 INFO epoch [199] train time 0h 0m 11s |  loss |[1316.290]
Fri 04 Oct 2024 13:40:20 INFO ---------- valid total [245] | valid precision [0.326] | valid recall [0.351] | valid f0.5 [0.325] | valid time 0h 1m 16s
Fri 04 Oct 2024 13:41:36 INFO ---------- test total [246] | test precision [0.364] | test recall [0.397] | test f0.5 [0.362] | test time 0h 1m 16s
Fri 04 Oct 2024 13:41:47 INFO epoch [200] train time 0h 0m 11s |  loss |[1318.043]
Fri 04 Oct 2024 13:43:04 INFO ---------- valid total [245] | valid precision [0.328] | valid recall [0.350] | valid f0.5 [0.326] | valid time 0h 1m 16s
Fri 04 Oct 2024 13:44:19 INFO ---------- test total [246] | test precision [0.361] | test recall [0.393] | test f0.5 [0.360] | test time 0h 1m 15s
Fri 04 Oct 2024 13:44:19 INFO training finished.
                            best valid result: precision [0.333] | recall [0.359] | F0.5 [0.332]
                            best test result : precision [0.357] | recall [0.393] | F0.5 [0.360]
Wed 09 Oct 2024 08:11:53 INFO random_seed=2024
use_gpu=True
learning_rate=6e-06
train_batch_size=32
test_batch_size=1
epoch_nums=200
test_step=10
display_train_step=1
gpu_id=5
training_resume=False
load_best_config=False
supervising_mode=fully_supervised
validset_divide=True
test_only=False
shuffle=True
model_config_file=gectoolkit/properties/model/SynGEC.json
best_config_file=gectoolkit/properties/best_config/SynGEC_Visual_YOLO_CLIP.json
dataset_config_file=gectoolkit/properties/dataset/Visual_YOLO_CLIP.json
dataset_dir=dataset/Visual_YOLO_CLIP
checkpoint_file=checkpoint/SynGEC-Visual_YOLO_CLIP.pth
log_file=log/SynGEC-Visual_YOLO_CLIP.log
output_dir=result/SynGEC-Visual_YOLO_CLIP
checkpoint_dir=checkpoint/SynGEC-Visual_YOLO_CLIP
min_word_keep=5
min_generate_keep=5
language=zh
fp16_init_scale=128
distributed_port=-1
decoder_embed_path=None
quant_noise_pq_block_size=8
best_checkpoint_metric=loss
cross_self_attention=False
validate_interval=1
tie_adaptive_weights=False
bpe=None
decoder_normalize_before=False
cpu=False
optimizer_overrides={}
quant_noise_pq=0
lr_scheduler=polynomial_decay
no_save_optimizer_state=False
train_subset=train
no_cross_attention=False
distributed_world_size=1
decoder_layerdrop=0
skip_invalid_size_inputs_valid_test=True
lr=[0.0005]
slowmo_momentum=None
log_interval=100
user_dir=./gectoolkit/model/SynGEC/src/src_syngec/syngec_model
min_loss_scale=0.0001
dual_aggregation_freeze=True
decoder_output_dim=1024
curriculum=0
scoring=bleu
optimizer=adam
adam_betas=(0.9,0.999)
share_decoder_input_output_embed=True
fp16_no_flatten_grads=False
distributed_backend=nccl
adaptive_input=False
dpd_suffix=['dpd']
attention_dropout=0.0
fp16=True
pipeline_checkpoint=never
fix_batches_to_gpus=False
fp16_scale_tolerance=0.0
valid_subset=valid
gen_subset=test
no_last_checkpoints=False
decoder_attention_heads=16
distributed_wrapper=DDP
activation_dropout=0.0
log_format=tqdm
decoder_embed_dim=1024
dual_aggregation_beta=0.5
disable_validation=False
quant_noise_scalar=0
use_bmuf=False
gat_encoder_layers=3
arch=syntax_enhanced_bart_large
eval_bleu_print_samples=False
no_scale_embedding=True
zero_sharding=none
pipeline_decoder_devices=None
save_interval_updates=0
localsgd_frequency=3
ignore_prefix_size=0
eval_bleu_args=None
encoder_layerdrop=0
syntax_type=['dep']
distributed_no_spawn=False
left_pad_source=True
decoder_layers=12
adaptive_softmax_cutoff=None
upsample_primary=1
ddp_backend=c10d
validate_after_updates=0
power=1.0
data_buffer_size=10
memory_efficient_bf16=False
num_batch_buckets=0
share_all_embeddings=True
alpha=1.0
gated_sum=False
distributed_init_method=None
report_accuracy=False
end_learning_rate=0.0
batch_size_valid=None
pipeline_devices=None
left_pad_target=False
source_word_dropout_probs=False
bf16=False
swm_suffix=swm
encoder_embed_dim=1024
force_anneal=None
no_epoch_checkpoints=False
syntax_encoder=GCN
encoder_ffn_embed_dim=4096
label_smoothing=0.1
num_shards=1
find_unused_parameters=True
no_progress_bar=False
load_alignments=False
use_old_adam=False
eval_bleu_detok_args=None
tensorboard_logdir=None
slowmo_algorithm=LocalSGD
fast_stat_sync=False
layernorm_embedding=True
encoder_layers_to_keep=None
eval_bleu_remove_bpe=None
scale_syntax_encoder_lr=None
eval_bleu=False
fp16_scale_window=None
pipeline_encoder_balance=None
pipeline_encoder_devices=None
relu_dropout=0.0
threshold_loss_scale=None
activation_fn=gelu
task=syntax-enhanced-translation
target_lang=tgt
bart_model_file_from_transformers=None
all_gather_list_size=16384
stop_time_hours=0
validate_interval_updates=0
save_interval=1
conll_suffix=['conll']
empty_cache_freq=0
encoder_learned_pos=True
tpu=False
nprocs_per_node=1
keep_last_epochs=10
device_id=0
source_lang_with_nt=src_nt
use_dpd=False
pipeline_chunks=0
cross_syntax_fuse=False
keep_interval_updates=-1
encoder_embed_path=None
adam_eps=1e-08
model_parallel_size=1
sentence_avg=False
encoder_layers=12
decoder_ffn_embed_dim=4096
dataset_impl=None
criterion=label_smoothed_cross_entropy
fixed_validation_seed=None
profile=False
distributed_rank=0
source_lang=src
eval_tokenized_bleu=False
source_word_dropout=0.2
adaptive_softmax_dropout=0
syntax_model_file=None
checkpoint_suffix=
required_seq_len_multiple=1
no_save=False
use_syntax=True
probs_suffix=['probs']
decoder_learned_pos=True
decoder_input_dim=1024
memory_efficient_fp16=False
decoder_layers_to_keep=None
gat_attention_heads=4
bucket_cap_mb=25
checkpoint_shard_count=1
pipeline_model_parallel=False
encoder_normalize_before=False
keep_best_checkpoints=-1
no_token_positional_embeddings=False
pooler_activation_fn=tanh
shard_id=0
only_dsa=False
max_update=0
encoder_attention_heads=16
freeze_bart_parameters=True
tokenizer=None
total_num_update=1000000
pipeline_decoder_balance=None
quantization_config_path=None
broadcast_buffers=False
batch_size=None
maximize_best_checkpoint_metric=False
pooler_dropout=0.0
warmup_updates=2000
min_lr=-1.0
only_gnn=True
eval_bleu_detok=space
no_seed_provided=False
truncate_source=False
pipeline_balance=None
model=SynGEC
dataset=Visual_YOLO_CLIP
augment=none
method=YOLO_CLIP
correctionmodel=SynGEC
device=cuda
map_location=cuda
gpu_nums=1


Wed 09 Oct 2024 08:11:53 INFO [src] dictionary: 21132 types
Wed 09 Oct 2024 08:11:53 INFO [tgt] dictionary: 21132 types
Wed 09 Oct 2024 08:11:53 INFO [syntax label0] dictionary: 51 types
Wed 09 Oct 2024 08:11:53 INFO [src] dictionary: 21132 types
Wed 09 Oct 2024 08:11:53 INFO [tgt] dictionary: 21132 types
Wed 09 Oct 2024 08:11:53 INFO [syntax label0] dictionary: 51 types
Wed 09 Oct 2024 08:11:53 INFO loaded 245 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_YOLO_CLIP_with_syntax_bart/bin/valid.src-tgt.src
Wed 09 Oct 2024 08:11:53 INFO loaded 245 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_YOLO_CLIP_with_syntax_bart/bin/valid.src-tgt.tgt
Wed 09 Oct 2024 08:11:53 INFO ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_YOLO_CLIP_with_syntax_bart/bin valid src-tgt 245 examples
Wed 09 Oct 2024 08:11:53 INFO loaded 245 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_YOLO_CLIP_with_syntax_bart/bin/valid.conll.src-tgt.src
Wed 09 Oct 2024 08:11:53 INFO loaded 245 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_YOLO_CLIP_with_syntax_bart/bin/valid.dpd.src-tgt.src
Wed 09 Oct 2024 08:11:53 INFO loaded 245 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_YOLO_CLIP_with_syntax_bart/bin/valid.probs.src-tgt.src
Wed 09 Oct 2024 08:11:53 INFO success! syntax types: 1, source conll lines: 245
Wed 09 Oct 2024 08:11:53 INFO loaded 1960 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_YOLO_CLIP_with_syntax_bart/bin/train.src-tgt.src
Wed 09 Oct 2024 08:11:53 INFO loaded 1960 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_YOLO_CLIP_with_syntax_bart/bin/train.src-tgt.tgt
Wed 09 Oct 2024 08:11:53 INFO ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_YOLO_CLIP_with_syntax_bart/bin train src-tgt 1960 examples
Wed 09 Oct 2024 08:11:53 INFO loaded 1960 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_YOLO_CLIP_with_syntax_bart/bin/train.conll.src-tgt.src
Wed 09 Oct 2024 08:11:53 INFO loaded 1960 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_YOLO_CLIP_with_syntax_bart/bin/train.dpd.src-tgt.src
Wed 09 Oct 2024 08:11:53 INFO loaded 1960 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_YOLO_CLIP_with_syntax_bart/bin/train.probs.src-tgt.src
Wed 09 Oct 2024 08:11:53 INFO success! syntax types: 1, source conll lines: 1960
Wed 09 Oct 2024 08:11:53 INFO loaded 246 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_YOLO_CLIP_test_with_syntax_bart/bin/test.conll.src-tgt.src
Wed 09 Oct 2024 08:11:53 INFO loaded 246 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_YOLO_CLIP_test_with_syntax_bart/bin/test.dpd.src-tgt.src
Wed 09 Oct 2024 08:11:53 INFO loaded 246 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_YOLO_CLIP_test_with_syntax_bart/bin/test.probs.src-tgt.src
Wed 09 Oct 2024 08:11:53 INFO success! syntax types: 1, source conll lines: 246
Wed 09 Oct 2024 08:12:02 INFO detected shared parameter: encoder.sentence_encoder.embed_tokens.weight <- decoder.embed_tokens.weight
Wed 09 Oct 2024 08:12:02 INFO detected shared parameter: encoder.sentence_encoder.embed_tokens.weight <- decoder.output_projection.weight
Wed 09 Oct 2024 08:12:02 INFO ***********************CUDA enviroments for all 1 workers***********************
Wed 09 Oct 2024 08:12:02 INFO rank   0: capabilities =  8.0  ; total memory = 79.151 GB ; name = NVIDIA A800 80GB PCIe                   
Wed 09 Oct 2024 08:12:02 INFO ***********************CUDA enviroments for all 1 workers***********************
Wed 09 Oct 2024 08:12:06 INFO loaded checkpoint ./gectoolkit/properties/model/SynGEC/preprocess/gopar/chinese_Visual_YOLO_CLIP_bart_baseline/checkpoint_best.pt (epoch 16 @ 1042 updates)
Wed 09 Oct 2024 08:12:06 INFO loading train data for epoch 16
Wed 09 Oct 2024 08:12:06 INFO loaded 1960 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_YOLO_CLIP_with_syntax_bart/bin/train.src-tgt.src
Wed 09 Oct 2024 08:12:06 INFO loaded 1960 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_YOLO_CLIP_with_syntax_bart/bin/train.src-tgt.tgt
Wed 09 Oct 2024 08:12:06 INFO ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_YOLO_CLIP_with_syntax_bart/bin train src-tgt 1960 examples
Wed 09 Oct 2024 08:12:06 INFO loaded 1960 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_YOLO_CLIP_with_syntax_bart/bin/train.conll.src-tgt.src
Wed 09 Oct 2024 08:12:06 INFO loaded 1960 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_YOLO_CLIP_with_syntax_bart/bin/train.dpd.src-tgt.src
Wed 09 Oct 2024 08:12:06 INFO loaded 1960 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_YOLO_CLIP_with_syntax_bart/bin/train.probs.src-tgt.src
Wed 09 Oct 2024 08:12:06 INFO success! syntax types: 1, source conll lines: 1960
Wed 09 Oct 2024 08:12:08 INFO SynGEC(
  (model): SyntaxEnhancedBARTModel(
    (encoder): SyntaxEnhancedTransformerEncoder(
      (sentence_encoder): SyntaxEnhancedSentenceTransformerEncoder(
        (dropout_module): FairseqDropout()
        (embed_tokens): Embedding(21132, 1024, padding_idx=1)
        (embed_positions): LearnedPositionalEmbedding(514, 1024, padding_idx=1)
        (layernorm_embedding): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        (layers): ModuleList(
          (0-11): 12 x DSATransformerEncoderLayer(
            (self_attn): DSAMultiheadAttention(
              (dropout_module): FairseqDropout()
              (k_proj): Linear(in_features=1024, out_features=1024, bias=True)
              (v_proj): Linear(in_features=1024, out_features=1024, bias=True)
              (q_proj): Linear(in_features=1024, out_features=1024, bias=True)
              (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
            )
            (self_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
            (dropout_module): FairseqDropout()
            (activation_dropout_module): FairseqDropout()
            (fc1): Linear(in_features=1024, out_features=4096, bias=True)
            (fc2): Linear(in_features=4096, out_features=1024, bias=True)
            (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
      )
      (syntax_encoder): SyntaxEnhancedSyntaxGuidedTransformerEncoder(
        (dropout_module): FairseqDropout()
        (embed_tokens): Embedding(51, 1024, padding_idx=0)
        (layers): ModuleList(
          (0-2): 3 x GCNSyntaxGuidedTransformerEncoderLayer(
            (gcn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
            (dropout_module): FairseqDropout()
            (activation_dropout_module): FairseqDropout()
            (W_out): Linear(in_features=2048, out_features=1024, bias=True)
            (W_in): Linear(in_features=2048, out_features=1024, bias=True)
            (fc): Linear(in_features=1024, out_features=1024, bias=True)
            (fc1): Linear(in_features=1024, out_features=4096, bias=True)
            (fc2): Linear(in_features=4096, out_features=1024, bias=True)
            (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
      )
    )
    (decoder): SyntaxEnhancedTransformerDecoder(
      (dropout_module): FairseqDropout()
      (embed_tokens): Embedding(21132, 1024, padding_idx=1)
      (embed_positions): LearnedPositionalEmbedding(514, 1024, padding_idx=1)
      (layernorm_embedding): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      (layers): ModuleList(
        (0-11): 12 x TransformerDecoderLayer(
          (dropout_module): FairseqDropout()
          (self_attn): MultiheadAttention(
            (dropout_module): FairseqDropout()
            (k_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (v_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (q_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
          )
          (activation_dropout_module): FairseqDropout()
          (self_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          (encoder_attn): MultiheadAttention(
            (dropout_module): FairseqDropout()
            (k_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (v_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (q_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
          )
          (encoder_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          (fc1): Linear(in_features=1024, out_features=4096, bias=True)
          (fc2): Linear(in_features=4096, out_features=1024, bias=True)
          (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        )
      )
      (output_projection): Linear(in_features=1024, out_features=21132, bias=False)
    )
    (classification_heads): ModuleDict()
  )
  (criterion): LabelSmoothedCrossEntropyCriterion()
)
Wed 09 Oct 2024 08:12:08 INFO start training...
Wed 09 Oct 2024 08:12:08 INFO | supervised_trainer |NOTE: overflow detected, setting loss scale to: 64.0
Wed 09 Oct 2024 08:12:09 INFO | supervised_trainer |NOTE: overflow detected, setting loss scale to: 32.0
Wed 09 Oct 2024 08:12:10 INFO | supervised_trainer |NOTE: overflow detected, setting loss scale to: 16.0
Wed 09 Oct 2024 08:12:19 INFO epoch [  1] train time 0h 0m 11s |  loss |[6038.877]
Wed 09 Oct 2024 08:12:21 INFO | supervised_trainer |NOTE: overflow detected, setting loss scale to: 8.0
Wed 09 Oct 2024 08:12:30 INFO epoch [  2] train time 0h 0m 10s |  loss |[5325.446]
Wed 09 Oct 2024 08:12:40 INFO | supervised_trainer |NOTE: overflow detected, setting loss scale to: 4.0
Wed 09 Oct 2024 08:12:41 INFO epoch [  3] train time 0h 0m 10s |  loss |[5210.884]
Wed 09 Oct 2024 08:12:52 INFO epoch [  4] train time 0h 0m 10s |  loss |[4964.830]
Wed 09 Oct 2024 08:13:03 INFO epoch [  5] train time 0h 0m 10s |  loss |[3192.902]
Wed 09 Oct 2024 08:13:14 INFO epoch [  6] train time 0h 0m 10s |  loss |[2266.966]
Wed 09 Oct 2024 08:13:25 INFO epoch [  7] train time 0h 0m 10s |  loss |[2032.546]
Wed 09 Oct 2024 08:13:36 INFO epoch [  8] train time 0h 0m 10s |  loss |[1912.543]
Wed 09 Oct 2024 08:13:47 INFO epoch [  9] train time 0h 0m 10s |  loss |[1841.563]
Wed 09 Oct 2024 08:13:57 INFO epoch [ 10] train time 0h 0m 10s |  loss |[1795.483]
Wed 09 Oct 2024 08:15:11 INFO ---------- valid total [245] | valid precision [0.279] | valid recall [0.325] | valid f0.5 [0.282] | valid time 0h 1m 13s
Wed 09 Oct 2024 08:16:26 INFO ---------- test total [246] | test precision [0.319] | test recall [0.352] | test f0.5 [0.318] | test time 0h 1m 14s
Wed 09 Oct 2024 08:16:39 INFO epoch [ 11] train time 0h 0m 10s |  loss |[1757.778]
Wed 09 Oct 2024 08:16:50 INFO epoch [ 12] train time 0h 0m 10s |  loss |[1721.619]
Wed 09 Oct 2024 08:17:01 INFO epoch [ 13] train time 0h 0m 10s |  loss |[1700.926]
Wed 09 Oct 2024 08:17:12 INFO epoch [ 14] train time 0h 0m 10s |  loss |[1685.852]
Wed 09 Oct 2024 08:17:22 INFO epoch [ 15] train time 0h 0m 10s |  loss |[1677.534]
Wed 09 Oct 2024 08:17:33 INFO epoch [ 16] train time 0h 0m 10s |  loss |[1653.896]
Wed 09 Oct 2024 08:17:44 INFO epoch [ 17] train time 0h 0m 10s |  loss |[1643.389]
Wed 09 Oct 2024 08:17:55 INFO epoch [ 18] train time 0h 0m 10s |  loss |[1634.245]
Wed 09 Oct 2024 08:18:06 INFO epoch [ 19] train time 0h 0m 10s |  loss |[1626.162]
Wed 09 Oct 2024 08:18:17 INFO epoch [ 20] train time 0h 0m 10s |  loss |[1612.738]
Wed 09 Oct 2024 08:19:34 INFO ---------- valid total [245] | valid precision [0.292] | valid recall [0.332] | valid f0.5 [0.294] | valid time 0h 1m 16s
Wed 09 Oct 2024 08:20:51 INFO ---------- test total [246] | test precision [0.348] | test recall [0.375] | test f0.5 [0.343] | test time 0h 1m 17s
Wed 09 Oct 2024 08:21:04 INFO epoch [ 21] train time 0h 0m 11s |  loss |[1605.188]
Wed 09 Oct 2024 08:21:15 INFO epoch [ 22] train time 0h 0m 10s |  loss |[1601.284]
Wed 09 Oct 2024 08:21:26 INFO epoch [ 23] train time 0h 0m 10s |  loss |[1590.162]
Wed 09 Oct 2024 08:21:37 INFO epoch [ 24] train time 0h 0m 10s |  loss |[1580.811]
Wed 09 Oct 2024 08:21:48 INFO epoch [ 25] train time 0h 0m 10s |  loss |[1580.061]
Wed 09 Oct 2024 08:21:59 INFO epoch [ 26] train time 0h 0m 11s |  loss |[1577.173]
Wed 09 Oct 2024 08:22:10 INFO epoch [ 27] train time 0h 0m 11s |  loss |[1568.097]
Wed 09 Oct 2024 08:22:21 INFO epoch [ 28] train time 0h 0m 11s |  loss |[1561.476]
Wed 09 Oct 2024 08:22:32 INFO epoch [ 29] train time 0h 0m 10s |  loss |[1552.945]
Wed 09 Oct 2024 08:22:43 INFO epoch [ 30] train time 0h 0m 10s |  loss |[1551.482]
Wed 09 Oct 2024 08:23:59 INFO ---------- valid total [245] | valid precision [0.302] | valid recall [0.343] | valid f0.5 [0.305] | valid time 0h 1m 16s
Wed 09 Oct 2024 08:25:15 INFO ---------- test total [246] | test precision [0.342] | test recall [0.376] | test f0.5 [0.339] | test time 0h 1m 15s
Wed 09 Oct 2024 08:25:28 INFO epoch [ 31] train time 0h 0m 10s |  loss |[1544.064]
Wed 09 Oct 2024 08:25:39 INFO epoch [ 32] train time 0h 0m 10s |  loss |[1549.227]
Wed 09 Oct 2024 08:25:50 INFO epoch [ 33] train time 0h 0m 10s |  loss |[1539.787]
Wed 09 Oct 2024 08:26:01 INFO epoch [ 34] train time 0h 0m 10s |  loss |[1532.472]
Wed 09 Oct 2024 08:26:12 INFO epoch [ 35] train time 0h 0m 10s |  loss |[1532.558]
Wed 09 Oct 2024 08:26:23 INFO epoch [ 36] train time 0h 0m 10s |  loss |[1533.747]
Wed 09 Oct 2024 08:26:33 INFO epoch [ 37] train time 0h 0m 10s |  loss |[1523.478]
Wed 09 Oct 2024 08:26:44 INFO epoch [ 38] train time 0h 0m 10s |  loss |[1523.658]
Wed 09 Oct 2024 08:26:55 INFO epoch [ 39] train time 0h 0m 10s |  loss |[1517.171]
Wed 09 Oct 2024 08:27:06 INFO epoch [ 40] train time 0h 0m 10s |  loss |[1512.164]
Wed 09 Oct 2024 08:28:22 INFO ---------- valid total [245] | valid precision [0.310] | valid recall [0.346] | valid f0.5 [0.312] | valid time 0h 1m 16s
Wed 09 Oct 2024 08:29:38 INFO ---------- test total [246] | test precision [0.338] | test recall [0.367] | test f0.5 [0.333] | test time 0h 1m 15s
Wed 09 Oct 2024 08:29:51 INFO epoch [ 41] train time 0h 0m 10s |  loss |[1519.097]
Wed 09 Oct 2024 08:30:02 INFO epoch [ 42] train time 0h 0m 10s |  loss |[1512.423]
Wed 09 Oct 2024 08:30:13 INFO epoch [ 43] train time 0h 0m 10s |  loss |[1505.577]
Wed 09 Oct 2024 08:30:24 INFO epoch [ 44] train time 0h 0m 10s |  loss |[1507.432]
Wed 09 Oct 2024 08:30:35 INFO epoch [ 45] train time 0h 0m 10s |  loss |[1504.694]
Wed 09 Oct 2024 08:30:45 INFO epoch [ 46] train time 0h 0m 10s |  loss |[1496.300]
Wed 09 Oct 2024 08:30:56 INFO epoch [ 47] train time 0h 0m 10s |  loss |[1495.667]
Wed 09 Oct 2024 08:31:07 INFO epoch [ 48] train time 0h 0m 10s |  loss |[1492.579]
Wed 09 Oct 2024 08:31:18 INFO epoch [ 49] train time 0h 0m 10s |  loss |[1490.110]
Wed 09 Oct 2024 08:31:29 INFO epoch [ 50] train time 0h 0m 10s |  loss |[1499.321]
Wed 09 Oct 2024 08:32:46 INFO ---------- valid total [245] | valid precision [0.304] | valid recall [0.345] | valid f0.5 [0.307] | valid time 0h 1m 16s
Wed 09 Oct 2024 08:34:02 INFO ---------- test total [246] | test precision [0.363] | test recall [0.392] | test f0.5 [0.358] | test time 0h 1m 16s
Wed 09 Oct 2024 08:34:13 INFO epoch [ 51] train time 0h 0m 10s |  loss |[1484.335]
Wed 09 Oct 2024 08:34:24 INFO epoch [ 52] train time 0h 0m 10s |  loss |[1489.170]
Wed 09 Oct 2024 08:34:35 INFO epoch [ 53] train time 0h 0m 10s |  loss |[1482.261]
Wed 09 Oct 2024 08:34:46 INFO epoch [ 54] train time 0h 0m 10s |  loss |[1481.865]
Wed 09 Oct 2024 08:34:57 INFO epoch [ 55] train time 0h 0m 10s |  loss |[1478.735]
Wed 09 Oct 2024 08:35:07 INFO epoch [ 56] train time 0h 0m 10s |  loss |[1472.965]
Wed 09 Oct 2024 08:35:18 INFO epoch [ 57] train time 0h 0m 10s |  loss |[1477.323]
Wed 09 Oct 2024 08:35:29 INFO epoch [ 58] train time 0h 0m 10s |  loss |[1471.211]
Wed 09 Oct 2024 08:35:40 INFO epoch [ 59] train time 0h 0m 11s |  loss |[1471.570]
Wed 09 Oct 2024 08:35:51 INFO epoch [ 60] train time 0h 0m 11s |  loss |[1463.296]
Wed 09 Oct 2024 08:37:09 INFO ---------- valid total [245] | valid precision [0.298] | valid recall [0.345] | valid f0.5 [0.302] | valid time 0h 1m 17s
Wed 09 Oct 2024 08:38:26 INFO ---------- test total [246] | test precision [0.331] | test recall [0.363] | test f0.5 [0.327] | test time 0h 1m 16s
Wed 09 Oct 2024 08:38:37 INFO epoch [ 61] train time 0h 0m 10s |  loss |[1466.446]
Wed 09 Oct 2024 08:38:48 INFO epoch [ 62] train time 0h 0m 10s |  loss |[1462.589]
Wed 09 Oct 2024 08:38:59 INFO epoch [ 63] train time 0h 0m 10s |  loss |[1458.615]
Wed 09 Oct 2024 08:39:10 INFO epoch [ 64] train time 0h 0m 10s |  loss |[1458.155]
Wed 09 Oct 2024 08:39:20 INFO epoch [ 65] train time 0h 0m 10s |  loss |[1465.272]
Wed 09 Oct 2024 08:39:31 INFO epoch [ 66] train time 0h 0m 10s |  loss |[1454.800]
Wed 09 Oct 2024 08:39:42 INFO epoch [ 67] train time 0h 0m 10s |  loss |[1456.723]
Wed 09 Oct 2024 08:39:53 INFO epoch [ 68] train time 0h 0m 10s |  loss |[1452.205]
Wed 09 Oct 2024 08:40:04 INFO epoch [ 69] train time 0h 0m 10s |  loss |[1455.352]
Wed 09 Oct 2024 08:40:15 INFO epoch [ 70] train time 0h 0m 10s |  loss |[1454.856]
Wed 09 Oct 2024 08:41:33 INFO ---------- valid total [245] | valid precision [0.303] | valid recall [0.340] | valid f0.5 [0.304] | valid time 0h 1m 17s
Wed 09 Oct 2024 08:42:51 INFO ---------- test total [246] | test precision [0.349] | test recall [0.378] | test f0.5 [0.345] | test time 0h 1m 17s
Wed 09 Oct 2024 08:43:01 INFO epoch [ 71] train time 0h 0m 10s |  loss |[1452.248]
Wed 09 Oct 2024 08:43:12 INFO epoch [ 72] train time 0h 0m 10s |  loss |[1448.589]
Wed 09 Oct 2024 08:43:23 INFO epoch [ 73] train time 0h 0m 10s |  loss |[1441.546]
Wed 09 Oct 2024 08:43:34 INFO epoch [ 74] train time 0h 0m 10s |  loss |[1444.349]
Wed 09 Oct 2024 08:43:45 INFO epoch [ 75] train time 0h 0m 10s |  loss |[1438.330]
Wed 09 Oct 2024 08:43:56 INFO epoch [ 76] train time 0h 0m 10s |  loss |[1441.469]
Wed 09 Oct 2024 08:44:07 INFO epoch [ 77] train time 0h 0m 10s |  loss |[1439.331]
Wed 09 Oct 2024 08:44:18 INFO epoch [ 78] train time 0h 0m 10s |  loss |[1439.647]
Wed 09 Oct 2024 08:44:29 INFO epoch [ 79] train time 0h 0m 10s |  loss |[1434.706]
Wed 09 Oct 2024 08:44:40 INFO epoch [ 80] train time 0h 0m 10s |  loss |[1433.996]
Wed 09 Oct 2024 08:45:58 INFO ---------- valid total [245] | valid precision [0.321] | valid recall [0.357] | valid f0.5 [0.322] | valid time 0h 1m 17s
Wed 09 Oct 2024 08:47:15 INFO ---------- test total [246] | test precision [0.350] | test recall [0.372] | test f0.5 [0.344] | test time 0h 1m 16s
Wed 09 Oct 2024 08:47:20 INFO | supervised_trainer |NOTE: overflow detected, setting loss scale to: 2.0
Wed 09 Oct 2024 08:47:27 INFO epoch [ 81] train time 0h 0m 10s |  loss |[1435.517]
Wed 09 Oct 2024 08:47:38 INFO epoch [ 82] train time 0h 0m 10s |  loss |[1429.569]
Wed 09 Oct 2024 08:47:49 INFO epoch [ 83] train time 0h 0m 10s |  loss |[1427.443]
Wed 09 Oct 2024 08:48:01 INFO epoch [ 84] train time 0h 0m 10s |  loss |[1431.051]
Wed 09 Oct 2024 08:48:12 INFO epoch [ 85] train time 0h 0m 10s |  loss |[1424.006]
Wed 09 Oct 2024 08:48:23 INFO epoch [ 86] train time 0h 0m 11s |  loss |[1419.612]
Wed 09 Oct 2024 08:48:34 INFO epoch [ 87] train time 0h 0m 11s |  loss |[1422.050]
Wed 09 Oct 2024 08:48:45 INFO epoch [ 88] train time 0h 0m 11s |  loss |[1424.795]
Wed 09 Oct 2024 08:48:56 INFO epoch [ 89] train time 0h 0m 11s |  loss |[1421.164]
Wed 09 Oct 2024 08:49:07 INFO epoch [ 90] train time 0h 0m 11s |  loss |[1418.911]
Wed 09 Oct 2024 08:50:23 INFO ---------- valid total [245] | valid precision [0.314] | valid recall [0.349] | valid f0.5 [0.315] | valid time 0h 1m 16s
Wed 09 Oct 2024 08:51:39 INFO ---------- test total [246] | test precision [0.346] | test recall [0.374] | test f0.5 [0.345] | test time 0h 1m 15s
Wed 09 Oct 2024 08:51:50 INFO epoch [ 91] train time 0h 0m 11s |  loss |[1416.943]
Wed 09 Oct 2024 08:52:01 INFO epoch [ 92] train time 0h 0m 11s |  loss |[1419.644]
Wed 09 Oct 2024 08:52:12 INFO epoch [ 93] train time 0h 0m 10s |  loss |[1414.491]
Wed 09 Oct 2024 08:52:23 INFO epoch [ 94] train time 0h 0m 10s |  loss |[1410.224]
Wed 09 Oct 2024 08:52:34 INFO epoch [ 95] train time 0h 0m 10s |  loss |[1407.914]
Wed 09 Oct 2024 08:52:45 INFO epoch [ 96] train time 0h 0m 10s |  loss |[1409.631]
Wed 09 Oct 2024 08:52:56 INFO epoch [ 97] train time 0h 0m 10s |  loss |[1410.298]
Wed 09 Oct 2024 08:53:07 INFO epoch [ 98] train time 0h 0m 10s |  loss |[1403.611]
Wed 09 Oct 2024 08:53:18 INFO epoch [ 99] train time 0h 0m 10s |  loss |[1405.076]
Wed 09 Oct 2024 08:53:29 INFO epoch [100] train time 0h 0m 10s |  loss |[1404.527]
Wed 09 Oct 2024 08:54:47 INFO ---------- valid total [245] | valid precision [0.313] | valid recall [0.352] | valid f0.5 [0.315] | valid time 0h 1m 17s
Wed 09 Oct 2024 08:56:03 INFO ---------- test total [246] | test precision [0.337] | test recall [0.377] | test f0.5 [0.340] | test time 0h 1m 16s
Wed 09 Oct 2024 08:56:14 INFO epoch [101] train time 0h 0m 10s |  loss |[1400.136]
Wed 09 Oct 2024 08:56:25 INFO epoch [102] train time 0h 0m 10s |  loss |[1396.355]
Wed 09 Oct 2024 08:56:36 INFO epoch [103] train time 0h 0m 10s |  loss |[1401.051]
Wed 09 Oct 2024 08:56:47 INFO epoch [104] train time 0h 0m 10s |  loss |[1398.739]
Wed 09 Oct 2024 08:56:58 INFO epoch [105] train time 0h 0m 10s |  loss |[1400.291]
Wed 09 Oct 2024 08:57:09 INFO epoch [106] train time 0h 0m 10s |  loss |[1397.751]
Wed 09 Oct 2024 08:57:20 INFO epoch [107] train time 0h 0m 10s |  loss |[1394.879]
Wed 09 Oct 2024 08:57:31 INFO epoch [108] train time 0h 0m 10s |  loss |[1392.274]
Wed 09 Oct 2024 08:57:42 INFO epoch [109] train time 0h 0m 10s |  loss |[1394.185]
Wed 09 Oct 2024 08:57:53 INFO epoch [110] train time 0h 0m 10s |  loss |[1393.278]
Wed 09 Oct 2024 08:59:10 INFO ---------- valid total [245] | valid precision [0.318] | valid recall [0.356] | valid f0.5 [0.320] | valid time 0h 1m 17s
Wed 09 Oct 2024 09:00:27 INFO ---------- test total [246] | test precision [0.344] | test recall [0.371] | test f0.5 [0.342] | test time 0h 1m 16s
Wed 09 Oct 2024 09:00:38 INFO epoch [111] train time 0h 0m 10s |  loss |[1394.767]
Wed 09 Oct 2024 09:00:49 INFO epoch [112] train time 0h 0m 10s |  loss |[1384.173]
Wed 09 Oct 2024 09:01:00 INFO epoch [113] train time 0h 0m 10s |  loss |[1390.022]
Wed 09 Oct 2024 09:01:11 INFO epoch [114] train time 0h 0m 11s |  loss |[1385.082]
Wed 09 Oct 2024 09:01:22 INFO epoch [115] train time 0h 0m 11s |  loss |[1387.824]
Wed 09 Oct 2024 09:01:33 INFO epoch [116] train time 0h 0m 11s |  loss |[1384.377]
Wed 09 Oct 2024 09:01:45 INFO epoch [117] train time 0h 0m 11s |  loss |[1386.932]
Wed 09 Oct 2024 09:01:56 INFO epoch [118] train time 0h 0m 11s |  loss |[1380.707]
Wed 09 Oct 2024 09:02:07 INFO epoch [119] train time 0h 0m 10s |  loss |[1381.837]
Wed 09 Oct 2024 09:02:18 INFO epoch [120] train time 0h 0m 10s |  loss |[1379.167]
Wed 09 Oct 2024 09:03:35 INFO ---------- valid total [245] | valid precision [0.325] | valid recall [0.359] | valid f0.5 [0.326] | valid time 0h 1m 17s
Wed 09 Oct 2024 09:04:52 INFO ---------- test total [246] | test precision [0.348] | test recall [0.374] | test f0.5 [0.346] | test time 0h 1m 17s
Wed 09 Oct 2024 09:05:05 INFO epoch [121] train time 0h 0m 10s |  loss |[1379.087]
Wed 09 Oct 2024 09:05:16 INFO epoch [122] train time 0h 0m 10s |  loss |[1378.076]
Wed 09 Oct 2024 09:05:27 INFO epoch [123] train time 0h 0m 10s |  loss |[1378.429]
Wed 09 Oct 2024 09:05:38 INFO epoch [124] train time 0h 0m 10s |  loss |[1373.601]
Wed 09 Oct 2024 09:05:49 INFO epoch [125] train time 0h 0m 10s |  loss |[1376.623]
Wed 09 Oct 2024 09:05:56 INFO | supervised_trainer |NOTE: overflow detected, setting loss scale to: 1.0
Wed 09 Oct 2024 09:06:00 INFO epoch [126] train time 0h 0m 11s |  loss |[1375.565]
Wed 09 Oct 2024 09:06:11 INFO epoch [127] train time 0h 0m 11s |  loss |[1372.511]
Wed 09 Oct 2024 09:06:23 INFO epoch [128] train time 0h 0m 11s |  loss |[1371.291]
Wed 09 Oct 2024 09:06:34 INFO epoch [129] train time 0h 0m 11s |  loss |[1373.992]
Wed 09 Oct 2024 09:06:45 INFO epoch [130] train time 0h 0m 11s |  loss |[1374.820]
Wed 09 Oct 2024 09:08:01 INFO ---------- valid total [245] | valid precision [0.319] | valid recall [0.352] | valid f0.5 [0.320] | valid time 0h 1m 16s
Wed 09 Oct 2024 09:09:17 INFO ---------- test total [246] | test precision [0.349] | test recall [0.377] | test f0.5 [0.351] | test time 0h 1m 15s
Wed 09 Oct 2024 09:09:28 INFO epoch [131] train time 0h 0m 11s |  loss |[1365.061]
Wed 09 Oct 2024 09:09:39 INFO epoch [132] train time 0h 0m 11s |  loss |[1371.929]
Wed 09 Oct 2024 09:09:50 INFO epoch [133] train time 0h 0m 11s |  loss |[1370.592]
Wed 09 Oct 2024 09:10:01 INFO epoch [134] train time 0h 0m 11s |  loss |[1364.477]
Wed 09 Oct 2024 09:10:13 INFO epoch [135] train time 0h 0m 11s |  loss |[1366.088]
Wed 09 Oct 2024 09:10:24 INFO epoch [136] train time 0h 0m 11s |  loss |[1364.605]
Wed 09 Oct 2024 09:10:35 INFO epoch [137] train time 0h 0m 11s |  loss |[1367.462]
Wed 09 Oct 2024 09:10:46 INFO epoch [138] train time 0h 0m 11s |  loss |[1361.357]
Wed 09 Oct 2024 09:10:57 INFO epoch [139] train time 0h 0m 11s |  loss |[1361.402]
Wed 09 Oct 2024 09:11:08 INFO epoch [140] train time 0h 0m 11s |  loss |[1358.656]
Wed 09 Oct 2024 09:12:25 INFO ---------- valid total [245] | valid precision [0.320] | valid recall [0.348] | valid f0.5 [0.320] | valid time 0h 1m 16s
Wed 09 Oct 2024 09:13:42 INFO ---------- test total [246] | test precision [0.341] | test recall [0.369] | test f0.5 [0.343] | test time 0h 1m 16s
Wed 09 Oct 2024 09:13:53 INFO epoch [141] train time 0h 0m 11s |  loss |[1361.943]
Wed 09 Oct 2024 09:14:04 INFO epoch [142] train time 0h 0m 11s |  loss |[1362.728]
Wed 09 Oct 2024 09:14:15 INFO epoch [143] train time 0h 0m 11s |  loss |[1356.041]
Wed 09 Oct 2024 09:14:26 INFO epoch [144] train time 0h 0m 11s |  loss |[1354.830]
Wed 09 Oct 2024 09:14:37 INFO epoch [145] train time 0h 0m 11s |  loss |[1354.934]
Wed 09 Oct 2024 09:14:48 INFO epoch [146] train time 0h 0m 11s |  loss |[1354.249]
Wed 09 Oct 2024 09:14:59 INFO epoch [147] train time 0h 0m 11s |  loss |[1351.534]
Wed 09 Oct 2024 09:15:10 INFO epoch [148] train time 0h 0m 11s |  loss |[1356.543]
Wed 09 Oct 2024 09:15:22 INFO epoch [149] train time 0h 0m 11s |  loss |[1353.959]
Wed 09 Oct 2024 09:15:33 INFO epoch [150] train time 0h 0m 11s |  loss |[1350.035]
Wed 09 Oct 2024 09:16:50 INFO ---------- valid total [245] | valid precision [0.317] | valid recall [0.350] | valid f0.5 [0.318] | valid time 0h 1m 16s
Wed 09 Oct 2024 09:18:06 INFO ---------- test total [246] | test precision [0.353] | test recall [0.378] | test f0.5 [0.351] | test time 0h 1m 15s
Wed 09 Oct 2024 09:18:17 INFO epoch [151] train time 0h 0m 11s |  loss |[1350.429]
Wed 09 Oct 2024 09:18:28 INFO epoch [152] train time 0h 0m 11s |  loss |[1351.647]
Wed 09 Oct 2024 09:18:39 INFO epoch [153] train time 0h 0m 11s |  loss |[1346.702]
Wed 09 Oct 2024 09:18:50 INFO epoch [154] train time 0h 0m 11s |  loss |[1347.481]
Wed 09 Oct 2024 09:19:01 INFO epoch [155] train time 0h 0m 11s |  loss |[1343.748]
Wed 09 Oct 2024 09:19:12 INFO epoch [156] train time 0h 0m 11s |  loss |[1342.374]
Wed 09 Oct 2024 09:19:24 INFO epoch [157] train time 0h 0m 11s |  loss |[1349.564]
Wed 09 Oct 2024 09:19:35 INFO epoch [158] train time 0h 0m 11s |  loss |[1345.317]
Wed 09 Oct 2024 09:19:46 INFO epoch [159] train time 0h 0m 11s |  loss |[1349.511]
Wed 09 Oct 2024 09:19:57 INFO epoch [160] train time 0h 0m 11s |  loss |[1343.543]
Wed 09 Oct 2024 09:21:14 INFO ---------- valid total [245] | valid precision [0.317] | valid recall [0.350] | valid f0.5 [0.318] | valid time 0h 1m 16s
Wed 09 Oct 2024 09:22:29 INFO ---------- test total [246] | test precision [0.349] | test recall [0.376] | test f0.5 [0.350] | test time 0h 1m 15s
Wed 09 Oct 2024 09:22:40 INFO epoch [161] train time 0h 0m 11s |  loss |[1340.852]
Wed 09 Oct 2024 09:22:52 INFO epoch [162] train time 0h 0m 11s |  loss |[1339.854]
Wed 09 Oct 2024 09:23:03 INFO epoch [163] train time 0h 0m 11s |  loss |[1346.622]
Wed 09 Oct 2024 09:23:14 INFO epoch [164] train time 0h 0m 11s |  loss |[1341.910]
Wed 09 Oct 2024 09:23:25 INFO epoch [165] train time 0h 0m 11s |  loss |[1339.483]
Wed 09 Oct 2024 09:23:36 INFO epoch [166] train time 0h 0m 11s |  loss |[1343.803]
Wed 09 Oct 2024 09:23:47 INFO epoch [167] train time 0h 0m 11s |  loss |[1340.907]
Wed 09 Oct 2024 09:23:58 INFO epoch [168] train time 0h 0m 11s |  loss |[1335.193]
Wed 09 Oct 2024 09:24:10 INFO epoch [169] train time 0h 0m 11s |  loss |[1338.307]
Wed 09 Oct 2024 09:24:21 INFO epoch [170] train time 0h 0m 11s |  loss |[1337.855]
Wed 09 Oct 2024 09:25:39 INFO ---------- valid total [245] | valid precision [0.322] | valid recall [0.353] | valid f0.5 [0.323] | valid time 0h 1m 18s
Wed 09 Oct 2024 09:26:57 INFO ---------- test total [246] | test precision [0.349] | test recall [0.376] | test f0.5 [0.347] | test time 0h 1m 17s
Wed 09 Oct 2024 09:27:08 INFO epoch [171] train time 0h 0m 11s |  loss |[1338.696]
Wed 09 Oct 2024 09:27:19 INFO epoch [172] train time 0h 0m 11s |  loss |[1330.597]
Wed 09 Oct 2024 09:27:30 INFO epoch [173] train time 0h 0m 11s |  loss |[1333.830]
Wed 09 Oct 2024 09:27:41 INFO epoch [174] train time 0h 0m 11s |  loss |[1336.511]
Wed 09 Oct 2024 09:27:52 INFO epoch [175] train time 0h 0m 11s |  loss |[1334.643]
Wed 09 Oct 2024 09:28:04 INFO epoch [176] train time 0h 0m 10s |  loss |[1329.903]
Wed 09 Oct 2024 09:28:15 INFO epoch [177] train time 0h 0m 10s |  loss |[1329.316]
Wed 09 Oct 2024 09:28:26 INFO epoch [178] train time 0h 0m 10s |  loss |[1333.168]
Wed 09 Oct 2024 09:28:37 INFO epoch [179] train time 0h 0m 11s |  loss |[1329.935]
Wed 09 Oct 2024 09:28:48 INFO epoch [180] train time 0h 0m 11s |  loss |[1330.637]
Wed 09 Oct 2024 09:30:05 INFO ---------- valid total [245] | valid precision [0.316] | valid recall [0.346] | valid f0.5 [0.317] | valid time 0h 1m 17s
Wed 09 Oct 2024 09:31:23 INFO ---------- test total [246] | test precision [0.355] | test recall [0.374] | test f0.5 [0.349] | test time 0h 1m 18s
Wed 09 Oct 2024 09:31:34 INFO epoch [181] train time 0h 0m 10s |  loss |[1332.961]
Wed 09 Oct 2024 09:31:45 INFO epoch [182] train time 0h 0m 10s |  loss |[1323.882]
Wed 09 Oct 2024 09:31:56 INFO epoch [183] train time 0h 0m 11s |  loss |[1325.714]
Wed 09 Oct 2024 09:32:07 INFO epoch [184] train time 0h 0m 10s |  loss |[1325.583]
Wed 09 Oct 2024 09:32:19 INFO epoch [185] train time 0h 0m 11s |  loss |[1325.072]
Wed 09 Oct 2024 09:32:30 INFO epoch [186] train time 0h 0m 10s |  loss |[1324.235]
Wed 09 Oct 2024 09:32:41 INFO epoch [187] train time 0h 0m 10s |  loss |[1325.401]
Wed 09 Oct 2024 09:32:52 INFO epoch [188] train time 0h 0m 10s |  loss |[1331.217]
Wed 09 Oct 2024 09:33:03 INFO epoch [189] train time 0h 0m 11s |  loss |[1329.260]
Wed 09 Oct 2024 09:33:14 INFO epoch [190] train time 0h 0m 11s |  loss |[1320.211]
Wed 09 Oct 2024 09:34:30 INFO ---------- valid total [245] | valid precision [0.311] | valid recall [0.343] | valid f0.5 [0.312] | valid time 0h 1m 16s
Wed 09 Oct 2024 09:35:46 INFO ---------- test total [246] | test precision [0.363] | test recall [0.378] | test f0.5 [0.355] | test time 0h 1m 16s
Wed 09 Oct 2024 09:35:57 INFO epoch [191] train time 0h 0m 10s |  loss |[1324.412]
Wed 09 Oct 2024 09:36:08 INFO epoch [192] train time 0h 0m 10s |  loss |[1323.340]
Wed 09 Oct 2024 09:36:19 INFO epoch [193] train time 0h 0m 10s |  loss |[1327.573]
Wed 09 Oct 2024 09:36:30 INFO epoch [194] train time 0h 0m 10s |  loss |[1325.911]
Wed 09 Oct 2024 09:36:41 INFO epoch [195] train time 0h 0m 10s |  loss |[1325.175]
Wed 09 Oct 2024 09:36:52 INFO epoch [196] train time 0h 0m 10s |  loss |[1320.629]
Wed 09 Oct 2024 09:38:09 INFO ---------- valid total [245] | valid precision [0.314] | valid recall [0.344] | valid f0.5 [0.315] | valid time 0h 1m 16s
Wed 09 Oct 2024 09:39:25 INFO ---------- test total [246] | test precision [0.360] | test recall [0.388] | test f0.5 [0.358] | test time 0h 1m 15s
Wed 09 Oct 2024 09:39:36 INFO epoch [197] train time 0h 0m 10s |  loss |[1317.655]
Wed 09 Oct 2024 09:40:52 INFO ---------- valid total [245] | valid precision [0.314] | valid recall [0.343] | valid f0.5 [0.314] | valid time 0h 1m 16s
Wed 09 Oct 2024 09:42:07 INFO ---------- test total [246] | test precision [0.355] | test recall [0.379] | test f0.5 [0.353] | test time 0h 1m 15s
Wed 09 Oct 2024 09:42:18 INFO epoch [198] train time 0h 0m 10s |  loss |[1320.110]
Wed 09 Oct 2024 09:43:35 INFO ---------- valid total [245] | valid precision [0.320] | valid recall [0.352] | valid f0.5 [0.321] | valid time 0h 1m 16s
Wed 09 Oct 2024 09:44:50 INFO ---------- test total [246] | test precision [0.355] | test recall [0.379] | test f0.5 [0.353] | test time 0h 1m 15s
Wed 09 Oct 2024 09:45:01 INFO epoch [199] train time 0h 0m 10s |  loss |[1318.622]
Wed 09 Oct 2024 09:46:18 INFO ---------- valid total [245] | valid precision [0.312] | valid recall [0.341] | valid f0.5 [0.313] | valid time 0h 1m 16s
Wed 09 Oct 2024 09:47:33 INFO ---------- test total [246] | test precision [0.351] | test recall [0.371] | test f0.5 [0.347] | test time 0h 1m 15s
Wed 09 Oct 2024 09:47:44 INFO epoch [200] train time 0h 0m 10s |  loss |[1321.530]
Wed 09 Oct 2024 09:49:00 INFO ---------- valid total [245] | valid precision [0.315] | valid recall [0.342] | valid f0.5 [0.315] | valid time 0h 1m 16s
Wed 09 Oct 2024 09:50:16 INFO ---------- test total [246] | test precision [0.360] | test recall [0.379] | test f0.5 [0.354] | test time 0h 1m 16s
Wed 09 Oct 2024 09:50:16 INFO training finished.
                            best valid result: precision [0.325] | recall [0.359] | F0.5 [0.326]
                            best test result : precision [0.348] | recall [0.374] | F0.5 [0.346]
Fri 11 Oct 2024 08:24:18 INFO random_seed=2024
use_gpu=True
learning_rate=6e-06
train_batch_size=32
test_batch_size=1
epoch_nums=100
test_step=10
display_train_step=1
gpu_id=5
training_resume=False
load_best_config=False
supervising_mode=fully_supervised
validset_divide=True
test_only=False
shuffle=True
model_config_file=gectoolkit/properties/model/SynGEC.json
best_config_file=gectoolkit/properties/best_config/SynGEC_Visual_YOLO_CLIP.json
dataset_config_file=gectoolkit/properties/dataset/Visual_YOLO_CLIP.json
dataset_dir=dataset/Visual_YOLO_CLIP
checkpoint_file=checkpoint/SynGEC-Visual_YOLO_CLIP.pth
log_file=log/SynGEC-Visual_YOLO_CLIP.log
output_dir=result/SynGEC-Visual_YOLO_CLIP
checkpoint_dir=checkpoint/SynGEC-Visual_YOLO_CLIP
min_word_keep=5
min_generate_keep=5
language=zh
fp16_init_scale=128
distributed_port=-1
decoder_embed_path=None
quant_noise_pq_block_size=8
best_checkpoint_metric=loss
cross_self_attention=False
validate_interval=1
tie_adaptive_weights=False
bpe=None
decoder_normalize_before=False
cpu=False
optimizer_overrides={}
quant_noise_pq=0
lr_scheduler=polynomial_decay
no_save_optimizer_state=False
train_subset=train
no_cross_attention=False
distributed_world_size=1
decoder_layerdrop=0
skip_invalid_size_inputs_valid_test=True
lr=[0.0005]
slowmo_momentum=None
log_interval=100
user_dir=./gectoolkit/model/SynGEC/src/src_syngec/syngec_model
min_loss_scale=0.0001
dual_aggregation_freeze=True
decoder_output_dim=1024
curriculum=0
scoring=bleu
optimizer=adam
adam_betas=(0.9,0.999)
share_decoder_input_output_embed=True
fp16_no_flatten_grads=False
distributed_backend=nccl
adaptive_input=False
dpd_suffix=['dpd']
attention_dropout=0.0
fp16=True
pipeline_checkpoint=never
fix_batches_to_gpus=False
fp16_scale_tolerance=0.0
valid_subset=valid
gen_subset=test
no_last_checkpoints=False
decoder_attention_heads=16
distributed_wrapper=DDP
activation_dropout=0.0
log_format=tqdm
decoder_embed_dim=1024
dual_aggregation_beta=0.5
disable_validation=False
quant_noise_scalar=0
use_bmuf=False
gat_encoder_layers=3
arch=syntax_enhanced_bart_large
eval_bleu_print_samples=False
no_scale_embedding=True
zero_sharding=none
pipeline_decoder_devices=None
save_interval_updates=0
localsgd_frequency=3
ignore_prefix_size=0
eval_bleu_args=None
encoder_layerdrop=0
syntax_type=['dep']
distributed_no_spawn=False
left_pad_source=True
decoder_layers=12
adaptive_softmax_cutoff=None
upsample_primary=1
ddp_backend=c10d
validate_after_updates=0
power=1.0
data_buffer_size=10
memory_efficient_bf16=False
num_batch_buckets=0
share_all_embeddings=True
alpha=1.0
gated_sum=False
distributed_init_method=None
report_accuracy=False
end_learning_rate=0.0
batch_size_valid=None
pipeline_devices=None
left_pad_target=False
source_word_dropout_probs=False
bf16=False
swm_suffix=swm
encoder_embed_dim=1024
force_anneal=None
no_epoch_checkpoints=False
syntax_encoder=GCN
encoder_ffn_embed_dim=4096
label_smoothing=0.1
num_shards=1
find_unused_parameters=True
no_progress_bar=False
load_alignments=False
use_old_adam=False
eval_bleu_detok_args=None
tensorboard_logdir=None
slowmo_algorithm=LocalSGD
fast_stat_sync=False
layernorm_embedding=True
encoder_layers_to_keep=None
eval_bleu_remove_bpe=None
scale_syntax_encoder_lr=None
eval_bleu=False
fp16_scale_window=None
pipeline_encoder_balance=None
pipeline_encoder_devices=None
relu_dropout=0.0
threshold_loss_scale=None
activation_fn=gelu
task=syntax-enhanced-translation
target_lang=tgt
bart_model_file_from_transformers=None
all_gather_list_size=16384
stop_time_hours=0
validate_interval_updates=0
save_interval=1
conll_suffix=['conll']
empty_cache_freq=0
encoder_learned_pos=True
tpu=False
nprocs_per_node=1
keep_last_epochs=10
device_id=0
source_lang_with_nt=src_nt
use_dpd=False
pipeline_chunks=0
cross_syntax_fuse=False
keep_interval_updates=-1
encoder_embed_path=None
adam_eps=1e-08
model_parallel_size=1
sentence_avg=False
encoder_layers=12
decoder_ffn_embed_dim=4096
dataset_impl=None
criterion=label_smoothed_cross_entropy
fixed_validation_seed=None
profile=False
distributed_rank=0
source_lang=src
eval_tokenized_bleu=False
source_word_dropout=0.2
adaptive_softmax_dropout=0
syntax_model_file=None
checkpoint_suffix=
required_seq_len_multiple=1
no_save=False
use_syntax=True
probs_suffix=['probs']
decoder_learned_pos=True
decoder_input_dim=1024
memory_efficient_fp16=False
decoder_layers_to_keep=None
gat_attention_heads=4
bucket_cap_mb=25
checkpoint_shard_count=1
pipeline_model_parallel=False
encoder_normalize_before=False
keep_best_checkpoints=-1
no_token_positional_embeddings=False
pooler_activation_fn=tanh
shard_id=0
only_dsa=False
max_update=0
encoder_attention_heads=16
freeze_bart_parameters=True
tokenizer=None
total_num_update=1000000
pipeline_decoder_balance=None
quantization_config_path=None
broadcast_buffers=False
batch_size=None
maximize_best_checkpoint_metric=False
pooler_dropout=0.0
warmup_updates=2000
min_lr=-1.0
only_gnn=True
eval_bleu_detok=space
no_seed_provided=False
truncate_source=False
pipeline_balance=None
model=SynGEC
dataset=Visual_YOLO_CLIP
augment=none
method=YOLO_CLIP
correctionmodel=SynGEC
device=cuda
map_location=cuda
gpu_nums=1


Fri 11 Oct 2024 08:24:18 INFO [src] dictionary: 21132 types
Fri 11 Oct 2024 08:24:18 INFO [tgt] dictionary: 21132 types
Fri 11 Oct 2024 08:24:18 INFO [syntax label0] dictionary: 51 types
Fri 11 Oct 2024 08:24:18 INFO [src] dictionary: 21132 types
Fri 11 Oct 2024 08:24:18 INFO [tgt] dictionary: 21132 types
Fri 11 Oct 2024 08:24:18 INFO [syntax label0] dictionary: 51 types
Fri 11 Oct 2024 08:24:18 INFO loaded 245 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_YOLO_CLIP_with_syntax_bart/bin/valid.src-tgt.src
Fri 11 Oct 2024 08:24:18 INFO loaded 245 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_YOLO_CLIP_with_syntax_bart/bin/valid.src-tgt.tgt
Fri 11 Oct 2024 08:24:18 INFO ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_YOLO_CLIP_with_syntax_bart/bin valid src-tgt 245 examples
Fri 11 Oct 2024 08:24:18 INFO loaded 245 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_YOLO_CLIP_with_syntax_bart/bin/valid.conll.src-tgt.src
Fri 11 Oct 2024 08:24:18 INFO loaded 245 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_YOLO_CLIP_with_syntax_bart/bin/valid.dpd.src-tgt.src
Fri 11 Oct 2024 08:24:18 INFO loaded 245 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_YOLO_CLIP_with_syntax_bart/bin/valid.probs.src-tgt.src
Fri 11 Oct 2024 08:24:18 INFO success! syntax types: 1, source conll lines: 245
Fri 11 Oct 2024 08:24:18 INFO loaded 1960 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_YOLO_CLIP_with_syntax_bart/bin/train.src-tgt.src
Fri 11 Oct 2024 08:24:18 INFO loaded 1960 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_YOLO_CLIP_with_syntax_bart/bin/train.src-tgt.tgt
Fri 11 Oct 2024 08:24:18 INFO ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_YOLO_CLIP_with_syntax_bart/bin train src-tgt 1960 examples
Fri 11 Oct 2024 08:24:18 INFO loaded 1960 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_YOLO_CLIP_with_syntax_bart/bin/train.conll.src-tgt.src
Fri 11 Oct 2024 08:24:18 INFO loaded 1960 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_YOLO_CLIP_with_syntax_bart/bin/train.dpd.src-tgt.src
Fri 11 Oct 2024 08:24:18 INFO loaded 1960 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_YOLO_CLIP_with_syntax_bart/bin/train.probs.src-tgt.src
Fri 11 Oct 2024 08:24:18 INFO success! syntax types: 1, source conll lines: 1960
Fri 11 Oct 2024 08:24:18 INFO loaded 246 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_YOLO_CLIP_test_with_syntax_bart/bin/test.conll.src-tgt.src
Fri 11 Oct 2024 08:24:18 INFO loaded 246 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_YOLO_CLIP_test_with_syntax_bart/bin/test.dpd.src-tgt.src
Fri 11 Oct 2024 08:24:18 INFO loaded 246 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_YOLO_CLIP_test_with_syntax_bart/bin/test.probs.src-tgt.src
Fri 11 Oct 2024 08:24:18 INFO success! syntax types: 1, source conll lines: 246
Fri 11 Oct 2024 08:24:28 INFO detected shared parameter: encoder.sentence_encoder.embed_tokens.weight <- decoder.embed_tokens.weight
Fri 11 Oct 2024 08:24:28 INFO detected shared parameter: encoder.sentence_encoder.embed_tokens.weight <- decoder.output_projection.weight
Fri 11 Oct 2024 08:24:28 INFO ***********************CUDA enviroments for all 1 workers***********************
Fri 11 Oct 2024 08:24:28 INFO rank   0: capabilities =  8.0  ; total memory = 79.151 GB ; name = NVIDIA A800 80GB PCIe                   
Fri 11 Oct 2024 08:24:28 INFO ***********************CUDA enviroments for all 1 workers***********************
Fri 11 Oct 2024 08:24:34 INFO loaded checkpoint ./gectoolkit/properties/model/SynGEC/preprocess/gopar/chinese_Visual_YOLO_CLIP_bart_baseline/checkpoint_best.pt (epoch 16 @ 1042 updates)
Fri 11 Oct 2024 08:24:34 INFO loading train data for epoch 16
Fri 11 Oct 2024 08:24:34 INFO loaded 1960 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_YOLO_CLIP_with_syntax_bart/bin/train.src-tgt.src
Fri 11 Oct 2024 08:24:34 INFO loaded 1960 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_YOLO_CLIP_with_syntax_bart/bin/train.src-tgt.tgt
Fri 11 Oct 2024 08:24:34 INFO ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_YOLO_CLIP_with_syntax_bart/bin train src-tgt 1960 examples
Fri 11 Oct 2024 08:24:34 INFO loaded 1960 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_YOLO_CLIP_with_syntax_bart/bin/train.conll.src-tgt.src
Fri 11 Oct 2024 08:24:34 INFO loaded 1960 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_YOLO_CLIP_with_syntax_bart/bin/train.dpd.src-tgt.src
Fri 11 Oct 2024 08:24:34 INFO loaded 1960 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_YOLO_CLIP_with_syntax_bart/bin/train.probs.src-tgt.src
Fri 11 Oct 2024 08:24:34 INFO success! syntax types: 1, source conll lines: 1960
Fri 11 Oct 2024 08:24:35 INFO SynGEC(
  (model): SyntaxEnhancedBARTModel(
    (encoder): SyntaxEnhancedTransformerEncoder(
      (sentence_encoder): SyntaxEnhancedSentenceTransformerEncoder(
        (dropout_module): FairseqDropout()
        (embed_tokens): Embedding(21132, 1024, padding_idx=1)
        (embed_positions): LearnedPositionalEmbedding(514, 1024, padding_idx=1)
        (layernorm_embedding): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        (layers): ModuleList(
          (0-11): 12 x DSATransformerEncoderLayer(
            (self_attn): DSAMultiheadAttention(
              (dropout_module): FairseqDropout()
              (k_proj): Linear(in_features=1024, out_features=1024, bias=True)
              (v_proj): Linear(in_features=1024, out_features=1024, bias=True)
              (q_proj): Linear(in_features=1024, out_features=1024, bias=True)
              (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
            )
            (self_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
            (dropout_module): FairseqDropout()
            (activation_dropout_module): FairseqDropout()
            (fc1): Linear(in_features=1024, out_features=4096, bias=True)
            (fc2): Linear(in_features=4096, out_features=1024, bias=True)
            (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
      )
      (syntax_encoder): SyntaxEnhancedSyntaxGuidedTransformerEncoder(
        (dropout_module): FairseqDropout()
        (embed_tokens): Embedding(51, 1024, padding_idx=0)
        (layers): ModuleList(
          (0-2): 3 x GCNSyntaxGuidedTransformerEncoderLayer(
            (gcn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
            (dropout_module): FairseqDropout()
            (activation_dropout_module): FairseqDropout()
            (W_out): Linear(in_features=2048, out_features=1024, bias=True)
            (W_in): Linear(in_features=2048, out_features=1024, bias=True)
            (fc): Linear(in_features=1024, out_features=1024, bias=True)
            (fc1): Linear(in_features=1024, out_features=4096, bias=True)
            (fc2): Linear(in_features=4096, out_features=1024, bias=True)
            (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
      )
    )
    (decoder): SyntaxEnhancedTransformerDecoder(
      (dropout_module): FairseqDropout()
      (embed_tokens): Embedding(21132, 1024, padding_idx=1)
      (embed_positions): LearnedPositionalEmbedding(514, 1024, padding_idx=1)
      (layernorm_embedding): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      (layers): ModuleList(
        (0-11): 12 x TransformerDecoderLayer(
          (dropout_module): FairseqDropout()
          (self_attn): MultiheadAttention(
            (dropout_module): FairseqDropout()
            (k_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (v_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (q_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
          )
          (activation_dropout_module): FairseqDropout()
          (self_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          (encoder_attn): MultiheadAttention(
            (dropout_module): FairseqDropout()
            (k_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (v_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (q_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
          )
          (encoder_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          (fc1): Linear(in_features=1024, out_features=4096, bias=True)
          (fc2): Linear(in_features=4096, out_features=1024, bias=True)
          (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        )
      )
      (output_projection): Linear(in_features=1024, out_features=21132, bias=False)
    )
    (classification_heads): ModuleDict()
  )
  (criterion): LabelSmoothedCrossEntropyCriterion()
)
Fri 11 Oct 2024 08:24:35 INFO train_batch_nums: 62
Fri 11 Oct 2024 08:24:35 INFO start training...
Fri 11 Oct 2024 08:24:36 INFO | supervised_trainer |NOTE: overflow detected, setting loss scale to: 64.0
Fri 11 Oct 2024 08:24:37 INFO | supervised_trainer |NOTE: overflow detected, setting loss scale to: 32.0
Fri 11 Oct 2024 08:24:38 INFO | supervised_trainer |NOTE: overflow detected, setting loss scale to: 16.0
Fri 11 Oct 2024 08:24:38 INFO | supervised_trainer |NOTE: overflow detected, setting loss scale to: 8.0
Fri 11 Oct 2024 08:24:40 INFO | supervised_trainer |NOTE: overflow detected, setting loss scale to: 4.0
Fri 11 Oct 2024 08:24:48 INFO epoch [  1] train time 0h 0m 12s |  loss |[6059.933]
Fri 11 Oct 2024 08:24:59 INFO epoch [  2] train time 0h 0m 11s |  loss |[5348.558]
Fri 11 Oct 2024 08:25:04 INFO | supervised_trainer |NOTE: overflow detected, setting loss scale to: 2.0
Fri 11 Oct 2024 08:25:10 INFO epoch [  3] train time 0h 0m 11s |  loss |[4768.358]
Fri 11 Oct 2024 08:25:21 INFO epoch [  4] train time 0h 0m 11s |  loss |[2987.129]
Fri 11 Oct 2024 08:25:33 INFO epoch [  5] train time 0h 0m 11s |  loss |[2240.299]
Fri 11 Oct 2024 08:25:44 INFO epoch [  6] train time 0h 0m 11s |  loss |[2000.724]
Fri 11 Oct 2024 08:25:56 INFO epoch [  7] train time 0h 0m 11s |  loss |[1911.941]
Fri 11 Oct 2024 08:26:07 INFO epoch [  8] train time 0h 0m 11s |  loss |[1840.507]
Fri 11 Oct 2024 08:26:18 INFO epoch [  9] train time 0h 0m 11s |  loss |[1793.910]
Fri 11 Oct 2024 08:26:30 INFO epoch [ 10] train time 0h 0m 11s |  loss |[1760.312]
Fri 11 Oct 2024 08:28:01 INFO ---------- valid total [245] | valid precision [0.284] | valid recall [0.325] | valid f0.5 [0.286] | valid time 0h 1m 31s
Fri 11 Oct 2024 08:29:34 INFO ---------- test total [246] | test precision [0.326] | test recall [0.353] | test f0.5 [0.324] | test time 0h 1m 33s
Fri 11 Oct 2024 08:29:48 INFO epoch [ 11] train time 0h 0m 11s |  loss |[1730.548]
Fri 11 Oct 2024 08:29:59 INFO epoch [ 12] train time 0h 0m 11s |  loss |[1700.797]
Fri 11 Oct 2024 08:30:10 INFO epoch [ 13] train time 0h 0m 11s |  loss |[1681.864]
Fri 11 Oct 2024 08:30:22 INFO epoch [ 14] train time 0h 0m 11s |  loss |[1674.196]
Fri 11 Oct 2024 08:30:33 INFO epoch [ 15] train time 0h 0m 11s |  loss |[1667.631]
Fri 11 Oct 2024 08:30:44 INFO epoch [ 16] train time 0h 0m 11s |  loss |[1644.381]
Fri 11 Oct 2024 08:30:56 INFO epoch [ 17] train time 0h 0m 11s |  loss |[1634.406]
Fri 11 Oct 2024 08:31:07 INFO epoch [ 18] train time 0h 0m 11s |  loss |[1629.502]
Fri 11 Oct 2024 08:31:18 INFO epoch [ 19] train time 0h 0m 11s |  loss |[1626.460]
Fri 11 Oct 2024 08:31:29 INFO epoch [ 20] train time 0h 0m 11s |  loss |[1607.923]
Fri 11 Oct 2024 08:33:03 INFO ---------- valid total [245] | valid precision [0.294] | valid recall [0.331] | valid f0.5 [0.296] | valid time 0h 1m 33s
Fri 11 Oct 2024 08:34:37 INFO ---------- test total [246] | test precision [0.348] | test recall [0.373] | test f0.5 [0.342] | test time 0h 1m 33s
Fri 11 Oct 2024 08:34:50 INFO epoch [ 21] train time 0h 0m 11s |  loss |[1600.911]
Fri 11 Oct 2024 08:35:02 INFO epoch [ 22] train time 0h 0m 11s |  loss |[1593.845]
Fri 11 Oct 2024 08:35:13 INFO epoch [ 23] train time 0h 0m 11s |  loss |[1586.109]
Fri 11 Oct 2024 08:35:24 INFO epoch [ 24] train time 0h 0m 11s |  loss |[1577.537]
Fri 11 Oct 2024 08:35:35 INFO epoch [ 25] train time 0h 0m 11s |  loss |[1576.968]
Fri 11 Oct 2024 08:35:47 INFO epoch [ 26] train time 0h 0m 11s |  loss |[1575.158]
Fri 11 Oct 2024 08:35:58 INFO epoch [ 27] train time 0h 0m 11s |  loss |[1565.475]
Fri 11 Oct 2024 08:36:09 INFO epoch [ 28] train time 0h 0m 11s |  loss |[1558.501]
Fri 11 Oct 2024 08:36:21 INFO epoch [ 29] train time 0h 0m 11s |  loss |[1551.651]
Fri 11 Oct 2024 08:36:32 INFO epoch [ 30] train time 0h 0m 11s |  loss |[1550.361]
Fri 11 Oct 2024 08:38:06 INFO ---------- valid total [245] | valid precision [0.296] | valid recall [0.336] | valid f0.5 [0.299] | valid time 0h 1m 33s
Fri 11 Oct 2024 08:39:40 INFO ---------- test total [246] | test precision [0.335] | test recall [0.371] | test f0.5 [0.331] | test time 0h 1m 34s
Fri 11 Oct 2024 08:39:54 INFO epoch [ 31] train time 0h 0m 11s |  loss |[1545.235]
Fri 11 Oct 2024 08:40:05 INFO epoch [ 32] train time 0h 0m 11s |  loss |[1549.026]
Fri 11 Oct 2024 08:40:17 INFO epoch [ 33] train time 0h 0m 11s |  loss |[1539.546]
Fri 11 Oct 2024 08:40:28 INFO epoch [ 34] train time 0h 0m 11s |  loss |[1532.233]
Fri 11 Oct 2024 08:40:39 INFO epoch [ 35] train time 0h 0m 11s |  loss |[1531.710]
Fri 11 Oct 2024 08:40:51 INFO epoch [ 36] train time 0h 0m 11s |  loss |[1532.202]
Fri 11 Oct 2024 08:41:02 INFO epoch [ 37] train time 0h 0m 11s |  loss |[1523.959]
Fri 11 Oct 2024 08:41:13 INFO epoch [ 38] train time 0h 0m 11s |  loss |[1523.005]
Fri 11 Oct 2024 08:41:25 INFO epoch [ 39] train time 0h 0m 11s |  loss |[1516.011]
Fri 11 Oct 2024 08:41:36 INFO epoch [ 40] train time 0h 0m 11s |  loss |[1511.022]
Fri 11 Oct 2024 08:43:09 INFO ---------- valid total [245] | valid precision [0.307] | valid recall [0.347] | valid f0.5 [0.309] | valid time 0h 1m 32s
Fri 11 Oct 2024 08:44:42 INFO ---------- test total [246] | test precision [0.351] | test recall [0.378] | test f0.5 [0.346] | test time 0h 1m 32s
Fri 11 Oct 2024 08:44:56 INFO epoch [ 41] train time 0h 0m 11s |  loss |[1517.660]
Fri 11 Oct 2024 08:45:07 INFO epoch [ 42] train time 0h 0m 11s |  loss |[1511.894]
Fri 11 Oct 2024 08:45:18 INFO epoch [ 43] train time 0h 0m 11s |  loss |[1504.687]
Fri 11 Oct 2024 08:45:29 INFO epoch [ 44] train time 0h 0m 11s |  loss |[1506.716]
Fri 11 Oct 2024 08:45:41 INFO epoch [ 45] train time 0h 0m 11s |  loss |[1503.811]
Fri 11 Oct 2024 08:45:52 INFO epoch [ 46] train time 0h 0m 11s |  loss |[1495.482]
Fri 11 Oct 2024 08:46:03 INFO epoch [ 47] train time 0h 0m 11s |  loss |[1494.778]
Fri 11 Oct 2024 08:46:15 INFO epoch [ 48] train time 0h 0m 11s |  loss |[1491.446]
Fri 11 Oct 2024 08:46:26 INFO epoch [ 49] train time 0h 0m 11s |  loss |[1488.608]
Fri 11 Oct 2024 08:46:37 INFO epoch [ 50] train time 0h 0m 11s |  loss |[1497.735]
Fri 11 Oct 2024 08:48:13 INFO ---------- valid total [245] | valid precision [0.307] | valid recall [0.348] | valid f0.5 [0.310] | valid time 0h 1m 35s
Fri 11 Oct 2024 08:49:49 INFO ---------- test total [246] | test precision [0.357] | test recall [0.385] | test f0.5 [0.353] | test time 0h 1m 35s
Fri 11 Oct 2024 08:50:03 INFO epoch [ 51] train time 0h 0m 11s |  loss |[1483.131]
Fri 11 Oct 2024 08:50:14 INFO epoch [ 52] train time 0h 0m 11s |  loss |[1488.232]
Fri 11 Oct 2024 08:50:24 INFO | supervised_trainer |NOTE: overflow detected, setting loss scale to: 1.0
Fri 11 Oct 2024 08:50:26 INFO epoch [ 53] train time 0h 0m 11s |  loss |[1480.302]
Fri 11 Oct 2024 08:50:37 INFO epoch [ 54] train time 0h 0m 11s |  loss |[1480.092]
Fri 11 Oct 2024 08:50:49 INFO epoch [ 55] train time 0h 0m 11s |  loss |[1478.113]
Fri 11 Oct 2024 08:51:00 INFO epoch [ 56] train time 0h 0m 11s |  loss |[1472.453]
Fri 11 Oct 2024 08:51:12 INFO epoch [ 57] train time 0h 0m 11s |  loss |[1476.621]
Fri 11 Oct 2024 08:51:23 INFO epoch [ 58] train time 0h 0m 11s |  loss |[1469.961]
Fri 11 Oct 2024 08:51:34 INFO epoch [ 59] train time 0h 0m 11s |  loss |[1470.281]
Fri 11 Oct 2024 08:51:46 INFO epoch [ 60] train time 0h 0m 11s |  loss |[1462.233]
Fri 11 Oct 2024 08:53:21 INFO ---------- valid total [245] | valid precision [0.300] | valid recall [0.340] | valid f0.5 [0.303] | valid time 0h 1m 34s
Fri 11 Oct 2024 08:54:56 INFO ---------- test total [246] | test precision [0.335] | test recall [0.373] | test f0.5 [0.335] | test time 0h 1m 34s
Fri 11 Oct 2024 08:55:07 INFO epoch [ 61] train time 0h 0m 11s |  loss |[1465.694]
Fri 11 Oct 2024 08:55:18 INFO epoch [ 62] train time 0h 0m 11s |  loss |[1461.589]
Fri 11 Oct 2024 08:55:30 INFO epoch [ 63] train time 0h 0m 11s |  loss |[1457.543]
Fri 11 Oct 2024 08:55:41 INFO epoch [ 64] train time 0h 0m 11s |  loss |[1456.751]
Fri 11 Oct 2024 08:55:52 INFO epoch [ 65] train time 0h 0m 11s |  loss |[1462.077]
Fri 11 Oct 2024 08:56:04 INFO epoch [ 66] train time 0h 0m 11s |  loss |[1453.981]
Fri 11 Oct 2024 08:56:15 INFO epoch [ 67] train time 0h 0m 11s |  loss |[1456.239]
Fri 11 Oct 2024 08:56:27 INFO epoch [ 68] train time 0h 0m 11s |  loss |[1451.141]
Fri 11 Oct 2024 08:56:38 INFO epoch [ 69] train time 0h 0m 11s |  loss |[1454.580]
Fri 11 Oct 2024 08:56:50 INFO epoch [ 70] train time 0h 0m 11s |  loss |[1453.617]
Fri 11 Oct 2024 08:58:21 INFO ---------- valid total [245] | valid precision [0.308] | valid recall [0.347] | valid f0.5 [0.310] | valid time 0h 1m 31s
Fri 11 Oct 2024 08:59:43 INFO ---------- test total [246] | test precision [0.348] | test recall [0.378] | test f0.5 [0.344] | test time 0h 1m 21s
Fri 11 Oct 2024 08:59:55 INFO epoch [ 71] train time 0h 0m 11s |  loss |[1450.723]
Fri 11 Oct 2024 09:00:06 INFO epoch [ 72] train time 0h 0m 11s |  loss |[1448.027]
Fri 11 Oct 2024 09:00:17 INFO epoch [ 73] train time 0h 0m 11s |  loss |[1441.168]
Fri 11 Oct 2024 09:00:29 INFO epoch [ 74] train time 0h 0m 11s |  loss |[1443.122]
Fri 11 Oct 2024 09:00:40 INFO epoch [ 75] train time 0h 0m 11s |  loss |[1436.952]
Fri 11 Oct 2024 09:00:52 INFO epoch [ 76] train time 0h 0m 11s |  loss |[1440.801]
Fri 11 Oct 2024 09:01:03 INFO epoch [ 77] train time 0h 0m 11s |  loss |[1438.056]
Fri 11 Oct 2024 09:01:14 INFO epoch [ 78] train time 0h 0m 11s |  loss |[1438.554]
Fri 11 Oct 2024 09:01:26 INFO epoch [ 79] train time 0h 0m 11s |  loss |[1434.338]
Fri 11 Oct 2024 09:01:37 INFO epoch [ 80] train time 0h 0m 11s |  loss |[1432.939]
Fri 11 Oct 2024 09:02:58 INFO ---------- valid total [245] | valid precision [0.316] | valid recall [0.351] | valid f0.5 [0.317] | valid time 0h 1m 20s
Fri 11 Oct 2024 09:04:18 INFO ---------- test total [246] | test precision [0.341] | test recall [0.365] | test f0.5 [0.336] | test time 0h 1m 20s
Fri 11 Oct 2024 09:04:31 INFO epoch [ 81] train time 0h 0m 11s |  loss |[1434.878]
Fri 11 Oct 2024 09:04:42 INFO epoch [ 82] train time 0h 0m 11s |  loss |[1428.899]
Fri 11 Oct 2024 09:04:54 INFO epoch [ 83] train time 0h 0m 11s |  loss |[1428.112]
Fri 11 Oct 2024 09:05:05 INFO epoch [ 84] train time 0h 0m 11s |  loss |[1429.965]
Fri 11 Oct 2024 09:05:16 INFO epoch [ 85] train time 0h 0m 11s |  loss |[1423.259]
Fri 11 Oct 2024 09:05:28 INFO epoch [ 86] train time 0h 0m 11s |  loss |[1419.055]
Fri 11 Oct 2024 09:05:39 INFO epoch [ 87] train time 0h 0m 11s |  loss |[1421.132]
Fri 11 Oct 2024 09:05:50 INFO epoch [ 88] train time 0h 0m 11s |  loss |[1423.744]
Fri 11 Oct 2024 09:06:01 INFO epoch [ 89] train time 0h 0m 11s |  loss |[1420.769]
Fri 11 Oct 2024 09:06:12 INFO epoch [ 90] train time 0h 0m 11s |  loss |[1418.863]
Fri 11 Oct 2024 09:07:32 INFO ---------- valid total [245] | valid precision [0.322] | valid recall [0.355] | valid f0.5 [0.322] | valid time 0h 1m 19s
Fri 11 Oct 2024 09:08:51 INFO ---------- test total [246] | test precision [0.342] | test recall [0.370] | test f0.5 [0.341] | test time 0h 1m 19s
Fri 11 Oct 2024 09:09:04 INFO epoch [ 91] train time 0h 0m 11s |  loss |[1415.762]
Fri 11 Oct 2024 09:09:16 INFO epoch [ 92] train time 0h 0m 11s |  loss |[1419.304]
Fri 11 Oct 2024 09:09:27 INFO epoch [ 93] train time 0h 0m 11s |  loss |[1414.174]
Fri 11 Oct 2024 09:09:38 INFO epoch [ 94] train time 0h 0m 11s |  loss |[1409.193]
Fri 11 Oct 2024 09:09:49 INFO epoch [ 95] train time 0h 0m 11s |  loss |[1407.064]
Fri 11 Oct 2024 09:10:01 INFO epoch [ 96] train time 0h 0m 11s |  loss |[1409.990]
Fri 11 Oct 2024 09:11:22 INFO ---------- valid total [245] | valid precision [0.316] | valid recall [0.353] | valid f0.5 [0.318] | valid time 0h 1m 21s
Fri 11 Oct 2024 09:12:43 INFO ---------- test total [246] | test precision [0.340] | test recall [0.372] | test f0.5 [0.339] | test time 0h 1m 21s
Fri 11 Oct 2024 09:12:54 INFO epoch [ 97] train time 0h 0m 11s |  loss |[1411.124]
Fri 11 Oct 2024 09:14:15 INFO ---------- valid total [245] | valid precision [0.325] | valid recall [0.354] | valid f0.5 [0.325] | valid time 0h 1m 20s
Fri 11 Oct 2024 09:15:35 INFO ---------- test total [246] | test precision [0.341] | test recall [0.370] | test f0.5 [0.339] | test time 0h 1m 20s
Fri 11 Oct 2024 09:15:48 INFO epoch [ 98] train time 0h 0m 11s |  loss |[1402.168]
Fri 11 Oct 2024 09:17:07 INFO ---------- valid total [245] | valid precision [0.317] | valid recall [0.349] | valid f0.5 [0.318] | valid time 0h 1m 19s
Fri 11 Oct 2024 09:18:27 INFO ---------- test total [246] | test precision [0.344] | test recall [0.373] | test f0.5 [0.346] | test time 0h 1m 19s
Fri 11 Oct 2024 09:18:38 INFO epoch [ 99] train time 0h 0m 11s |  loss |[1404.571
Fri 11 Oct 2024 09:19:58 INFO ---------- valid total [245] | valid precision [0.315] | valid recall [0.351] | valid f0.5 [0.316] | valid time 0h 1m 19s
Fri 11 Oct 2024 09:21:19 INFO ---------- test total [246] | test precision [0.342] | test recall [0.367] | test f0.5 [0.340] | test time 0h 1m 20s
Fri 11 Oct 2024 09:21:30 INFO epoch [100] train time 0h 0m 11s |  loss |[1403.874]
Fri 11 Oct 2024 09:22:51 INFO ---------- valid total [245] | valid precision [0.320] | valid recall [0.355] | valid f0.5 [0.321] | valid time 0h 1m 21s
Fri 11 Oct 2024 09:24:11 INFO ---------- test total [246] | test precision [0.344] | test recall [0.377] | test f0.5 [0.346] | test time 0h 1m 20s
Fri 11 Oct 2024 09:24:11 INFO training finished.
                            best valid result: precision [0.325] | recall [0.354] | F0.5 [0.325]
                            best test result : precision [0.341] | recall [0.370] | F0.5 [0.339]
Fri 11 Oct 2024 10:27:08 INFO random_seed=2024
use_gpu=True
learning_rate=6e-06
train_batch_size=32
test_batch_size=1
epoch_nums=200
test_step=10
display_train_step=1
gpu_id=5
training_resume=False
load_best_config=False
supervising_mode=fully_supervised
validset_divide=True
test_only=False
shuffle=True
model_config_file=gectoolkit/properties/model/SynGEC.json
best_config_file=gectoolkit/properties/best_config/SynGEC_Visual_YOLO_CLIP.json
dataset_config_file=gectoolkit/properties/dataset/Visual_YOLO_CLIP.json
dataset_dir=dataset/Visual_YOLO_CLIP
checkpoint_file=checkpoint/SynGEC-Visual_YOLO_CLIP.pth
log_file=log/SynGEC-Visual_YOLO_CLIP.log
output_dir=result/SynGEC-Visual_YOLO_CLIP
checkpoint_dir=checkpoint/SynGEC-Visual_YOLO_CLIP
min_word_keep=5
min_generate_keep=5
language=zh
fp16_init_scale=128
distributed_port=-1
decoder_embed_path=None
quant_noise_pq_block_size=8
best_checkpoint_metric=loss
cross_self_attention=False
validate_interval=1
tie_adaptive_weights=False
bpe=None
decoder_normalize_before=False
cpu=False
optimizer_overrides={}
quant_noise_pq=0
lr_scheduler=polynomial_decay
no_save_optimizer_state=False
train_subset=train
no_cross_attention=False
distributed_world_size=1
decoder_layerdrop=0
skip_invalid_size_inputs_valid_test=True
lr=[0.0005]
slowmo_momentum=None
log_interval=100
user_dir=./gectoolkit/model/SynGEC/src/src_syngec/syngec_model
min_loss_scale=0.0001
dual_aggregation_freeze=True
decoder_output_dim=1024
curriculum=0
scoring=bleu
optimizer=adam
adam_betas=(0.9,0.999)
share_decoder_input_output_embed=True
fp16_no_flatten_grads=False
distributed_backend=nccl
adaptive_input=False
dpd_suffix=['dpd']
attention_dropout=0.0
fp16=True
pipeline_checkpoint=never
fix_batches_to_gpus=False
fp16_scale_tolerance=0.0
valid_subset=valid
gen_subset=test
no_last_checkpoints=False
decoder_attention_heads=16
distributed_wrapper=DDP
activation_dropout=0.0
log_format=tqdm
decoder_embed_dim=1024
dual_aggregation_beta=0.5
disable_validation=False
quant_noise_scalar=0
use_bmuf=False
gat_encoder_layers=3
arch=syntax_enhanced_bart_large
eval_bleu_print_samples=False
no_scale_embedding=True
zero_sharding=none
pipeline_decoder_devices=None
save_interval_updates=0
localsgd_frequency=3
ignore_prefix_size=0
eval_bleu_args=None
encoder_layerdrop=0
syntax_type=['dep']
distributed_no_spawn=False
left_pad_source=True
decoder_layers=12
adaptive_softmax_cutoff=None
upsample_primary=1
ddp_backend=c10d
validate_after_updates=0
power=1.0
data_buffer_size=10
memory_efficient_bf16=False
num_batch_buckets=0
share_all_embeddings=True
alpha=1.0
gated_sum=False
distributed_init_method=None
report_accuracy=False
end_learning_rate=0.0
batch_size_valid=None
pipeline_devices=None
left_pad_target=False
source_word_dropout_probs=False
bf16=False
swm_suffix=swm
encoder_embed_dim=1024
force_anneal=None
no_epoch_checkpoints=False
syntax_encoder=GCN
encoder_ffn_embed_dim=4096
label_smoothing=0.1
num_shards=1
find_unused_parameters=True
no_progress_bar=False
load_alignments=False
use_old_adam=False
eval_bleu_detok_args=None
tensorboard_logdir=None
slowmo_algorithm=LocalSGD
fast_stat_sync=False
layernorm_embedding=True
encoder_layers_to_keep=None
eval_bleu_remove_bpe=None
scale_syntax_encoder_lr=None
eval_bleu=False
fp16_scale_window=None
pipeline_encoder_balance=None
pipeline_encoder_devices=None
relu_dropout=0.0
threshold_loss_scale=None
activation_fn=gelu
task=syntax-enhanced-translation
target_lang=tgt
bart_model_file_from_transformers=None
all_gather_list_size=16384
stop_time_hours=0
validate_interval_updates=0
save_interval=1
conll_suffix=['conll']
empty_cache_freq=0
encoder_learned_pos=True
tpu=False
nprocs_per_node=1
keep_last_epochs=10
device_id=0
source_lang_with_nt=src_nt
use_dpd=False
pipeline_chunks=0
cross_syntax_fuse=False
keep_interval_updates=-1
encoder_embed_path=None
adam_eps=1e-08
model_parallel_size=1
sentence_avg=False
encoder_layers=12
decoder_ffn_embed_dim=4096
dataset_impl=None
criterion=label_smoothed_cross_entropy
fixed_validation_seed=None
profile=False
distributed_rank=0
source_lang=src
eval_tokenized_bleu=False
source_word_dropout=0.2
adaptive_softmax_dropout=0
syntax_model_file=None
checkpoint_suffix=
required_seq_len_multiple=1
no_save=False
use_syntax=True
probs_suffix=['probs']
decoder_learned_pos=True
decoder_input_dim=1024
memory_efficient_fp16=False
decoder_layers_to_keep=None
gat_attention_heads=4
bucket_cap_mb=25
checkpoint_shard_count=1
pipeline_model_parallel=False
encoder_normalize_before=False
keep_best_checkpoints=-1
no_token_positional_embeddings=False
pooler_activation_fn=tanh
shard_id=0
only_dsa=False
max_update=0
encoder_attention_heads=16
freeze_bart_parameters=True
tokenizer=None
total_num_update=1000000
pipeline_decoder_balance=None
quantization_config_path=None
broadcast_buffers=False
batch_size=None
maximize_best_checkpoint_metric=False
pooler_dropout=0.0
warmup_updates=2000
min_lr=-1.0
only_gnn=True
eval_bleu_detok=space
no_seed_provided=False
truncate_source=False
pipeline_balance=None
model=SynGEC
dataset=Visual_YOLO_CLIP
augment=none
method=YOLO_CLIP
correctionmodel=SynGEC
device=cuda
map_location=cuda
gpu_nums=1


Fri 11 Oct 2024 10:27:08 INFO [src] dictionary: 21132 types
Fri 11 Oct 2024 10:27:08 INFO [tgt] dictionary: 21132 types
Fri 11 Oct 2024 10:27:08 INFO [syntax label0] dictionary: 51 types
Fri 11 Oct 2024 10:27:08 INFO [src] dictionary: 21132 types
Fri 11 Oct 2024 10:27:08 INFO [tgt] dictionary: 21132 types
Fri 11 Oct 2024 10:27:08 INFO [syntax label0] dictionary: 51 types
Fri 11 Oct 2024 10:27:08 INFO loaded 245 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_YOLO_CLIP_with_syntax_bart/bin/valid.src-tgt.src
Fri 11 Oct 2024 10:27:08 INFO loaded 245 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_YOLO_CLIP_with_syntax_bart/bin/valid.src-tgt.tgt
Fri 11 Oct 2024 10:27:08 INFO ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_YOLO_CLIP_with_syntax_bart/bin valid src-tgt 245 examples
Fri 11 Oct 2024 10:27:08 INFO loaded 245 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_YOLO_CLIP_with_syntax_bart/bin/valid.conll.src-tgt.src
Fri 11 Oct 2024 10:27:08 INFO loaded 245 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_YOLO_CLIP_with_syntax_bart/bin/valid.dpd.src-tgt.src
Fri 11 Oct 2024 10:27:08 INFO loaded 245 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_YOLO_CLIP_with_syntax_bart/bin/valid.probs.src-tgt.src
Fri 11 Oct 2024 10:27:08 INFO success! syntax types: 1, source conll lines: 245
Fri 11 Oct 2024 10:27:08 INFO loaded 1960 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_YOLO_CLIP_with_syntax_bart/bin/train.src-tgt.src
Fri 11 Oct 2024 10:27:08 INFO loaded 1960 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_YOLO_CLIP_with_syntax_bart/bin/train.src-tgt.tgt
Fri 11 Oct 2024 10:27:08 INFO ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_YOLO_CLIP_with_syntax_bart/bin train src-tgt 1960 examples
Fri 11 Oct 2024 10:27:08 INFO loaded 1960 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_YOLO_CLIP_with_syntax_bart/bin/train.conll.src-tgt.src
Fri 11 Oct 2024 10:27:08 INFO loaded 1960 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_YOLO_CLIP_with_syntax_bart/bin/train.dpd.src-tgt.src
Fri 11 Oct 2024 10:27:08 INFO loaded 1960 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_YOLO_CLIP_with_syntax_bart/bin/train.probs.src-tgt.src
Fri 11 Oct 2024 10:27:08 INFO success! syntax types: 1, source conll lines: 1960
Fri 11 Oct 2024 10:27:08 INFO loaded 246 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_YOLO_CLIP_test_with_syntax_bart/bin/test.conll.src-tgt.src
Fri 11 Oct 2024 10:27:08 INFO loaded 246 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_YOLO_CLIP_test_with_syntax_bart/bin/test.dpd.src-tgt.src
Fri 11 Oct 2024 10:27:08 INFO loaded 246 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_YOLO_CLIP_test_with_syntax_bart/bin/test.probs.src-tgt.src
Fri 11 Oct 2024 10:27:08 INFO success! syntax types: 1, source conll lines: 246
Fri 11 Oct 2024 10:27:17 INFO detected shared parameter: encoder.sentence_encoder.embed_tokens.weight <- decoder.embed_tokens.weight
Fri 11 Oct 2024 10:27:17 INFO detected shared parameter: encoder.sentence_encoder.embed_tokens.weight <- decoder.output_projection.weight
Fri 11 Oct 2024 10:27:17 INFO ***********************CUDA enviroments for all 1 workers***********************
Fri 11 Oct 2024 10:27:17 INFO rank   0: capabilities =  8.0  ; total memory = 79.151 GB ; name = NVIDIA A800 80GB PCIe                   
Fri 11 Oct 2024 10:27:17 INFO ***********************CUDA enviroments for all 1 workers***********************
Fri 11 Oct 2024 10:27:22 INFO loaded checkpoint ./gectoolkit/properties/model/SynGEC/preprocess/gopar/chinese_Visual_YOLO_CLIP_bart_baseline/checkpoint_best.pt (epoch 16 @ 1042 updates)
Fri 11 Oct 2024 10:27:22 INFO loading train data for epoch 16
Fri 11 Oct 2024 10:27:22 INFO loaded 1960 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_YOLO_CLIP_with_syntax_bart/bin/train.src-tgt.src
Fri 11 Oct 2024 10:27:22 INFO loaded 1960 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_YOLO_CLIP_with_syntax_bart/bin/train.src-tgt.tgt
Fri 11 Oct 2024 10:27:22 INFO ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_YOLO_CLIP_with_syntax_bart/bin train src-tgt 1960 examples
Fri 11 Oct 2024 10:27:22 INFO loaded 1960 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_YOLO_CLIP_with_syntax_bart/bin/train.conll.src-tgt.src
Fri 11 Oct 2024 10:27:22 INFO loaded 1960 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_YOLO_CLIP_with_syntax_bart/bin/train.dpd.src-tgt.src
Fri 11 Oct 2024 10:27:22 INFO loaded 1960 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_YOLO_CLIP_with_syntax_bart/bin/train.probs.src-tgt.src
Fri 11 Oct 2024 10:27:22 INFO success! syntax types: 1, source conll lines: 1960
Fri 11 Oct 2024 10:27:23 INFO SynGEC(
  (model): SyntaxEnhancedBARTModel(
    (encoder): SyntaxEnhancedTransformerEncoder(
      (sentence_encoder): SyntaxEnhancedSentenceTransformerEncoder(
        (dropout_module): FairseqDropout()
        (embed_tokens): Embedding(21132, 1024, padding_idx=1)
        (embed_positions): LearnedPositionalEmbedding(514, 1024, padding_idx=1)
        (layernorm_embedding): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        (layers): ModuleList(
          (0-11): 12 x DSATransformerEncoderLayer(
            (self_attn): DSAMultiheadAttention(
              (dropout_module): FairseqDropout()
              (k_proj): Linear(in_features=1024, out_features=1024, bias=True)
              (v_proj): Linear(in_features=1024, out_features=1024, bias=True)
              (q_proj): Linear(in_features=1024, out_features=1024, bias=True)
              (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
            )
            (self_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
            (dropout_module): FairseqDropout()
            (activation_dropout_module): FairseqDropout()
            (fc1): Linear(in_features=1024, out_features=4096, bias=True)
            (fc2): Linear(in_features=4096, out_features=1024, bias=True)
            (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
      )
      (syntax_encoder): SyntaxEnhancedSyntaxGuidedTransformerEncoder(
        (dropout_module): FairseqDropout()
        (embed_tokens): Embedding(51, 1024, padding_idx=0)
        (layers): ModuleList(
          (0-2): 3 x GCNSyntaxGuidedTransformerEncoderLayer(
            (gcn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
            (dropout_module): FairseqDropout()
            (activation_dropout_module): FairseqDropout()
            (W_out): Linear(in_features=2048, out_features=1024, bias=True)
            (W_in): Linear(in_features=2048, out_features=1024, bias=True)
            (fc): Linear(in_features=1024, out_features=1024, bias=True)
            (fc1): Linear(in_features=1024, out_features=4096, bias=True)
            (fc2): Linear(in_features=4096, out_features=1024, bias=True)
            (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
      )
    )
    (decoder): SyntaxEnhancedTransformerDecoder(
      (dropout_module): FairseqDropout()
      (embed_tokens): Embedding(21132, 1024, padding_idx=1)
      (embed_positions): LearnedPositionalEmbedding(514, 1024, padding_idx=1)
      (layernorm_embedding): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      (layers): ModuleList(
        (0-11): 12 x TransformerDecoderLayer(
          (dropout_module): FairseqDropout()
          (self_attn): MultiheadAttention(
            (dropout_module): FairseqDropout()
            (k_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (v_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (q_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
          )
          (activation_dropout_module): FairseqDropout()
          (self_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          (encoder_attn): MultiheadAttention(
            (dropout_module): FairseqDropout()
            (k_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (v_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (q_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
          )
          (encoder_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          (fc1): Linear(in_features=1024, out_features=4096, bias=True)
          (fc2): Linear(in_features=4096, out_features=1024, bias=True)
          (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        )
      )
      (output_projection): Linear(in_features=1024, out_features=21132, bias=False)
    )
    (classification_heads): ModuleDict()
  )
  (criterion): LabelSmoothedCrossEntropyCriterion()
)
Fri 11 Oct 2024 10:27:23 INFO train_batch_nums: 62
Fri 11 Oct 2024 10:27:23 INFO start training...
Fri 11 Oct 2024 10:27:24 INFO | supervised_trainer |NOTE: overflow detected, setting loss scale to: 64.0
Fri 11 Oct 2024 10:27:26 INFO | supervised_trainer |NOTE: overflow detected, setting loss scale to: 32.0
Fri 11 Oct 2024 10:27:27 INFO | supervised_trainer |NOTE: overflow detected, setting loss scale to: 16.0
Fri 11 Oct 2024 10:27:35 INFO | supervised_trainer |NOTE: overflow detected, setting loss scale to: 8.0
Fri 11 Oct 2024 10:27:49 INFO epoch [  1] train time 0h 0m 25s |  loss |[5978.196]
Fri 11 Oct 2024 10:27:51 INFO | supervised_trainer |NOTE: overflow detected, setting loss scale to: 4.0
Fri 11 Oct 2024 10:28:14 INFO epoch [  2] train time 0h 0m 24s |  loss |[3998.305]
