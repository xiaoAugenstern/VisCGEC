Thu 03 Oct 2024 03:27:50 INFO random_seed=2024
use_gpu=True
learning_rate=6e-06
train_batch_size=32
test_batch_size=1
epoch_nums=200
test_step=20
display_train_step=1
gpu_id=5
training_resume=False
load_best_config=False
supervising_mode=fully_supervised
validset_divide=True
test_only=False
shuffle=True
model_config_file=gectoolkit/properties/model/SynGEC.json
best_config_file=gectoolkit/properties/best_config/SynGEC_Visual_OCR.json
dataset_config_file=gectoolkit/properties/dataset/Visual_OCR.json
dataset_dir=dataset/Visual_OCR
checkpoint_file=checkpoint/SynGEC-Visual_OCR.pth
log_file=log/SynGEC-Visual_OCR.log
output_dir=result/SynGEC-Visual_OCR
checkpoint_dir=checkpoint/SynGEC-Visual_OCR
min_word_keep=5
min_generate_keep=5
language=zh
fp16_init_scale=128
distributed_port=-1
decoder_embed_path=None
quant_noise_pq_block_size=8
best_checkpoint_metric=loss
cross_self_attention=False
validate_interval=1
tie_adaptive_weights=False
bpe=None
decoder_normalize_before=False
cpu=False
optimizer_overrides={}
quant_noise_pq=0
lr_scheduler=polynomial_decay
no_save_optimizer_state=False
train_subset=train
no_cross_attention=False
distributed_world_size=1
decoder_layerdrop=0
skip_invalid_size_inputs_valid_test=True
lr=[0.0005]
slowmo_momentum=None
log_interval=100
user_dir=./gectoolkit/model/SynGEC/src/src_syngec/syngec_model
min_loss_scale=0.0001
dual_aggregation_freeze=True
decoder_output_dim=1024
curriculum=0
scoring=bleu
optimizer=adam
adam_betas=(0.9,0.999)
share_decoder_input_output_embed=True
fp16_no_flatten_grads=False
distributed_backend=nccl
adaptive_input=False
dpd_suffix=['dpd']
attention_dropout=0.0
fp16=True
pipeline_checkpoint=never
fix_batches_to_gpus=False
fp16_scale_tolerance=0.0
valid_subset=valid
gen_subset=test
no_last_checkpoints=False
decoder_attention_heads=16
distributed_wrapper=DDP
activation_dropout=0.0
log_format=tqdm
decoder_embed_dim=1024
dual_aggregation_beta=0.5
disable_validation=False
quant_noise_scalar=0
use_bmuf=False
gat_encoder_layers=3
arch=syntax_enhanced_bart_large
eval_bleu_print_samples=False
no_scale_embedding=True
zero_sharding=none
pipeline_decoder_devices=None
save_interval_updates=0
localsgd_frequency=3
ignore_prefix_size=0
eval_bleu_args=None
encoder_layerdrop=0
syntax_type=['dep']
distributed_no_spawn=False
left_pad_source=True
decoder_layers=12
adaptive_softmax_cutoff=None
upsample_primary=1
ddp_backend=c10d
validate_after_updates=0
power=1.0
data_buffer_size=10
memory_efficient_bf16=False
num_batch_buckets=0
share_all_embeddings=True
alpha=1.0
gated_sum=False
distributed_init_method=None
report_accuracy=False
end_learning_rate=0.0
batch_size_valid=None
pipeline_devices=None
left_pad_target=False
source_word_dropout_probs=False
bf16=False
swm_suffix=swm
encoder_embed_dim=1024
force_anneal=None
no_epoch_checkpoints=False
syntax_encoder=GCN
encoder_ffn_embed_dim=4096
label_smoothing=0.1
num_shards=1
find_unused_parameters=True
no_progress_bar=False
load_alignments=False
use_old_adam=False
eval_bleu_detok_args=None
tensorboard_logdir=None
slowmo_algorithm=LocalSGD
fast_stat_sync=False
layernorm_embedding=True
encoder_layers_to_keep=None
eval_bleu_remove_bpe=None
scale_syntax_encoder_lr=None
eval_bleu=False
fp16_scale_window=None
pipeline_encoder_balance=None
pipeline_encoder_devices=None
relu_dropout=0.0
threshold_loss_scale=None
activation_fn=gelu
task=syntax-enhanced-translation
target_lang=tgt
bart_model_file_from_transformers=None
all_gather_list_size=16384
stop_time_hours=0
validate_interval_updates=0
save_interval=1
conll_suffix=['conll']
empty_cache_freq=0
encoder_learned_pos=True
tpu=False
nprocs_per_node=1
keep_last_epochs=10
device_id=0
source_lang_with_nt=src_nt
use_dpd=False
pipeline_chunks=0
cross_syntax_fuse=False
keep_interval_updates=-1
encoder_embed_path=None
adam_eps=1e-08
model_parallel_size=1
sentence_avg=False
encoder_layers=12
decoder_ffn_embed_dim=4096
dataset_impl=None
criterion=label_smoothed_cross_entropy
fixed_validation_seed=None
profile=False
distributed_rank=0
source_lang=src
eval_tokenized_bleu=False
source_word_dropout=0.2
adaptive_softmax_dropout=0
syntax_model_file=None
checkpoint_suffix=
required_seq_len_multiple=1
no_save=False
use_syntax=True
probs_suffix=['probs']
decoder_learned_pos=True
decoder_input_dim=1024
memory_efficient_fp16=False
decoder_layers_to_keep=None
gat_attention_heads=4
bucket_cap_mb=25
checkpoint_shard_count=1
pipeline_model_parallel=False
encoder_normalize_before=False
keep_best_checkpoints=-1
no_token_positional_embeddings=False
pooler_activation_fn=tanh
shard_id=0
only_dsa=False
max_update=0
encoder_attention_heads=16
freeze_bart_parameters=True
tokenizer=None
total_num_update=1000000
pipeline_decoder_balance=None
quantization_config_path=None
broadcast_buffers=False
batch_size=None
maximize_best_checkpoint_metric=False
pooler_dropout=0.0
warmup_updates=2000
min_lr=-1.0
only_gnn=True
eval_bleu_detok=space
no_seed_provided=False
truncate_source=False
pipeline_balance=None
model=SynGEC
dataset=Visual_OCR
augment=none
device=cuda
map_location=cuda
gpu_nums=1


Thu 03 Oct 2024 03:27:50 INFO [src] dictionary: 21132 types
Thu 03 Oct 2024 03:27:50 INFO [tgt] dictionary: 21132 types
Thu 03 Oct 2024 03:27:50 INFO [syntax label0] dictionary: 51 types
Thu 03 Oct 2024 03:27:50 INFO [src] dictionary: 21132 types
Thu 03 Oct 2024 03:27:50 INFO [tgt] dictionary: 21132 types
Thu 03 Oct 2024 03:27:50 INFO [syntax label0] dictionary: 51 types
Thu 03 Oct 2024 03:27:50 INFO loaded 245 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_with_syntax_bart/bin/valid.src-tgt.src
Thu 03 Oct 2024 03:27:50 INFO loaded 245 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_with_syntax_bart/bin/valid.src-tgt.tgt
Thu 03 Oct 2024 03:27:50 INFO ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_with_syntax_bart/bin valid src-tgt 245 examples
Thu 03 Oct 2024 03:27:50 INFO loaded 245 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_with_syntax_bart/bin/valid.conll.src-tgt.src
Thu 03 Oct 2024 03:27:50 INFO loaded 245 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_with_syntax_bart/bin/valid.dpd.src-tgt.src
Thu 03 Oct 2024 03:27:50 INFO loaded 245 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_with_syntax_bart/bin/valid.probs.src-tgt.src
Thu 03 Oct 2024 03:27:50 INFO success! syntax types: 1, source conll lines: 245
Thu 03 Oct 2024 03:27:50 INFO loaded 1960 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_with_syntax_bart/bin/train.src-tgt.src
Thu 03 Oct 2024 03:27:50 INFO loaded 1960 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_with_syntax_bart/bin/train.src-tgt.tgt
Thu 03 Oct 2024 03:27:50 INFO ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_with_syntax_bart/bin train src-tgt 1960 examples
Thu 03 Oct 2024 03:27:50 INFO loaded 1960 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_with_syntax_bart/bin/train.conll.src-tgt.src
Thu 03 Oct 2024 03:27:50 INFO loaded 1960 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_with_syntax_bart/bin/train.dpd.src-tgt.src
Thu 03 Oct 2024 03:27:50 INFO loaded 1960 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_with_syntax_bart/bin/train.probs.src-tgt.src
Thu 03 Oct 2024 03:27:50 INFO success! syntax types: 1, source conll lines: 1960
Thu 03 Oct 2024 03:27:50 INFO loaded 246 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_test_with_syntax_bart/bin/test.conll.src-tgt.src
Thu 03 Oct 2024 03:27:50 INFO loaded 246 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_test_with_syntax_bart/bin/test.dpd.src-tgt.src
Thu 03 Oct 2024 03:27:50 INFO loaded 246 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_test_with_syntax_bart/bin/test.probs.src-tgt.src
Thu 03 Oct 2024 03:27:50 INFO success! syntax types: 1, source conll lines: 246
Thu 03 Oct 2024 03:27:58 INFO detected shared parameter: encoder.sentence_encoder.embed_tokens.weight <- decoder.embed_tokens.weight
Thu 03 Oct 2024 03:27:58 INFO detected shared parameter: encoder.sentence_encoder.embed_tokens.weight <- decoder.output_projection.weight
Thu 03 Oct 2024 03:27:58 INFO ***********************CUDA enviroments for all 1 workers***********************
Thu 03 Oct 2024 03:27:58 INFO rank   0: capabilities =  8.0  ; total memory = 79.151 GB ; name = NVIDIA A800 80GB PCIe                   
Thu 03 Oct 2024 03:27:58 INFO ***********************CUDA enviroments for all 1 workers***********************
Thu 03 Oct 2024 03:28:02 INFO loaded checkpoint ./gectoolkit/properties/model/SynGEC/preprocess/gopar/chinese_Visual_OCR_bart_baseline/checkpoint_best.pt (epoch 21 @ 1414 updates)
Thu 03 Oct 2024 03:28:02 INFO loading train data for epoch 21
Thu 03 Oct 2024 03:28:02 INFO loaded 1960 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_with_syntax_bart/bin/train.src-tgt.src
Thu 03 Oct 2024 03:28:02 INFO loaded 1960 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_with_syntax_bart/bin/train.src-tgt.tgt
Thu 03 Oct 2024 03:28:02 INFO ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_with_syntax_bart/bin train src-tgt 1960 examples
Thu 03 Oct 2024 03:28:02 INFO loaded 1960 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_with_syntax_bart/bin/train.conll.src-tgt.src
Thu 03 Oct 2024 03:28:02 INFO loaded 1960 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_with_syntax_bart/bin/train.dpd.src-tgt.src
Thu 03 Oct 2024 03:28:02 INFO loaded 1960 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_with_syntax_bart/bin/train.probs.src-tgt.src
Thu 03 Oct 2024 03:28:02 INFO success! syntax types: 1, source conll lines: 1960
Thu 03 Oct 2024 03:28:03 INFO SynGEC(
  (model): SyntaxEnhancedBARTModel(
    (encoder): SyntaxEnhancedTransformerEncoder(
      (sentence_encoder): SyntaxEnhancedSentenceTransformerEncoder(
        (dropout_module): FairseqDropout()
        (embed_tokens): Embedding(21132, 1024, padding_idx=1)
        (embed_positions): LearnedPositionalEmbedding(514, 1024, padding_idx=1)
        (layernorm_embedding): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        (layers): ModuleList(
          (0-11): 12 x DSATransformerEncoderLayer(
            (self_attn): DSAMultiheadAttention(
              (dropout_module): FairseqDropout()
              (k_proj): Linear(in_features=1024, out_features=1024, bias=True)
              (v_proj): Linear(in_features=1024, out_features=1024, bias=True)
              (q_proj): Linear(in_features=1024, out_features=1024, bias=True)
              (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
            )
            (self_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
            (dropout_module): FairseqDropout()
            (activation_dropout_module): FairseqDropout()
            (fc1): Linear(in_features=1024, out_features=4096, bias=True)
            (fc2): Linear(in_features=4096, out_features=1024, bias=True)
            (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
      )
      (syntax_encoder): SyntaxEnhancedSyntaxGuidedTransformerEncoder(
        (dropout_module): FairseqDropout()
        (embed_tokens): Embedding(51, 1024, padding_idx=0)
        (layers): ModuleList(
          (0-2): 3 x GCNSyntaxGuidedTransformerEncoderLayer(
            (gcn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
            (dropout_module): FairseqDropout()
            (activation_dropout_module): FairseqDropout()
            (W_out): Linear(in_features=2048, out_features=1024, bias=True)
            (W_in): Linear(in_features=2048, out_features=1024, bias=True)
            (fc): Linear(in_features=1024, out_features=1024, bias=True)
            (fc1): Linear(in_features=1024, out_features=4096, bias=True)
            (fc2): Linear(in_features=4096, out_features=1024, bias=True)
            (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
      )
    )
    (decoder): SyntaxEnhancedTransformerDecoder(
      (dropout_module): FairseqDropout()
      (embed_tokens): Embedding(21132, 1024, padding_idx=1)
      (embed_positions): LearnedPositionalEmbedding(514, 1024, padding_idx=1)
      (layernorm_embedding): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      (layers): ModuleList(
        (0-11): 12 x TransformerDecoderLayer(
          (dropout_module): FairseqDropout()
          (self_attn): MultiheadAttention(
            (dropout_module): FairseqDropout()
            (k_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (v_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (q_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
          )
          (activation_dropout_module): FairseqDropout()
          (self_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          (encoder_attn): MultiheadAttention(
            (dropout_module): FairseqDropout()
            (k_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (v_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (q_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
          )
          (encoder_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          (fc1): Linear(in_features=1024, out_features=4096, bias=True)
          (fc2): Linear(in_features=4096, out_features=1024, bias=True)
          (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        )
      )
      (output_projection): Linear(in_features=1024, out_features=21132, bias=False)
    )
    (classification_heads): ModuleDict()
  )
  (criterion): LabelSmoothedCrossEntropyCriterion()
)
Thu 03 Oct 2024 03:28:03 INFO start training...
Thu 03 Oct 2024 03:28:04 INFO | supervised_trainer |NOTE: overflow detected, setting loss scale to: 64.0
Thu 03 Oct 2024 03:28:05 INFO | supervised_trainer |NOTE: overflow detected, setting loss scale to: 32.0
Thu 03 Oct 2024 03:28:06 INFO | supervised_trainer |NOTE: overflow detected, setting loss scale to: 16.0
Thu 03 Oct 2024 03:28:15 INFO epoch [  1] train time 0h 0m 11s |  loss |[6104.251]
Thu 03 Oct 2024 03:34:26 INFO random_seed=2024
use_gpu=True
learning_rate=6e-06
train_batch_size=32
test_batch_size=1
epoch_nums=200
test_step=20
display_train_step=1
gpu_id=5
training_resume=False
load_best_config=False
supervising_mode=fully_supervised
validset_divide=True
test_only=False
shuffle=True
model_config_file=gectoolkit/properties/model/SynGEC.json
best_config_file=gectoolkit/properties/best_config/SynGEC_Visual_OCR.json
dataset_config_file=gectoolkit/properties/dataset/Visual_OCR.json
dataset_dir=dataset/Visual_OCR
checkpoint_file=checkpoint/SynGEC-Visual_OCR.pth
log_file=log/SynGEC-Visual_OCR.log
output_dir=result/SynGEC-Visual_OCR
checkpoint_dir=checkpoint/SynGEC-Visual_OCR
min_word_keep=5
min_generate_keep=5
language=zh
fp16_init_scale=128
distributed_port=-1
decoder_embed_path=None
quant_noise_pq_block_size=8
best_checkpoint_metric=loss
cross_self_attention=False
validate_interval=1
tie_adaptive_weights=False
bpe=None
decoder_normalize_before=False
cpu=False
optimizer_overrides={}
quant_noise_pq=0
lr_scheduler=polynomial_decay
no_save_optimizer_state=False
train_subset=train
no_cross_attention=False
distributed_world_size=1
decoder_layerdrop=0
skip_invalid_size_inputs_valid_test=True
lr=[0.0005]
slowmo_momentum=None
log_interval=100
user_dir=./gectoolkit/model/SynGEC/src/src_syngec/syngec_model
min_loss_scale=0.0001
dual_aggregation_freeze=True
decoder_output_dim=1024
curriculum=0
scoring=bleu
optimizer=adam
adam_betas=(0.9,0.999)
share_decoder_input_output_embed=True
fp16_no_flatten_grads=False
distributed_backend=nccl
adaptive_input=False
dpd_suffix=['dpd']
attention_dropout=0.0
fp16=True
pipeline_checkpoint=never
fix_batches_to_gpus=False
fp16_scale_tolerance=0.0
valid_subset=valid
gen_subset=test
no_last_checkpoints=False
decoder_attention_heads=16
distributed_wrapper=DDP
activation_dropout=0.0
log_format=tqdm
decoder_embed_dim=1024
dual_aggregation_beta=0.5
disable_validation=False
quant_noise_scalar=0
use_bmuf=False
gat_encoder_layers=3
arch=syntax_enhanced_bart_large
eval_bleu_print_samples=False
no_scale_embedding=True
zero_sharding=none
pipeline_decoder_devices=None
save_interval_updates=0
localsgd_frequency=3
ignore_prefix_size=0
eval_bleu_args=None
encoder_layerdrop=0
syntax_type=['dep']
distributed_no_spawn=False
left_pad_source=True
decoder_layers=12
adaptive_softmax_cutoff=None
upsample_primary=1
ddp_backend=c10d
validate_after_updates=0
power=1.0
data_buffer_size=10
memory_efficient_bf16=False
num_batch_buckets=0
share_all_embeddings=True
alpha=1.0
gated_sum=False
distributed_init_method=None
report_accuracy=False
end_learning_rate=0.0
batch_size_valid=None
pipeline_devices=None
left_pad_target=False
source_word_dropout_probs=False
bf16=False
swm_suffix=swm
encoder_embed_dim=1024
force_anneal=None
no_epoch_checkpoints=False
syntax_encoder=GCN
encoder_ffn_embed_dim=4096
label_smoothing=0.1
num_shards=1
find_unused_parameters=True
no_progress_bar=False
load_alignments=False
use_old_adam=False
eval_bleu_detok_args=None
tensorboard_logdir=None
slowmo_algorithm=LocalSGD
fast_stat_sync=False
layernorm_embedding=True
encoder_layers_to_keep=None
eval_bleu_remove_bpe=None
scale_syntax_encoder_lr=None
eval_bleu=False
fp16_scale_window=None
pipeline_encoder_balance=None
pipeline_encoder_devices=None
relu_dropout=0.0
threshold_loss_scale=None
activation_fn=gelu
task=syntax-enhanced-translation
target_lang=tgt
bart_model_file_from_transformers=None
all_gather_list_size=16384
stop_time_hours=0
validate_interval_updates=0
save_interval=1
conll_suffix=['conll']
empty_cache_freq=0
encoder_learned_pos=True
tpu=False
nprocs_per_node=1
keep_last_epochs=10
device_id=0
source_lang_with_nt=src_nt
use_dpd=False
pipeline_chunks=0
cross_syntax_fuse=False
keep_interval_updates=-1
encoder_embed_path=None
adam_eps=1e-08
model_parallel_size=1
sentence_avg=False
encoder_layers=12
decoder_ffn_embed_dim=4096
dataset_impl=None
criterion=label_smoothed_cross_entropy
fixed_validation_seed=None
profile=False
distributed_rank=0
source_lang=src
eval_tokenized_bleu=False
source_word_dropout=0.2
adaptive_softmax_dropout=0
syntax_model_file=None
checkpoint_suffix=
required_seq_len_multiple=1
no_save=False
use_syntax=True
probs_suffix=['probs']
decoder_learned_pos=True
decoder_input_dim=1024
memory_efficient_fp16=False
decoder_layers_to_keep=None
gat_attention_heads=4
bucket_cap_mb=25
checkpoint_shard_count=1
pipeline_model_parallel=False
encoder_normalize_before=False
keep_best_checkpoints=-1
no_token_positional_embeddings=False
pooler_activation_fn=tanh
shard_id=0
only_dsa=False
max_update=0
encoder_attention_heads=16
freeze_bart_parameters=True
tokenizer=None
total_num_update=1000000
pipeline_decoder_balance=None
quantization_config_path=None
broadcast_buffers=False
batch_size=None
maximize_best_checkpoint_metric=False
pooler_dropout=0.0
warmup_updates=2000
min_lr=-1.0
only_gnn=True
eval_bleu_detok=space
no_seed_provided=False
truncate_source=False
pipeline_balance=None
model=SynGEC
dataset=Visual_OCR
augment=none
device=cuda
map_location=cuda
gpu_nums=1


Thu 03 Oct 2024 03:34:26 INFO [src] dictionary: 21132 types
Thu 03 Oct 2024 03:34:26 INFO [tgt] dictionary: 21132 types
Thu 03 Oct 2024 03:34:26 INFO [syntax label0] dictionary: 51 types
Thu 03 Oct 2024 03:34:26 INFO [src] dictionary: 21132 types
Thu 03 Oct 2024 03:34:26 INFO [tgt] dictionary: 21132 types
Thu 03 Oct 2024 03:34:26 INFO [syntax label0] dictionary: 51 types
Thu 03 Oct 2024 03:34:26 INFO loaded 245 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_with_syntax_bart/bin/valid.src-tgt.src
Thu 03 Oct 2024 03:34:26 INFO loaded 245 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_with_syntax_bart/bin/valid.src-tgt.tgt
Thu 03 Oct 2024 03:34:26 INFO ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_with_syntax_bart/bin valid src-tgt 245 examples
Thu 03 Oct 2024 03:34:26 INFO loaded 245 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_with_syntax_bart/bin/valid.conll.src-tgt.src
Thu 03 Oct 2024 03:34:26 INFO loaded 245 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_with_syntax_bart/bin/valid.dpd.src-tgt.src
Thu 03 Oct 2024 03:34:26 INFO loaded 245 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_with_syntax_bart/bin/valid.probs.src-tgt.src
Thu 03 Oct 2024 03:34:26 INFO success! syntax types: 1, source conll lines: 245
Thu 03 Oct 2024 03:34:26 INFO loaded 1960 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_with_syntax_bart/bin/train.src-tgt.src
Thu 03 Oct 2024 03:34:26 INFO loaded 1960 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_with_syntax_bart/bin/train.src-tgt.tgt
Thu 03 Oct 2024 03:34:26 INFO ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_with_syntax_bart/bin train src-tgt 1960 examples
Thu 03 Oct 2024 03:34:26 INFO loaded 1960 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_with_syntax_bart/bin/train.conll.src-tgt.src
Thu 03 Oct 2024 03:34:26 INFO loaded 1960 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_with_syntax_bart/bin/train.dpd.src-tgt.src
Thu 03 Oct 2024 03:34:26 INFO loaded 1960 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_with_syntax_bart/bin/train.probs.src-tgt.src
Thu 03 Oct 2024 03:34:26 INFO success! syntax types: 1, source conll lines: 1960
Thu 03 Oct 2024 03:34:26 INFO loaded 246 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_test_with_syntax_bart/bin/test.conll.src-tgt.src
Thu 03 Oct 2024 03:34:26 INFO loaded 246 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_test_with_syntax_bart/bin/test.dpd.src-tgt.src
Thu 03 Oct 2024 03:34:26 INFO loaded 246 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_test_with_syntax_bart/bin/test.probs.src-tgt.src
Thu 03 Oct 2024 03:34:26 INFO success! syntax types: 1, source conll lines: 246
Thu 03 Oct 2024 03:34:34 INFO detected shared parameter: encoder.sentence_encoder.embed_tokens.weight <- decoder.embed_tokens.weight
Thu 03 Oct 2024 03:34:34 INFO detected shared parameter: encoder.sentence_encoder.embed_tokens.weight <- decoder.output_projection.weight
Thu 03 Oct 2024 03:34:34 INFO ***********************CUDA enviroments for all 1 workers***********************
Thu 03 Oct 2024 03:34:34 INFO rank   0: capabilities =  8.0  ; total memory = 79.151 GB ; name = NVIDIA A800 80GB PCIe                   
Thu 03 Oct 2024 03:34:34 INFO ***********************CUDA enviroments for all 1 workers***********************
Thu 03 Oct 2024 03:34:37 INFO loaded checkpoint ./gectoolkit/properties/model/SynGEC/preprocess/gopar/chinese_Visual_OCR_bart_baseline/checkpoint_best.pt (epoch 21 @ 1414 updates)
Thu 03 Oct 2024 03:34:37 INFO loading train data for epoch 21
Thu 03 Oct 2024 03:34:37 INFO loaded 1960 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_with_syntax_bart/bin/train.src-tgt.src
Thu 03 Oct 2024 03:34:37 INFO loaded 1960 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_with_syntax_bart/bin/train.src-tgt.tgt
Thu 03 Oct 2024 03:34:37 INFO ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_with_syntax_bart/bin train src-tgt 1960 examples
Thu 03 Oct 2024 03:34:37 INFO loaded 1960 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_with_syntax_bart/bin/train.conll.src-tgt.src
Thu 03 Oct 2024 03:34:37 INFO loaded 1960 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_with_syntax_bart/bin/train.dpd.src-tgt.src
Thu 03 Oct 2024 03:34:37 INFO loaded 1960 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_with_syntax_bart/bin/train.probs.src-tgt.src
Thu 03 Oct 2024 03:34:37 INFO success! syntax types: 1, source conll lines: 1960
Thu 03 Oct 2024 03:34:39 INFO SynGEC(
  (model): SyntaxEnhancedBARTModel(
    (encoder): SyntaxEnhancedTransformerEncoder(
      (sentence_encoder): SyntaxEnhancedSentenceTransformerEncoder(
        (dropout_module): FairseqDropout()
        (embed_tokens): Embedding(21132, 1024, padding_idx=1)
        (embed_positions): LearnedPositionalEmbedding(514, 1024, padding_idx=1)
        (layernorm_embedding): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        (layers): ModuleList(
          (0-11): 12 x DSATransformerEncoderLayer(
            (self_attn): DSAMultiheadAttention(
              (dropout_module): FairseqDropout()
              (k_proj): Linear(in_features=1024, out_features=1024, bias=True)
              (v_proj): Linear(in_features=1024, out_features=1024, bias=True)
              (q_proj): Linear(in_features=1024, out_features=1024, bias=True)
              (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
            )
            (self_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
            (dropout_module): FairseqDropout()
            (activation_dropout_module): FairseqDropout()
            (fc1): Linear(in_features=1024, out_features=4096, bias=True)
            (fc2): Linear(in_features=4096, out_features=1024, bias=True)
            (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
      )
      (syntax_encoder): SyntaxEnhancedSyntaxGuidedTransformerEncoder(
        (dropout_module): FairseqDropout()
        (embed_tokens): Embedding(51, 1024, padding_idx=0)
        (layers): ModuleList(
          (0-2): 3 x GCNSyntaxGuidedTransformerEncoderLayer(
            (gcn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
            (dropout_module): FairseqDropout()
            (activation_dropout_module): FairseqDropout()
            (W_out): Linear(in_features=2048, out_features=1024, bias=True)
            (W_in): Linear(in_features=2048, out_features=1024, bias=True)
            (fc): Linear(in_features=1024, out_features=1024, bias=True)
            (fc1): Linear(in_features=1024, out_features=4096, bias=True)
            (fc2): Linear(in_features=4096, out_features=1024, bias=True)
            (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
      )
    )
    (decoder): SyntaxEnhancedTransformerDecoder(
      (dropout_module): FairseqDropout()
      (embed_tokens): Embedding(21132, 1024, padding_idx=1)
      (embed_positions): LearnedPositionalEmbedding(514, 1024, padding_idx=1)
      (layernorm_embedding): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      (layers): ModuleList(
        (0-11): 12 x TransformerDecoderLayer(
          (dropout_module): FairseqDropout()
          (self_attn): MultiheadAttention(
            (dropout_module): FairseqDropout()
            (k_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (v_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (q_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
          )
          (activation_dropout_module): FairseqDropout()
          (self_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          (encoder_attn): MultiheadAttention(
            (dropout_module): FairseqDropout()
            (k_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (v_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (q_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
          )
          (encoder_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          (fc1): Linear(in_features=1024, out_features=4096, bias=True)
          (fc2): Linear(in_features=4096, out_features=1024, bias=True)
          (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        )
      )
      (output_projection): Linear(in_features=1024, out_features=21132, bias=False)
    )
    (classification_heads): ModuleDict()
  )
  (criterion): LabelSmoothedCrossEntropyCriterion()
)
Thu 03 Oct 2024 03:34:39 INFO start training...
Thu 03 Oct 2024 03:34:39 INFO | supervised_trainer |NOTE: overflow detected, setting loss scale to: 64.0
Thu 03 Oct 2024 03:34:40 INFO | supervised_trainer |NOTE: overflow detected, setting loss scale to: 32.0
Thu 03 Oct 2024 03:34:41 INFO | supervised_trainer |NOTE: overflow detected, setting loss scale to: 16.0
Thu 03 Oct 2024 03:34:51 INFO epoch [  1] train time 0h 0m 11s |  loss |[6104.251]
Thu 03 Oct 2024 23:21:20 INFO random_seed=2024
use_gpu=True
learning_rate=6e-06
train_batch_size=32
test_batch_size=1
epoch_nums=200
test_step=5
display_train_step=1
gpu_id=5
training_resume=False
load_best_config=False
supervising_mode=fully_supervised
validset_divide=True
test_only=False
shuffle=True
model_config_file=gectoolkit/properties/model/SynGEC.json
best_config_file=gectoolkit/properties/best_config/SynGEC_Visual_OCR.json
dataset_config_file=gectoolkit/properties/dataset/Visual_OCR.json
dataset_dir=dataset/Visual_OCR
checkpoint_file=checkpoint/SynGEC-Visual_OCR.pth
log_file=log/SynGEC-Visual_OCR.log
output_dir=result/SynGEC-Visual_OCR
checkpoint_dir=checkpoint/SynGEC-Visual_OCR
min_word_keep=5
min_generate_keep=5
language=zh
fp16_init_scale=128
distributed_port=-1
decoder_embed_path=None
quant_noise_pq_block_size=8
best_checkpoint_metric=loss
cross_self_attention=False
validate_interval=1
tie_adaptive_weights=False
bpe=None
decoder_normalize_before=False
cpu=False
optimizer_overrides={}
quant_noise_pq=0
lr_scheduler=polynomial_decay
no_save_optimizer_state=False
train_subset=train
no_cross_attention=False
distributed_world_size=1
decoder_layerdrop=0
skip_invalid_size_inputs_valid_test=True
lr=[0.0005]
slowmo_momentum=None
log_interval=100
user_dir=./gectoolkit/model/SynGEC/src/src_syngec/syngec_model
min_loss_scale=0.0001
dual_aggregation_freeze=True
decoder_output_dim=1024
curriculum=0
scoring=bleu
optimizer=adam
adam_betas=(0.9,0.999)
share_decoder_input_output_embed=True
fp16_no_flatten_grads=False
distributed_backend=nccl
adaptive_input=False
dpd_suffix=['dpd']
attention_dropout=0.0
fp16=True
pipeline_checkpoint=never
fix_batches_to_gpus=False
fp16_scale_tolerance=0.0
valid_subset=valid
gen_subset=test
no_last_checkpoints=False
decoder_attention_heads=16
distributed_wrapper=DDP
activation_dropout=0.0
log_format=tqdm
decoder_embed_dim=1024
dual_aggregation_beta=0.5
disable_validation=False
quant_noise_scalar=0
use_bmuf=False
gat_encoder_layers=3
arch=syntax_enhanced_bart_large
eval_bleu_print_samples=False
no_scale_embedding=True
zero_sharding=none
pipeline_decoder_devices=None
save_interval_updates=0
localsgd_frequency=3
ignore_prefix_size=0
eval_bleu_args=None
encoder_layerdrop=0
syntax_type=['dep']
distributed_no_spawn=False
left_pad_source=True
decoder_layers=12
adaptive_softmax_cutoff=None
upsample_primary=1
ddp_backend=c10d
validate_after_updates=0
power=1.0
data_buffer_size=10
memory_efficient_bf16=False
num_batch_buckets=0
share_all_embeddings=True
alpha=1.0
gated_sum=False
distributed_init_method=None
report_accuracy=False
end_learning_rate=0.0
batch_size_valid=None
pipeline_devices=None
left_pad_target=False
source_word_dropout_probs=False
bf16=False
swm_suffix=swm
encoder_embed_dim=1024
force_anneal=None
no_epoch_checkpoints=False
syntax_encoder=GCN
encoder_ffn_embed_dim=4096
label_smoothing=0.1
num_shards=1
find_unused_parameters=True
no_progress_bar=False
load_alignments=False
use_old_adam=False
eval_bleu_detok_args=None
tensorboard_logdir=None
slowmo_algorithm=LocalSGD
fast_stat_sync=False
layernorm_embedding=True
encoder_layers_to_keep=None
eval_bleu_remove_bpe=None
scale_syntax_encoder_lr=None
eval_bleu=False
fp16_scale_window=None
pipeline_encoder_balance=None
pipeline_encoder_devices=None
relu_dropout=0.0
threshold_loss_scale=None
activation_fn=gelu
task=syntax-enhanced-translation
target_lang=tgt
bart_model_file_from_transformers=None
all_gather_list_size=16384
stop_time_hours=0
validate_interval_updates=0
save_interval=1
conll_suffix=['conll']
empty_cache_freq=0
encoder_learned_pos=True
tpu=False
nprocs_per_node=1
keep_last_epochs=10
device_id=0
source_lang_with_nt=src_nt
use_dpd=False
pipeline_chunks=0
cross_syntax_fuse=False
keep_interval_updates=-1
encoder_embed_path=None
adam_eps=1e-08
model_parallel_size=1
sentence_avg=False
encoder_layers=12
decoder_ffn_embed_dim=4096
dataset_impl=None
criterion=label_smoothed_cross_entropy
fixed_validation_seed=None
profile=False
distributed_rank=0
source_lang=src
eval_tokenized_bleu=False
source_word_dropout=0.2
adaptive_softmax_dropout=0
syntax_model_file=None
checkpoint_suffix=
required_seq_len_multiple=1
no_save=False
use_syntax=True
probs_suffix=['probs']
decoder_learned_pos=True
decoder_input_dim=1024
memory_efficient_fp16=False
decoder_layers_to_keep=None
gat_attention_heads=4
bucket_cap_mb=25
checkpoint_shard_count=1
pipeline_model_parallel=False
encoder_normalize_before=False
keep_best_checkpoints=-1
no_token_positional_embeddings=False
pooler_activation_fn=tanh
shard_id=0
only_dsa=False
max_update=0
encoder_attention_heads=16
freeze_bart_parameters=True
tokenizer=None
total_num_update=1000000
pipeline_decoder_balance=None
quantization_config_path=None
broadcast_buffers=False
batch_size=None
maximize_best_checkpoint_metric=False
pooler_dropout=0.0
warmup_updates=2000
min_lr=-1.0
only_gnn=True
eval_bleu_detok=space
no_seed_provided=False
truncate_source=False
pipeline_balance=None
model=SynGEC
dataset=Visual_OCR
augment=none
device=cuda
map_location=cuda
gpu_nums=1


Thu 03 Oct 2024 23:21:20 INFO [src] dictionary: 21132 types
Thu 03 Oct 2024 23:21:20 INFO [tgt] dictionary: 21132 types
Thu 03 Oct 2024 23:21:20 INFO [syntax label0] dictionary: 51 types
Thu 03 Oct 2024 23:21:20 INFO [src] dictionary: 21132 types
Thu 03 Oct 2024 23:21:20 INFO [tgt] dictionary: 21132 types
Thu 03 Oct 2024 23:21:20 INFO [syntax label0] dictionary: 51 types
Thu 03 Oct 2024 23:21:20 INFO loaded 245 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_with_syntax_bart/bin/valid.src-tgt.src
Thu 03 Oct 2024 23:21:20 INFO loaded 245 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_with_syntax_bart/bin/valid.src-tgt.tgt
Thu 03 Oct 2024 23:21:20 INFO ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_with_syntax_bart/bin valid src-tgt 245 examples
Thu 03 Oct 2024 23:21:20 INFO loaded 245 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_with_syntax_bart/bin/valid.conll.src-tgt.src
Thu 03 Oct 2024 23:21:20 INFO loaded 245 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_with_syntax_bart/bin/valid.dpd.src-tgt.src
Thu 03 Oct 2024 23:21:20 INFO loaded 245 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_with_syntax_bart/bin/valid.probs.src-tgt.src
Thu 03 Oct 2024 23:21:20 INFO success! syntax types: 1, source conll lines: 245
Thu 03 Oct 2024 23:21:20 INFO loaded 1960 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_with_syntax_bart/bin/train.src-tgt.src
Thu 03 Oct 2024 23:21:20 INFO loaded 1960 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_with_syntax_bart/bin/train.src-tgt.tgt
Thu 03 Oct 2024 23:21:20 INFO ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_with_syntax_bart/bin train src-tgt 1960 examples
Thu 03 Oct 2024 23:21:20 INFO loaded 1960 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_with_syntax_bart/bin/train.conll.src-tgt.src
Thu 03 Oct 2024 23:21:20 INFO loaded 1960 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_with_syntax_bart/bin/train.dpd.src-tgt.src
Thu 03 Oct 2024 23:21:20 INFO loaded 1960 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_with_syntax_bart/bin/train.probs.src-tgt.src
Thu 03 Oct 2024 23:21:20 INFO success! syntax types: 1, source conll lines: 1960
Thu 03 Oct 2024 23:21:20 INFO loaded 246 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_test_with_syntax_bart/bin/test.conll.src-tgt.src
Thu 03 Oct 2024 23:21:20 INFO loaded 246 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_test_with_syntax_bart/bin/test.dpd.src-tgt.src
Thu 03 Oct 2024 23:21:20 INFO loaded 246 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_test_with_syntax_bart/bin/test.probs.src-tgt.src
Thu 03 Oct 2024 23:21:20 INFO success! syntax types: 1, source conll lines: 246
Thu 03 Oct 2024 23:21:30 INFO detected shared parameter: encoder.sentence_encoder.embed_tokens.weight <- decoder.embed_tokens.weight
Thu 03 Oct 2024 23:21:30 INFO detected shared parameter: encoder.sentence_encoder.embed_tokens.weight <- decoder.output_projection.weight
Thu 03 Oct 2024 23:21:30 INFO ***********************CUDA enviroments for all 1 workers***********************
Thu 03 Oct 2024 23:21:30 INFO rank   0: capabilities =  8.0  ; total memory = 79.151 GB ; name = NVIDIA A800 80GB PCIe                   
Thu 03 Oct 2024 23:21:30 INFO ***********************CUDA enviroments for all 1 workers***********************
Thu 03 Oct 2024 23:21:34 INFO loaded checkpoint ./gectoolkit/properties/model/SynGEC/preprocess/gopar/chinese_Visual_OCR_bart_baseline/checkpoint_best.pt (epoch 21 @ 1414 updates)
Thu 03 Oct 2024 23:21:35 INFO loading train data for epoch 21
Thu 03 Oct 2024 23:21:35 INFO loaded 1960 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_with_syntax_bart/bin/train.src-tgt.src
Thu 03 Oct 2024 23:21:35 INFO loaded 1960 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_with_syntax_bart/bin/train.src-tgt.tgt
Thu 03 Oct 2024 23:21:35 INFO ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_with_syntax_bart/bin train src-tgt 1960 examples
Thu 03 Oct 2024 23:21:35 INFO loaded 1960 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_with_syntax_bart/bin/train.conll.src-tgt.src
Thu 03 Oct 2024 23:21:35 INFO loaded 1960 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_with_syntax_bart/bin/train.dpd.src-tgt.src
Thu 03 Oct 2024 23:21:35 INFO loaded 1960 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_with_syntax_bart/bin/train.probs.src-tgt.src
Thu 03 Oct 2024 23:21:35 INFO success! syntax types: 1, source conll lines: 1960
Thu 03 Oct 2024 23:21:36 INFO SynGEC(
  (model): SyntaxEnhancedBARTModel(
    (encoder): SyntaxEnhancedTransformerEncoder(
      (sentence_encoder): SyntaxEnhancedSentenceTransformerEncoder(
        (dropout_module): FairseqDropout()
        (embed_tokens): Embedding(21132, 1024, padding_idx=1)
        (embed_positions): LearnedPositionalEmbedding(514, 1024, padding_idx=1)
        (layernorm_embedding): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        (layers): ModuleList(
          (0-11): 12 x DSATransformerEncoderLayer(
            (self_attn): DSAMultiheadAttention(
              (dropout_module): FairseqDropout()
              (k_proj): Linear(in_features=1024, out_features=1024, bias=True)
              (v_proj): Linear(in_features=1024, out_features=1024, bias=True)
              (q_proj): Linear(in_features=1024, out_features=1024, bias=True)
              (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
            )
            (self_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
            (dropout_module): FairseqDropout()
            (activation_dropout_module): FairseqDropout()
            (fc1): Linear(in_features=1024, out_features=4096, bias=True)
            (fc2): Linear(in_features=4096, out_features=1024, bias=True)
            (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
      )
      (syntax_encoder): SyntaxEnhancedSyntaxGuidedTransformerEncoder(
        (dropout_module): FairseqDropout()
        (embed_tokens): Embedding(51, 1024, padding_idx=0)
        (layers): ModuleList(
          (0-2): 3 x GCNSyntaxGuidedTransformerEncoderLayer(
            (gcn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
            (dropout_module): FairseqDropout()
            (activation_dropout_module): FairseqDropout()
            (W_out): Linear(in_features=2048, out_features=1024, bias=True)
            (W_in): Linear(in_features=2048, out_features=1024, bias=True)
            (fc): Linear(in_features=1024, out_features=1024, bias=True)
            (fc1): Linear(in_features=1024, out_features=4096, bias=True)
            (fc2): Linear(in_features=4096, out_features=1024, bias=True)
            (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
      )
    )
    (decoder): SyntaxEnhancedTransformerDecoder(
      (dropout_module): FairseqDropout()
      (embed_tokens): Embedding(21132, 1024, padding_idx=1)
      (embed_positions): LearnedPositionalEmbedding(514, 1024, padding_idx=1)
      (layernorm_embedding): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      (layers): ModuleList(
        (0-11): 12 x TransformerDecoderLayer(
          (dropout_module): FairseqDropout()
          (self_attn): MultiheadAttention(
            (dropout_module): FairseqDropout()
            (k_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (v_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (q_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
          )
          (activation_dropout_module): FairseqDropout()
          (self_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          (encoder_attn): MultiheadAttention(
            (dropout_module): FairseqDropout()
            (k_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (v_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (q_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
          )
          (encoder_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          (fc1): Linear(in_features=1024, out_features=4096, bias=True)
          (fc2): Linear(in_features=4096, out_features=1024, bias=True)
          (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        )
      )
      (output_projection): Linear(in_features=1024, out_features=21132, bias=False)
    )
    (classification_heads): ModuleDict()
  )
  (criterion): LabelSmoothedCrossEntropyCriterion()
)
Thu 03 Oct 2024 23:21:36 INFO start training...
Thu 03 Oct 2024 23:21:37 INFO | supervised_trainer |NOTE: overflow detected, setting loss scale to: 64.0
Thu 03 Oct 2024 23:21:37 INFO | supervised_trainer |NOTE: overflow detected, setting loss scale to: 32.0
Thu 03 Oct 2024 23:21:38 INFO | supervised_trainer |NOTE: overflow detected, setting loss scale to: 16.0
Thu 03 Oct 2024 23:21:51 INFO epoch [  1] train time 0h 0m 14s |  loss |[6104.251]
Thu 03 Oct 2024 23:22:16 INFO epoch [  2] train time 0h 0m 25s |  loss |[5238.903]
Thu 03 Oct 2024 23:22:41 INFO epoch [  3] train time 0h 0m 24s |  loss |[5077.738]
Thu 03 Oct 2024 23:23:06 INFO epoch [  4] train time 0h 0m 24s |  loss |[4990.792]
Thu 03 Oct 2024 23:23:29 INFO | supervised_trainer |NOTE: overflow detected, setting loss scale to: 8.0
Thu 03 Oct 2024 23:23:31 INFO epoch [  5] train time 0h 0m 24s |  loss |[4937.922]
Thu 03 Oct 2024 23:31:23 INFO random_seed=2024
use_gpu=True
learning_rate=6e-06
train_batch_size=32
test_batch_size=1
epoch_nums=200
test_step=10
display_train_step=1
gpu_id=5
training_resume=False
load_best_config=False
supervising_mode=fully_supervised
validset_divide=True
test_only=False
shuffle=True
model_config_file=gectoolkit/properties/model/SynGEC.json
best_config_file=gectoolkit/properties/best_config/SynGEC_Visual_OCR.json
dataset_config_file=gectoolkit/properties/dataset/Visual_OCR.json
dataset_dir=dataset/Visual_OCR
checkpoint_file=checkpoint/SynGEC-Visual_OCR.pth
log_file=log/SynGEC-Visual_OCR.log
output_dir=result/SynGEC-Visual_OCR
checkpoint_dir=checkpoint/SynGEC-Visual_OCR
min_word_keep=5
min_generate_keep=5
language=zh
fp16_init_scale=128
distributed_port=-1
decoder_embed_path=None
quant_noise_pq_block_size=8
best_checkpoint_metric=loss
cross_self_attention=False
validate_interval=1
tie_adaptive_weights=False
bpe=None
decoder_normalize_before=False
cpu=False
optimizer_overrides={}
quant_noise_pq=0
lr_scheduler=polynomial_decay
no_save_optimizer_state=False
train_subset=train
no_cross_attention=False
distributed_world_size=1
decoder_layerdrop=0
skip_invalid_size_inputs_valid_test=True
lr=[0.0005]
slowmo_momentum=None
log_interval=100
user_dir=./gectoolkit/model/SynGEC/src/src_syngec/syngec_model
min_loss_scale=0.0001
dual_aggregation_freeze=True
decoder_output_dim=1024
curriculum=0
scoring=bleu
optimizer=adam
adam_betas=(0.9,0.999)
share_decoder_input_output_embed=True
fp16_no_flatten_grads=False
distributed_backend=nccl
adaptive_input=False
dpd_suffix=['dpd']
attention_dropout=0.0
fp16=True
pipeline_checkpoint=never
fix_batches_to_gpus=False
fp16_scale_tolerance=0.0
valid_subset=valid
gen_subset=test
no_last_checkpoints=False
decoder_attention_heads=16
distributed_wrapper=DDP
activation_dropout=0.0
log_format=tqdm
decoder_embed_dim=1024
dual_aggregation_beta=0.5
disable_validation=False
quant_noise_scalar=0
use_bmuf=False
gat_encoder_layers=3
arch=syntax_enhanced_bart_large
eval_bleu_print_samples=False
no_scale_embedding=True
zero_sharding=none
pipeline_decoder_devices=None
save_interval_updates=0
localsgd_frequency=3
ignore_prefix_size=0
eval_bleu_args=None
encoder_layerdrop=0
syntax_type=['dep']
distributed_no_spawn=False
left_pad_source=True
decoder_layers=12
adaptive_softmax_cutoff=None
upsample_primary=1
ddp_backend=c10d
validate_after_updates=0
power=1.0
data_buffer_size=10
memory_efficient_bf16=False
num_batch_buckets=0
share_all_embeddings=True
alpha=1.0
gated_sum=False
distributed_init_method=None
report_accuracy=False
end_learning_rate=0.0
batch_size_valid=None
pipeline_devices=None
left_pad_target=False
source_word_dropout_probs=False
bf16=False
swm_suffix=swm
encoder_embed_dim=1024
force_anneal=None
no_epoch_checkpoints=False
syntax_encoder=GCN
encoder_ffn_embed_dim=4096
label_smoothing=0.1
num_shards=1
find_unused_parameters=True
no_progress_bar=False
load_alignments=False
use_old_adam=False
eval_bleu_detok_args=None
tensorboard_logdir=None
slowmo_algorithm=LocalSGD
fast_stat_sync=False
layernorm_embedding=True
encoder_layers_to_keep=None
eval_bleu_remove_bpe=None
scale_syntax_encoder_lr=None
eval_bleu=False
fp16_scale_window=None
pipeline_encoder_balance=None
pipeline_encoder_devices=None
relu_dropout=0.0
threshold_loss_scale=None
activation_fn=gelu
task=syntax-enhanced-translation
target_lang=tgt
bart_model_file_from_transformers=None
all_gather_list_size=16384
stop_time_hours=0
validate_interval_updates=0
save_interval=1
conll_suffix=['conll']
empty_cache_freq=0
encoder_learned_pos=True
tpu=False
nprocs_per_node=1
keep_last_epochs=10
device_id=0
source_lang_with_nt=src_nt
use_dpd=False
pipeline_chunks=0
cross_syntax_fuse=False
keep_interval_updates=-1
encoder_embed_path=None
adam_eps=1e-08
model_parallel_size=1
sentence_avg=False
encoder_layers=12
decoder_ffn_embed_dim=4096
dataset_impl=None
criterion=label_smoothed_cross_entropy
fixed_validation_seed=None
profile=False
distributed_rank=0
source_lang=src
eval_tokenized_bleu=False
source_word_dropout=0.2
adaptive_softmax_dropout=0
syntax_model_file=None
checkpoint_suffix=
required_seq_len_multiple=1
no_save=False
use_syntax=True
probs_suffix=['probs']
decoder_learned_pos=True
decoder_input_dim=1024
memory_efficient_fp16=False
decoder_layers_to_keep=None
gat_attention_heads=4
bucket_cap_mb=25
checkpoint_shard_count=1
pipeline_model_parallel=False
encoder_normalize_before=False
keep_best_checkpoints=-1
no_token_positional_embeddings=False
pooler_activation_fn=tanh
shard_id=0
only_dsa=False
max_update=0
encoder_attention_heads=16
freeze_bart_parameters=True
tokenizer=None
total_num_update=1000000
pipeline_decoder_balance=None
quantization_config_path=None
broadcast_buffers=False
batch_size=None
maximize_best_checkpoint_metric=False
pooler_dropout=0.0
warmup_updates=2000
min_lr=-1.0
only_gnn=True
eval_bleu_detok=space
no_seed_provided=False
truncate_source=False
pipeline_balance=None
model=SynGEC
dataset=Visual_OCR
augment=none
device=cuda
map_location=cuda
gpu_nums=1


Thu 03 Oct 2024 23:31:23 INFO [src] dictionary: 21132 types
Thu 03 Oct 2024 23:31:23 INFO [tgt] dictionary: 21132 types
Thu 03 Oct 2024 23:31:23 INFO [syntax label0] dictionary: 51 types
Thu 03 Oct 2024 23:31:23 INFO [src] dictionary: 21132 types
Thu 03 Oct 2024 23:31:23 INFO [tgt] dictionary: 21132 types
Thu 03 Oct 2024 23:31:23 INFO [syntax label0] dictionary: 51 types
Thu 03 Oct 2024 23:31:23 INFO loaded 245 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_with_syntax_bart/bin/valid.src-tgt.src
Thu 03 Oct 2024 23:31:23 INFO loaded 245 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_with_syntax_bart/bin/valid.src-tgt.tgt
Thu 03 Oct 2024 23:31:23 INFO ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_with_syntax_bart/bin valid src-tgt 245 examples
Thu 03 Oct 2024 23:31:23 INFO loaded 245 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_with_syntax_bart/bin/valid.conll.src-tgt.src
Thu 03 Oct 2024 23:31:23 INFO loaded 245 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_with_syntax_bart/bin/valid.dpd.src-tgt.src
Thu 03 Oct 2024 23:31:23 INFO loaded 245 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_with_syntax_bart/bin/valid.probs.src-tgt.src
Thu 03 Oct 2024 23:31:23 INFO success! syntax types: 1, source conll lines: 245
Thu 03 Oct 2024 23:31:23 INFO loaded 1960 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_with_syntax_bart/bin/train.src-tgt.src
Thu 03 Oct 2024 23:31:23 INFO loaded 1960 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_with_syntax_bart/bin/train.src-tgt.tgt
Thu 03 Oct 2024 23:31:23 INFO ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_with_syntax_bart/bin train src-tgt 1960 examples
Thu 03 Oct 2024 23:31:23 INFO loaded 1960 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_with_syntax_bart/bin/train.conll.src-tgt.src
Thu 03 Oct 2024 23:31:23 INFO loaded 1960 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_with_syntax_bart/bin/train.dpd.src-tgt.src
Thu 03 Oct 2024 23:31:23 INFO loaded 1960 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_with_syntax_bart/bin/train.probs.src-tgt.src
Thu 03 Oct 2024 23:31:23 INFO success! syntax types: 1, source conll lines: 1960
Thu 03 Oct 2024 23:31:23 INFO loaded 246 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_test_with_syntax_bart/bin/test.conll.src-tgt.src
Thu 03 Oct 2024 23:31:23 INFO loaded 246 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_test_with_syntax_bart/bin/test.dpd.src-tgt.src
Thu 03 Oct 2024 23:31:23 INFO loaded 246 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_test_with_syntax_bart/bin/test.probs.src-tgt.src
Thu 03 Oct 2024 23:31:23 INFO success! syntax types: 1, source conll lines: 246
Thu 03 Oct 2024 23:31:33 INFO detected shared parameter: encoder.sentence_encoder.embed_tokens.weight <- decoder.embed_tokens.weight
Thu 03 Oct 2024 23:31:33 INFO detected shared parameter: encoder.sentence_encoder.embed_tokens.weight <- decoder.output_projection.weight
Thu 03 Oct 2024 23:31:33 INFO ***********************CUDA enviroments for all 1 workers***********************
Thu 03 Oct 2024 23:31:33 INFO rank   0: capabilities =  8.0  ; total memory = 79.151 GB ; name = NVIDIA A800 80GB PCIe                   
Thu 03 Oct 2024 23:31:33 INFO ***********************CUDA enviroments for all 1 workers***********************
Thu 03 Oct 2024 23:31:36 INFO loaded checkpoint ./gectoolkit/properties/model/SynGEC/preprocess/gopar/chinese_Visual_OCR_bart_baseline/checkpoint_best.pt (epoch 21 @ 1414 updates)
Thu 03 Oct 2024 23:31:36 INFO loading train data for epoch 21
Thu 03 Oct 2024 23:31:36 INFO loaded 1960 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_with_syntax_bart/bin/train.src-tgt.src
Thu 03 Oct 2024 23:31:36 INFO loaded 1960 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_with_syntax_bart/bin/train.src-tgt.tgt
Thu 03 Oct 2024 23:31:36 INFO ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_with_syntax_bart/bin train src-tgt 1960 examples
Thu 03 Oct 2024 23:31:36 INFO loaded 1960 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_with_syntax_bart/bin/train.conll.src-tgt.src
Thu 03 Oct 2024 23:31:36 INFO loaded 1960 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_with_syntax_bart/bin/train.dpd.src-tgt.src
Thu 03 Oct 2024 23:31:36 INFO loaded 1960 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_with_syntax_bart/bin/train.probs.src-tgt.src
Thu 03 Oct 2024 23:31:36 INFO success! syntax types: 1, source conll lines: 1960
Thu 03 Oct 2024 23:31:38 INFO SynGEC(
  (model): SyntaxEnhancedBARTModel(
    (encoder): SyntaxEnhancedTransformerEncoder(
      (sentence_encoder): SyntaxEnhancedSentenceTransformerEncoder(
        (dropout_module): FairseqDropout()
        (embed_tokens): Embedding(21132, 1024, padding_idx=1)
        (embed_positions): LearnedPositionalEmbedding(514, 1024, padding_idx=1)
        (layernorm_embedding): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        (layers): ModuleList(
          (0-11): 12 x DSATransformerEncoderLayer(
            (self_attn): DSAMultiheadAttention(
              (dropout_module): FairseqDropout()
              (k_proj): Linear(in_features=1024, out_features=1024, bias=True)
              (v_proj): Linear(in_features=1024, out_features=1024, bias=True)
              (q_proj): Linear(in_features=1024, out_features=1024, bias=True)
              (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
            )
            (self_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
            (dropout_module): FairseqDropout()
            (activation_dropout_module): FairseqDropout()
            (fc1): Linear(in_features=1024, out_features=4096, bias=True)
            (fc2): Linear(in_features=4096, out_features=1024, bias=True)
            (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
      )
      (syntax_encoder): SyntaxEnhancedSyntaxGuidedTransformerEncoder(
        (dropout_module): FairseqDropout()
        (embed_tokens): Embedding(51, 1024, padding_idx=0)
        (layers): ModuleList(
          (0-2): 3 x GCNSyntaxGuidedTransformerEncoderLayer(
            (gcn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
            (dropout_module): FairseqDropout()
            (activation_dropout_module): FairseqDropout()
            (W_out): Linear(in_features=2048, out_features=1024, bias=True)
            (W_in): Linear(in_features=2048, out_features=1024, bias=True)
            (fc): Linear(in_features=1024, out_features=1024, bias=True)
            (fc1): Linear(in_features=1024, out_features=4096, bias=True)
            (fc2): Linear(in_features=4096, out_features=1024, bias=True)
            (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
      )
    )
    (decoder): SyntaxEnhancedTransformerDecoder(
      (dropout_module): FairseqDropout()
      (embed_tokens): Embedding(21132, 1024, padding_idx=1)
      (embed_positions): LearnedPositionalEmbedding(514, 1024, padding_idx=1)
      (layernorm_embedding): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      (layers): ModuleList(
        (0-11): 12 x TransformerDecoderLayer(
          (dropout_module): FairseqDropout()
          (self_attn): MultiheadAttention(
            (dropout_module): FairseqDropout()
            (k_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (v_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (q_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
          )
          (activation_dropout_module): FairseqDropout()
          (self_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          (encoder_attn): MultiheadAttention(
            (dropout_module): FairseqDropout()
            (k_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (v_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (q_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
          )
          (encoder_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          (fc1): Linear(in_features=1024, out_features=4096, bias=True)
          (fc2): Linear(in_features=4096, out_features=1024, bias=True)
          (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        )
      )
      (output_projection): Linear(in_features=1024, out_features=21132, bias=False)
    )
    (classification_heads): ModuleDict()
  )
  (criterion): LabelSmoothedCrossEntropyCriterion()
)
Thu 03 Oct 2024 23:31:38 INFO start training...
Thu 03 Oct 2024 23:31:39 INFO | supervised_trainer |NOTE: overflow detected, setting loss scale to: 64.0
Thu 03 Oct 2024 23:31:41 INFO | supervised_trainer |NOTE: overflow detected, setting loss scale to: 32.0
Thu 03 Oct 2024 23:31:43 INFO | supervised_trainer |NOTE: overflow detected, setting loss scale to: 16.0
Thu 03 Oct 2024 23:32:03 INFO epoch [  1] train time 0h 0m 25s |  loss |[6104.251]
Thu 03 Oct 2024 23:32:29 INFO epoch [  2] train time 0h 0m 25s |  loss |[5238.903]
Thu 03 Oct 2024 23:32:54 INFO epoch [  3] train time 0h 0m 25s |  loss |[5077.738]
Thu 03 Oct 2024 23:33:19 INFO epoch [  4] train time 0h 0m 25s |  loss |[4990.792]
Thu 03 Oct 2024 23:33:43 INFO | supervised_trainer |NOTE: overflow detected, setting loss scale to: 8.0
Thu 03 Oct 2024 23:33:44 INFO epoch [  5] train time 0h 0m 25s |  loss |[4937.922]
Thu 03 Oct 2024 23:33:50 INFO | supervised_trainer |NOTE: overflow detected, setting loss scale to: 4.0
Thu 03 Oct 2024 23:34:10 INFO epoch [  6] train time 0h 0m 25s |  loss |[4019.153]
Thu 03 Oct 2024 23:34:34 INFO epoch [  7] train time 0h 0m 24s |  loss |[2174.097]
Thu 03 Oct 2024 23:34:47 INFO epoch [  8] train time 0h 0m 13s |  loss |[1742.607]
Thu 03 Oct 2024 23:35:12 INFO epoch [  9] train time 0h 0m 25s |  loss |[1616.364]
Thu 03 Oct 2024 23:35:37 INFO epoch [ 10] train time 0h 0m 25s |  loss |[1539.632]
Thu 03 Oct 2024 23:37:12 INFO ---------- valid total [245] | valid precision [0.244] | valid recall [0.254] | valid f0.5 [0.221] | valid time 0h 1m 34s
Thu 03 Oct 2024 23:38:42 INFO ---------- test total [246] | test precision [0.231] | test recall [0.242] | test f0.5 [0.204] | test time 0h 1m 30s
Thu 03 Oct 2024 23:39:08 INFO epoch [ 11] train time 0h 0m 24s |  loss |[1497.651]
Thu 03 Oct 2024 23:39:33 INFO epoch [ 12] train time 0h 0m 24s |  loss |[1461.160]
Thu 03 Oct 2024 23:39:58 INFO epoch [ 13] train time 0h 0m 25s |  loss |[1442.420]
Thu 03 Oct 2024 23:40:23 INFO epoch [ 14] train time 0h 0m 25s |  loss |[1425.365]
Thu 03 Oct 2024 23:40:48 INFO epoch [ 15] train time 0h 0m 24s |  loss |[1403.589]
Thu 03 Oct 2024 23:41:14 INFO epoch [ 16] train time 0h 0m 25s |  loss |[1399.117]
Thu 03 Oct 2024 23:41:39 INFO epoch [ 17] train time 0h 0m 25s |  loss |[1377.045]
Thu 03 Oct 2024 23:41:57 INFO epoch [ 18] train time 0h 0m 18s |  loss |[1371.659]
Thu 03 Oct 2024 23:42:17 INFO epoch [ 19] train time 0h 0m 20s |  loss |[1368.681]
Thu 03 Oct 2024 23:42:42 INFO epoch [ 20] train time 0h 0m 25s |  loss |[1359.160]
Thu 03 Oct 2024 23:44:18 INFO ---------- valid total [245] | valid precision [0.252] | valid recall [0.267] | valid f0.5 [0.227] | valid time 0h 1m 35s
Thu 03 Oct 2024 23:45:52 INFO ---------- test total [246] | test precision [0.262] | test recall [0.272] | test f0.5 [0.228] | test time 0h 1m 33s
Thu 03 Oct 2024 23:46:18 INFO epoch [ 21] train time 0h 0m 24s |  loss |[1346.882]
Thu 03 Oct 2024 23:46:43 INFO epoch [ 22] train time 0h 0m 24s |  loss |[1349.380]
Thu 03 Oct 2024 23:47:08 INFO epoch [ 23] train time 0h 0m 24s |  loss |[1343.582]
Thu 03 Oct 2024 23:47:33 INFO epoch [ 24] train time 0h 0m 24s |  loss |[1335.668]
Thu 03 Oct 2024 23:47:58 INFO epoch [ 25] train time 0h 0m 24s |  loss |[1339.532]
Thu 03 Oct 2024 23:48:21 INFO epoch [ 26] train time 0h 0m 22s |  loss |[1329.792]
Thu 03 Oct 2024 23:48:36 INFO epoch [ 27] train time 0h 0m 15s |  loss |[1328.063]
Thu 03 Oct 2024 23:49:01 INFO epoch [ 28] train time 0h 0m 25s |  loss |[1322.586]
Thu 03 Oct 2024 23:49:27 INFO epoch [ 29] train time 0h 0m 25s |  loss |[1320.493]
Thu 03 Oct 2024 23:49:52 INFO epoch [ 30] train time 0h 0m 25s |  loss |[1314.114]
Thu 03 Oct 2024 23:51:27 INFO ---------- valid total [245] | valid precision [0.268] | valid recall [0.277] | valid f0.5 [0.241] | valid time 0h 1m 35s
Thu 03 Oct 2024 23:53:01 INFO ---------- test total [246] | test precision [0.248] | test recall [0.256] | test f0.5 [0.221] | test time 0h 1m 33s
Thu 03 Oct 2024 23:53:28 INFO epoch [ 31] train time 0h 0m 24s |  loss |[1312.867]
Thu 03 Oct 2024 23:53:53 INFO epoch [ 32] train time 0h 0m 24s |  loss |[1319.513]
Thu 03 Oct 2024 23:54:18 INFO epoch [ 33] train time 0h 0m 24s |  loss |[1311.998]
Thu 03 Oct 2024 23:54:43 INFO epoch [ 34] train time 0h 0m 24s |  loss |[1306.310]
Thu 03 Oct 2024 23:54:57 INFO epoch [ 35] train time 0h 0m 13s |  loss |[1306.520]
Thu 03 Oct 2024 23:55:20 INFO epoch [ 36] train time 0h 0m 23s |  loss |[1300.773]
Thu 03 Oct 2024 23:55:45 INFO epoch [ 37] train time 0h 0m 25s |  loss |[1299.207]
Thu 03 Oct 2024 23:56:10 INFO epoch [ 38] train time 0h 0m 25s |  loss |[1301.723]
Thu 03 Oct 2024 23:56:36 INFO epoch [ 39] train time 0h 0m 25s |  loss |[1297.318]
Thu 03 Oct 2024 23:57:01 INFO epoch [ 40] train time 0h 0m 25s |  loss |[1294.465]
Thu 03 Oct 2024 23:58:36 INFO ---------- valid total [245] | valid precision [0.264] | valid recall [0.278] | valid f0.5 [0.241] | valid time 0h 1m 35s
Fri 04 Oct 2024 00:00:10 INFO ---------- test total [246] | test precision [0.261] | test recall [0.265] | test f0.5 [0.230] | test time 0h 1m 33s
Fri 04 Oct 2024 00:00:37 INFO epoch [ 41] train time 0h 0m 25s |  loss |[1293.021]
Fri 04 Oct 2024 00:01:02 INFO epoch [ 42] train time 0h 0m 24s |  loss |[1292.665]
Fri 04 Oct 2024 00:01:25 INFO epoch [ 43] train time 0h 0m 23s |  loss |[1289.279]
Fri 04 Oct 2024 00:01:46 INFO epoch [ 44] train time 0h 0m 21s |  loss |[1291.508]
Fri 04 Oct 2024 00:01:59 INFO epoch [ 45] train time 0h 0m 12s |  loss |[1286.290]
Fri 04 Oct 2024 00:02:23 INFO epoch [ 46] train time 0h 0m 24s |  loss |[1286.648]
Fri 04 Oct 2024 00:02:48 INFO epoch [ 47] train time 0h 0m 25s |  loss |[1284.807]
Fri 04 Oct 2024 00:03:14 INFO epoch [ 48] train time 0h 0m 25s |  loss |[1288.475]
Fri 04 Oct 2024 00:03:39 INFO epoch [ 49] train time 0h 0m 25s |  loss |[1284.411]
Fri 04 Oct 2024 00:04:05 INFO epoch [ 50] train time 0h 0m 25s |  loss |[1278.222]
Fri 04 Oct 2024 00:05:40 INFO ---------- valid total [245] | valid precision [0.270] | valid recall [0.291] | valid f0.5 [0.248] | valid time 0h 1m 35s
Fri 04 Oct 2024 00:07:14 INFO ---------- test total [246] | test precision [0.271] | test recall [0.291] | test f0.5 [0.245] | test time 0h 1m 33s
Fri 04 Oct 2024 00:07:41 INFO epoch [ 51] train time 0h 0m 24s |  loss |[1276.689]
Fri 04 Oct 2024 00:07:57 INFO | supervised_trainer |NOTE: overflow detected, setting loss scale to: 2.0
Fri 04 Oct 2024 00:08:06 INFO epoch [ 52] train time 0h 0m 24s |  loss |[1271.708]
Fri 04 Oct 2024 00:08:24 INFO epoch [ 53] train time 0h 0m 18s |  loss |[1273.471]
Fri 04 Oct 2024 00:08:44 INFO epoch [ 54] train time 0h 0m 19s |  loss |[1276.270]
Fri 04 Oct 2024 00:09:09 INFO epoch [ 55] train time 0h 0m 24s |  loss |[1280.759]
Fri 04 Oct 2024 00:09:34 INFO epoch [ 56] train time 0h 0m 25s |  loss |[1271.226]
Fri 04 Oct 2024 00:09:59 INFO epoch [ 57] train time 0h 0m 25s |  loss |[1268.344]
Fri 04 Oct 2024 00:10:24 INFO epoch [ 58] train time 0h 0m 25s |  loss |[1270.382]
Fri 04 Oct 2024 00:10:50 INFO epoch [ 59] train time 0h 0m 25s |  loss |[1272.792]
Fri 04 Oct 2024 00:11:15 INFO epoch [ 60] train time 0h 0m 25s |  loss |[1267.899]
Fri 04 Oct 2024 00:12:51 INFO ---------- valid total [245] | valid precision [0.267] | valid recall [0.281] | valid f0.5 [0.245] | valid time 0h 1m 36s
Fri 04 Oct 2024 00:13:12 INFO random_seed=2024
use_gpu=True
learning_rate=6e-06
train_batch_size=32
test_batch_size=1
epoch_nums=200
test_step=10
display_train_step=1
gpu_id=5
training_resume=False
load_best_config=False
supervising_mode=fully_supervised
validset_divide=True
test_only=False
shuffle=True
model_config_file=gectoolkit/properties/model/SynGEC.json
best_config_file=gectoolkit/properties/best_config/SynGEC_Visual_OCR.json
dataset_config_file=gectoolkit/properties/dataset/Visual_OCR.json
dataset_dir=dataset/Visual_OCR
checkpoint_file=checkpoint/SynGEC-Visual_OCR.pth
log_file=log/SynGEC-Visual_OCR.log
output_dir=result/SynGEC-Visual_OCR
checkpoint_dir=checkpoint/SynGEC-Visual_OCR
min_word_keep=5
min_generate_keep=5
language=zh
fp16_init_scale=128
distributed_port=-1
decoder_embed_path=None
quant_noise_pq_block_size=8
best_checkpoint_metric=loss
cross_self_attention=False
validate_interval=1
tie_adaptive_weights=False
bpe=None
decoder_normalize_before=False
cpu=False
optimizer_overrides={}
quant_noise_pq=0
lr_scheduler=polynomial_decay
no_save_optimizer_state=False
train_subset=train
no_cross_attention=False
distributed_world_size=1
decoder_layerdrop=0
skip_invalid_size_inputs_valid_test=True
lr=[0.0005]
slowmo_momentum=None
log_interval=100
user_dir=./gectoolkit/model/SynGEC/src/src_syngec/syngec_model
min_loss_scale=0.0001
dual_aggregation_freeze=True
decoder_output_dim=1024
curriculum=0
scoring=bleu
optimizer=adam
adam_betas=(0.9,0.999)
share_decoder_input_output_embed=True
fp16_no_flatten_grads=False
distributed_backend=nccl
adaptive_input=False
dpd_suffix=['dpd']
attention_dropout=0.0
fp16=True
pipeline_checkpoint=never
fix_batches_to_gpus=False
fp16_scale_tolerance=0.0
valid_subset=valid
gen_subset=test
no_last_checkpoints=False
decoder_attention_heads=16
distributed_wrapper=DDP
activation_dropout=0.0
log_format=tqdm
decoder_embed_dim=1024
dual_aggregation_beta=0.5
disable_validation=False
quant_noise_scalar=0
use_bmuf=False
gat_encoder_layers=3
arch=syntax_enhanced_bart_large
eval_bleu_print_samples=False
no_scale_embedding=True
zero_sharding=none
pipeline_decoder_devices=None
save_interval_updates=0
localsgd_frequency=3
ignore_prefix_size=0
eval_bleu_args=None
encoder_layerdrop=0
syntax_type=['dep']
distributed_no_spawn=False
left_pad_source=True
decoder_layers=12
adaptive_softmax_cutoff=None
upsample_primary=1
ddp_backend=c10d
validate_after_updates=0
power=1.0
data_buffer_size=10
memory_efficient_bf16=False
num_batch_buckets=0
share_all_embeddings=True
alpha=1.0
gated_sum=False
distributed_init_method=None
report_accuracy=False
end_learning_rate=0.0
batch_size_valid=None
pipeline_devices=None
left_pad_target=False
source_word_dropout_probs=False
bf16=False
swm_suffix=swm
encoder_embed_dim=1024
force_anneal=None
no_epoch_checkpoints=False
syntax_encoder=GCN
encoder_ffn_embed_dim=4096
label_smoothing=0.1
num_shards=1
find_unused_parameters=True
no_progress_bar=False
load_alignments=False
use_old_adam=False
eval_bleu_detok_args=None
tensorboard_logdir=None
slowmo_algorithm=LocalSGD
fast_stat_sync=False
layernorm_embedding=True
encoder_layers_to_keep=None
eval_bleu_remove_bpe=None
scale_syntax_encoder_lr=None
eval_bleu=False
fp16_scale_window=None
pipeline_encoder_balance=None
pipeline_encoder_devices=None
relu_dropout=0.0
threshold_loss_scale=None
activation_fn=gelu
task=syntax-enhanced-translation
target_lang=tgt
bart_model_file_from_transformers=None
all_gather_list_size=16384
stop_time_hours=0
validate_interval_updates=0
save_interval=1
conll_suffix=['conll']
empty_cache_freq=0
encoder_learned_pos=True
tpu=False
nprocs_per_node=1
keep_last_epochs=10
device_id=0
source_lang_with_nt=src_nt
use_dpd=False
pipeline_chunks=0
cross_syntax_fuse=False
keep_interval_updates=-1
encoder_embed_path=None
adam_eps=1e-08
model_parallel_size=1
sentence_avg=False
encoder_layers=12
decoder_ffn_embed_dim=4096
dataset_impl=None
criterion=label_smoothed_cross_entropy
fixed_validation_seed=None
profile=False
distributed_rank=0
source_lang=src
eval_tokenized_bleu=False
source_word_dropout=0.2
adaptive_softmax_dropout=0
syntax_model_file=None
checkpoint_suffix=
required_seq_len_multiple=1
no_save=False
use_syntax=True
probs_suffix=['probs']
decoder_learned_pos=True
decoder_input_dim=1024
memory_efficient_fp16=False
decoder_layers_to_keep=None
gat_attention_heads=4
bucket_cap_mb=25
checkpoint_shard_count=1
pipeline_model_parallel=False
encoder_normalize_before=False
keep_best_checkpoints=-1
no_token_positional_embeddings=False
pooler_activation_fn=tanh
shard_id=0
only_dsa=False
max_update=0
encoder_attention_heads=16
freeze_bart_parameters=True
tokenizer=None
total_num_update=1000000
pipeline_decoder_balance=None
quantization_config_path=None
broadcast_buffers=False
batch_size=None
maximize_best_checkpoint_metric=False
pooler_dropout=0.0
warmup_updates=2000
min_lr=-1.0
only_gnn=True
eval_bleu_detok=space
no_seed_provided=False
truncate_source=False
pipeline_balance=None
model=SynGEC
dataset=Visual_OCR
augment=none
method=OCR
correctionmodel=SynGEC
device=cuda
map_location=cuda
gpu_nums=1


Fri 04 Oct 2024 00:13:13 INFO [src] dictionary: 21132 types
Fri 04 Oct 2024 00:13:13 INFO [tgt] dictionary: 21132 types
Fri 04 Oct 2024 00:13:13 INFO [syntax label0] dictionary: 51 types
Fri 04 Oct 2024 00:13:13 INFO [src] dictionary: 21132 types
Fri 04 Oct 2024 00:13:13 INFO [tgt] dictionary: 21132 types
Fri 04 Oct 2024 00:13:13 INFO [syntax label0] dictionary: 51 types
Fri 04 Oct 2024 00:13:13 INFO loaded 245 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_with_syntax_bart/bin/valid.src-tgt.src
Fri 04 Oct 2024 00:13:13 INFO loaded 245 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_with_syntax_bart/bin/valid.src-tgt.tgt
Fri 04 Oct 2024 00:13:13 INFO ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_with_syntax_bart/bin valid src-tgt 245 examples
Fri 04 Oct 2024 00:13:13 INFO loaded 245 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_with_syntax_bart/bin/valid.conll.src-tgt.src
Fri 04 Oct 2024 00:13:13 INFO loaded 245 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_with_syntax_bart/bin/valid.dpd.src-tgt.src
Fri 04 Oct 2024 00:13:13 INFO loaded 245 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_with_syntax_bart/bin/valid.probs.src-tgt.src
Fri 04 Oct 2024 00:13:13 INFO success! syntax types: 1, source conll lines: 245
Fri 04 Oct 2024 00:13:13 INFO loaded 1960 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_with_syntax_bart/bin/train.src-tgt.src
Fri 04 Oct 2024 00:13:13 INFO loaded 1960 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_with_syntax_bart/bin/train.src-tgt.tgt
Fri 04 Oct 2024 00:13:13 INFO ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_with_syntax_bart/bin train src-tgt 1960 examples
Fri 04 Oct 2024 00:13:13 INFO loaded 1960 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_with_syntax_bart/bin/train.conll.src-tgt.src
Fri 04 Oct 2024 00:13:13 INFO loaded 1960 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_with_syntax_bart/bin/train.dpd.src-tgt.src
Fri 04 Oct 2024 00:13:13 INFO loaded 1960 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_with_syntax_bart/bin/train.probs.src-tgt.src
Fri 04 Oct 2024 00:13:13 INFO success! syntax types: 1, source conll lines: 1960
Fri 04 Oct 2024 00:13:13 INFO loaded 246 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_test_with_syntax_bart/bin/test.conll.src-tgt.src
Fri 04 Oct 2024 00:13:13 INFO loaded 246 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_test_with_syntax_bart/bin/test.dpd.src-tgt.src
Fri 04 Oct 2024 00:13:13 INFO loaded 246 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_test_with_syntax_bart/bin/test.probs.src-tgt.src
Fri 04 Oct 2024 00:13:13 INFO success! syntax types: 1, source conll lines: 246
Fri 04 Oct 2024 00:13:21 INFO detected shared parameter: encoder.sentence_encoder.embed_tokens.weight <- decoder.embed_tokens.weight
Fri 04 Oct 2024 00:13:21 INFO detected shared parameter: encoder.sentence_encoder.embed_tokens.weight <- decoder.output_projection.weight
Fri 04 Oct 2024 00:13:21 INFO ***********************CUDA enviroments for all 1 workers***********************
Fri 04 Oct 2024 00:13:21 INFO rank   0: capabilities =  8.0  ; total memory = 79.151 GB ; name = NVIDIA A800 80GB PCIe                   
Fri 04 Oct 2024 00:13:21 INFO ***********************CUDA enviroments for all 1 workers***********************
Fri 04 Oct 2024 00:13:25 INFO loaded checkpoint ./gectoolkit/properties/model/SynGEC/preprocess/gopar/chinese_Visual_OCR_bart_baseline/checkpoint_best.pt (epoch 21 @ 1414 updates)
Fri 04 Oct 2024 00:13:25 INFO loading train data for epoch 21
Fri 04 Oct 2024 00:13:25 INFO loaded 1960 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_with_syntax_bart/bin/train.src-tgt.src
Fri 04 Oct 2024 00:13:25 INFO loaded 1960 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_with_syntax_bart/bin/train.src-tgt.tgt
Fri 04 Oct 2024 00:13:25 INFO ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_with_syntax_bart/bin train src-tgt 1960 examples
Fri 04 Oct 2024 00:13:25 INFO loaded 1960 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_with_syntax_bart/bin/train.conll.src-tgt.src
Fri 04 Oct 2024 00:13:25 INFO loaded 1960 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_with_syntax_bart/bin/train.dpd.src-tgt.src
Fri 04 Oct 2024 00:13:25 INFO loaded 1960 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_with_syntax_bart/bin/train.probs.src-tgt.src
Fri 04 Oct 2024 00:13:25 INFO success! syntax types: 1, source conll lines: 1960
Fri 04 Oct 2024 00:13:26 INFO SynGEC(
  (model): SyntaxEnhancedBARTModel(
    (encoder): SyntaxEnhancedTransformerEncoder(
      (sentence_encoder): SyntaxEnhancedSentenceTransformerEncoder(
        (dropout_module): FairseqDropout()
        (embed_tokens): Embedding(21132, 1024, padding_idx=1)
        (embed_positions): LearnedPositionalEmbedding(514, 1024, padding_idx=1)
        (layernorm_embedding): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        (layers): ModuleList(
          (0-11): 12 x DSATransformerEncoderLayer(
            (self_attn): DSAMultiheadAttention(
              (dropout_module): FairseqDropout()
              (k_proj): Linear(in_features=1024, out_features=1024, bias=True)
              (v_proj): Linear(in_features=1024, out_features=1024, bias=True)
              (q_proj): Linear(in_features=1024, out_features=1024, bias=True)
              (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
            )
            (self_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
            (dropout_module): FairseqDropout()
            (activation_dropout_module): FairseqDropout()
            (fc1): Linear(in_features=1024, out_features=4096, bias=True)
            (fc2): Linear(in_features=4096, out_features=1024, bias=True)
            (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
      )
      (syntax_encoder): SyntaxEnhancedSyntaxGuidedTransformerEncoder(
        (dropout_module): FairseqDropout()
        (embed_tokens): Embedding(51, 1024, padding_idx=0)
        (layers): ModuleList(
          (0-2): 3 x GCNSyntaxGuidedTransformerEncoderLayer(
            (gcn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
            (dropout_module): FairseqDropout()
            (activation_dropout_module): FairseqDropout()
            (W_out): Linear(in_features=2048, out_features=1024, bias=True)
            (W_in): Linear(in_features=2048, out_features=1024, bias=True)
            (fc): Linear(in_features=1024, out_features=1024, bias=True)
            (fc1): Linear(in_features=1024, out_features=4096, bias=True)
            (fc2): Linear(in_features=4096, out_features=1024, bias=True)
            (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
      )
    )
    (decoder): SyntaxEnhancedTransformerDecoder(
      (dropout_module): FairseqDropout()
      (embed_tokens): Embedding(21132, 1024, padding_idx=1)
      (embed_positions): LearnedPositionalEmbedding(514, 1024, padding_idx=1)
      (layernorm_embedding): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      (layers): ModuleList(
        (0-11): 12 x TransformerDecoderLayer(
          (dropout_module): FairseqDropout()
          (self_attn): MultiheadAttention(
            (dropout_module): FairseqDropout()
            (k_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (v_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (q_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
          )
          (activation_dropout_module): FairseqDropout()
          (self_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          (encoder_attn): MultiheadAttention(
            (dropout_module): FairseqDropout()
            (k_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (v_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (q_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
          )
          (encoder_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          (fc1): Linear(in_features=1024, out_features=4096, bias=True)
          (fc2): Linear(in_features=4096, out_features=1024, bias=True)
          (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        )
      )
      (output_projection): Linear(in_features=1024, out_features=21132, bias=False)
    )
    (classification_heads): ModuleDict()
  )
  (criterion): LabelSmoothedCrossEntropyCriterion()
)
Fri 04 Oct 2024 00:13:26 INFO start training...
Fri 04 Oct 2024 00:13:27 INFO | supervised_trainer |NOTE: overflow detected, setting loss scale to: 64.0
Fri 04 Oct 2024 00:13:28 INFO | supervised_trainer |NOTE: overflow detected, setting loss scale to: 32.0
Fri 04 Oct 2024 00:13:29 INFO | supervised_trainer |NOTE: overflow detected, setting loss scale to: 16.0
Fri 04 Oct 2024 00:13:38 INFO epoch [  1] train time 0h 0m 12s |  loss |[6104.251]
Fri 04 Oct 2024 00:13:50 INFO epoch [  2] train time 0h 0m 11s |  loss |[5238.903]
Fri 04 Oct 2024 00:14:01 INFO epoch [  3] train time 0h 0m 11s |  loss |[5077.738]
Fri 04 Oct 2024 00:14:13 INFO epoch [  4] train time 0h 0m 11s |  loss |[4990.792]
Fri 04 Oct 2024 00:14:24 INFO | supervised_trainer |NOTE: overflow detected, setting loss scale to: 8.0
Fri 04 Oct 2024 00:14:24 INFO epoch [  5] train time 0h 0m 11s |  loss |[4937.922]
Fri 04 Oct 2024 00:14:26 INFO ---------- test total [246] | test precision [0.267] | test recall [0.278] | test f0.5 [0.233] | test time 0h 1m 34s
Fri 04 Oct 2024 00:14:27 INFO | supervised_trainer |NOTE: overflow detected, setting loss scale to: 4.0
Fri 04 Oct 2024 00:14:36 INFO epoch [  6] train time 0h 0m 11s |  loss |[4019.153]
Fri 04 Oct 2024 00:14:47 INFO epoch [  7] train time 0h 0m 11s |  loss |[2174.097]
Fri 04 Oct 2024 00:14:50 INFO epoch [ 61] train time 0h 0m 24s |  loss |[1265.231]
Fri 04 Oct 2024 00:14:59 INFO epoch [  8] train time 0h 0m 11s |  loss |[1742.607]
Fri 04 Oct 2024 00:15:03 INFO epoch [ 62] train time 0h 0m 13s |  loss |[1267.395]
Fri 04 Oct 2024 00:15:10 INFO epoch [  9] train time 0h 0m 11s |  loss |[1616.364]
Fri 04 Oct 2024 00:15:21 INFO epoch [ 10] train time 0h 0m 11s |  loss |[1539.632]
Fri 04 Oct 2024 00:15:28 INFO epoch [ 63] train time 0h 0m 25s |  loss |[1263.262]
Fri 04 Oct 2024 00:15:54 INFO epoch [ 64] train time 0h 0m 25s |  loss |[1260.258]
Fri 04 Oct 2024 00:16:19 INFO epoch [ 65] train time 0h 0m 25s |  loss |[1261.791]
Fri 04 Oct 2024 00:16:37 INFO ---------- valid total [245] | valid precision [0.244] | valid recall [0.254] | valid f0.5 [0.221] | valid time 0h 1m 15s
Fri 04 Oct 2024 00:16:45 INFO epoch [ 66] train time 0h 0m 25s |  loss |[1261.948]
Fri 04 Oct 2024 00:17:10 INFO epoch [ 67] train time 0h 0m 25s |  loss |[1262.617]
Fri 04 Oct 2024 00:17:36 INFO epoch [ 68] train time 0h 0m 25s |  loss |[1254.598]
Fri 04 Oct 2024 00:17:53 INFO ---------- test total [246] | test precision [0.231] | test recall [0.242] | test f0.5 [0.204] | test time 0h 1m 15s
Fri 04 Oct 2024 00:18:01 INFO epoch [ 69] train time 0h 0m 25s |  loss |[1260.581]
Fri 04 Oct 2024 00:18:06 INFO epoch [ 11] train time 0h 0m 11s |  loss |[1497.651]
Fri 04 Oct 2024 00:18:18 INFO epoch [ 12] train time 0h 0m 11s |  loss |[1461.160]
Fri 04 Oct 2024 00:18:20 INFO epoch [ 70] train time 0h 0m 18s |  loss |[1257.957]
Fri 04 Oct 2024 00:18:29 INFO epoch [ 13] train time 0h 0m 11s |  loss |[1442.420]
Fri 04 Oct 2024 00:18:41 INFO epoch [ 14] train time 0h 0m 11s |  loss |[1425.365]
Fri 04 Oct 2024 00:18:52 INFO epoch [ 15] train time 0h 0m 11s |  loss |[1403.589]
Fri 04 Oct 2024 00:19:03 INFO epoch [ 16] train time 0h 0m 11s |  loss |[1399.117]
Fri 04 Oct 2024 00:19:15 INFO epoch [ 17] train time 0h 0m 11s |  loss |[1377.045]
Fri 04 Oct 2024 00:19:26 INFO epoch [ 18] train time 0h 0m 11s |  loss |[1371.659]
Fri 04 Oct 2024 00:19:38 INFO epoch [ 19] train time 0h 0m 11s |  loss |[1368.681]
Fri 04 Oct 2024 00:19:49 INFO epoch [ 20] train time 0h 0m 11s |  loss |[1359.160]
Fri 04 Oct 2024 00:19:56 INFO ---------- valid total [245] | valid precision [0.257] | valid recall [0.265] | valid f0.5 [0.230] | valid time 0h 1m 36s
Fri 04 Oct 2024 00:21:06 INFO ---------- valid total [245] | valid precision [0.253] | valid recall [0.237] | valid f0.5 [0.198] | valid time 0h 1m 16s
Fri 04 Oct 2024 00:21:31 INFO ---------- test total [246] | test precision [0.223] | test recall [0.186] | test f0.5 [0.153] | test time 0h 1m 34s
Fri 04 Oct 2024 00:21:52 INFO epoch [ 71] train time 0h 0m 20s |  loss |[1267.677]
Fri 04 Oct 2024 00:22:17 INFO epoch [ 72] train time 0h 0m 25s |  loss |[1257.284]
Fri 04 Oct 2024 00:22:23 INFO ---------- test total [246] | test precision [0.253] | test recall [0.260] | test f0.5 [0.212] | test time 0h 1m 16s
Fri 04 Oct 2024 00:22:34 INFO epoch [ 21] train time 0h 0m 11s |  loss |[1346.882]
Fri 04 Oct 2024 00:22:42 INFO epoch [ 73] train time 0h 0m 24s |  loss |[1253.292]
Fri 04 Oct 2024 00:22:46 INFO epoch [ 22] train time 0h 0m 11s |  loss |[1349.380]
Fri 04 Oct 2024 00:22:57 INFO epoch [ 23] train time 0h 0m 11s |  loss |[1343.582]
Fri 04 Oct 2024 00:23:07 INFO epoch [ 74] train time 0h 0m 25s |  loss |[1254.711]
Fri 04 Oct 2024 00:23:08 INFO epoch [ 24] train time 0h 0m 11s |  loss |[1335.668]
Fri 04 Oct 2024 00:23:20 INFO epoch [ 25] train time 0h 0m 11s |  loss |[1339.532]
Fri 04 Oct 2024 00:23:31 INFO epoch [ 26] train time 0h 0m 11s |  loss |[1329.792]
Fri 04 Oct 2024 00:23:33 INFO epoch [ 75] train time 0h 0m 25s |  loss |[1256.197]
Fri 04 Oct 2024 00:23:43 INFO epoch [ 27] train time 0h 0m 11s |  loss |[1328.063]
Fri 04 Oct 2024 00:23:54 INFO epoch [ 28] train time 0h 0m 11s |  loss |[1322.586]
Fri 04 Oct 2024 00:23:58 INFO epoch [ 76] train time 0h 0m 25s |  loss |[1257.212]
Fri 04 Oct 2024 00:24:05 INFO epoch [ 29] train time 0h 0m 11s |  loss |[1320.493]
Fri 04 Oct 2024 00:24:17 INFO epoch [ 30] train time 0h 0m 11s |  loss |[1314.114]
Fri 04 Oct 2024 00:24:23 INFO epoch [ 77] train time 0h 0m 25s |  loss |[1254.597]
Fri 04 Oct 2024 00:24:48 INFO epoch [ 78] train time 0h 0m 25s |  loss |[1253.398]
Fri 04 Oct 2024 00:25:10 INFO epoch [ 79] train time 0h 0m 21s |  loss |[1254.441]
Fri 04 Oct 2024 00:25:27 INFO epoch [ 80] train time 0h 0m 16s |  loss |[1249.709]
Fri 04 Oct 2024 00:25:34 INFO ---------- valid total [245] | valid precision [0.252] | valid recall [0.259] | valid f0.5 [0.225] | valid time 0h 1m 17s
Fri 04 Oct 2024 00:26:51 INFO ---------- test total [246] | test precision [0.234] | test recall [0.238] | test f0.5 [0.200] | test time 0h 1m 17s
Fri 04 Oct 2024 00:27:05 INFO epoch [ 31] train time 0h 0m 11s |  loss |[1312.867]
Fri 04 Oct 2024 00:27:16 INFO epoch [ 32] train time 0h 0m 11s |  loss |[1319.513]
Fri 04 Oct 2024 00:27:28 INFO epoch [ 33] train time 0h 0m 11s |  loss |[1311.998]
Fri 04 Oct 2024 00:27:39 INFO epoch [ 34] train time 0h 0m 11s |  loss |[1306.310]
Fri 04 Oct 2024 00:27:50 INFO epoch [ 35] train time 0h 0m 11s |  loss |[1306.520]
Fri 04 Oct 2024 00:28:02 INFO epoch [ 36] train time 0h 0m 11s |  loss |[1300.773]
Fri 04 Oct 2024 00:28:13 INFO epoch [ 37] train time 0h 0m 11s |  loss |[1299.207]
Fri 04 Oct 2024 00:28:25 INFO epoch [ 38] train time 0h 0m 11s |  loss |[1301.723]
Fri 04 Oct 2024 00:28:36 INFO epoch [ 39] train time 0h 0m 11s |  loss |[1297.318]
Fri 04 Oct 2024 00:28:48 INFO epoch [ 40] train time 0h 0m 11s |  loss |[1294.465]
Fri 04 Oct 2024 00:30:07 INFO ---------- valid total [245] | valid precision [0.264] | valid recall [0.278] | valid f0.5 [0.241] | valid time 0h 1m 19s
Fri 04 Oct 2024 00:31:25 INFO ---------- test total [246] | test precision [0.261] | test recall [0.265] | test f0.5 [0.230] | test time 0h 1m 17s
Fri 04 Oct 2024 00:31:38 INFO epoch [ 41] train time 0h 0m 11s |  loss |[1293.021]
Fri 04 Oct 2024 00:31:50 INFO epoch [ 42] train time 0h 0m 11s |  loss |[1292.665]
Fri 04 Oct 2024 00:32:01 INFO epoch [ 43] train time 0h 0m 11s |  loss |[1289.279]
Fri 04 Oct 2024 00:32:13 INFO epoch [ 44] train time 0h 0m 11s |  loss |[1291.508]
Fri 04 Oct 2024 00:32:24 INFO epoch [ 45] train time 0h 0m 11s |  loss |[1286.290]
Fri 04 Oct 2024 00:32:36 INFO epoch [ 46] train time 0h 0m 11s |  loss |[1286.648]
Fri 04 Oct 2024 00:32:47 INFO epoch [ 47] train time 0h 0m 11s |  loss |[1284.807]
Fri 04 Oct 2024 00:32:59 INFO epoch [ 48] train time 0h 0m 11s |  loss |[1288.475]
Fri 04 Oct 2024 00:33:10 INFO epoch [ 49] train time 0h 0m 11s |  loss |[1284.411]
Fri 04 Oct 2024 00:33:22 INFO epoch [ 50] train time 0h 0m 11s |  loss |[1278.222]
Fri 04 Oct 2024 00:34:40 INFO ---------- valid total [245] | valid precision [0.270] | valid recall [0.291] | valid f0.5 [0.248] | valid time 0h 1m 17s
Fri 04 Oct 2024 00:35:57 INFO ---------- test total [246] | test precision [0.271] | test recall [0.291] | test f0.5 [0.245] | test time 0h 1m 17s
Fri 04 Oct 2024 00:36:11 INFO epoch [ 51] train time 0h 0m 11s |  loss |[1276.689]
Fri 04 Oct 2024 00:36:18 INFO | supervised_trainer |NOTE: overflow detected, setting loss scale to: 2.0
Fri 04 Oct 2024 00:36:22 INFO epoch [ 52] train time 0h 0m 11s |  loss |[1271.708]
Fri 04 Oct 2024 00:36:34 INFO epoch [ 53] train time 0h 0m 11s |  loss |[1273.471]
Fri 04 Oct 2024 00:36:45 INFO epoch [ 54] train time 0h 0m 11s |  loss |[1276.270]
Fri 04 Oct 2024 00:36:57 INFO epoch [ 55] train time 0h 0m 11s |  loss |[1280.759]
Fri 04 Oct 2024 00:37:08 INFO epoch [ 56] train time 0h 0m 11s |  loss |[1271.226]
Fri 04 Oct 2024 00:37:20 INFO epoch [ 57] train time 0h 0m 11s |  loss |[1268.344]
Fri 04 Oct 2024 00:37:32 INFO epoch [ 58] train time 0h 0m 11s |  loss |[1270.382]
Fri 04 Oct 2024 00:37:43 INFO epoch [ 59] train time 0h 0m 11s |  loss |[1272.792]
Fri 04 Oct 2024 00:37:55 INFO epoch [ 60] train time 0h 0m 11s |  loss |[1267.899]
Fri 04 Oct 2024 00:39:12 INFO ---------- valid total [245] | valid precision [0.267] | valid recall [0.281] | valid f0.5 [0.245] | valid time 0h 1m 17s
Fri 04 Oct 2024 00:40:30 INFO ---------- test total [246] | test precision [0.267] | test recall [0.278] | test f0.5 [0.233] | test time 0h 1m 17s
Fri 04 Oct 2024 00:40:41 INFO epoch [ 61] train time 0h 0m 11s |  loss |[1265.231]
Fri 04 Oct 2024 00:40:53 INFO epoch [ 62] train time 0h 0m 11s |  loss |[1267.395]
Fri 04 Oct 2024 00:41:04 INFO epoch [ 63] train time 0h 0m 11s |  loss |[1263.262]
Fri 04 Oct 2024 00:41:16 INFO epoch [ 64] train time 0h 0m 11s |  loss |[1260.258]
Fri 04 Oct 2024 00:41:28 INFO epoch [ 65] train time 0h 0m 11s |  loss |[1261.791]
Fri 04 Oct 2024 00:41:39 INFO epoch [ 66] train time 0h 0m 11s |  loss |[1261.948]
Fri 04 Oct 2024 00:41:51 INFO epoch [ 67] train time 0h 0m 11s |  loss |[1262.617]
Fri 04 Oct 2024 00:42:03 INFO epoch [ 68] train time 0h 0m 11s |  loss |[1254.598]
Fri 04 Oct 2024 00:42:14 INFO epoch [ 69] train time 0h 0m 11s |  loss |[1260.581]
Fri 04 Oct 2024 00:42:26 INFO epoch [ 70] train time 0h 0m 11s |  loss |[1257.957]
Fri 04 Oct 2024 00:43:43 INFO ---------- valid total [245] | valid precision [0.259] | valid recall [0.274] | valid f0.5 [0.236] | valid time 0h 1m 17s
Fri 04 Oct 2024 00:45:01 INFO ---------- test total [246] | test precision [0.265] | test recall [0.279] | test f0.5 [0.235] | test time 0h 1m 17s
Fri 04 Oct 2024 00:45:12 INFO epoch [ 71] train time 0h 0m 11s |  loss |[1267.677]
Fri 04 Oct 2024 00:45:24 INFO epoch [ 72] train time 0h 0m 11s |  loss |[1257.284]
Fri 04 Oct 2024 00:45:35 INFO epoch [ 73] train time 0h 0m 11s |  loss |[1253.292]
Fri 04 Oct 2024 00:45:47 INFO epoch [ 74] train time 0h 0m 11s |  loss |[1254.711]
Fri 04 Oct 2024 00:45:58 INFO epoch [ 75] train time 0h 0m 11s |  loss |[1256.197]
Fri 04 Oct 2024 00:46:10 INFO epoch [ 76] train time 0h 0m 11s |  loss |[1257.212]
Fri 04 Oct 2024 00:46:21 INFO epoch [ 77] train time 0h 0m 11s |  loss |[1254.597]
Fri 04 Oct 2024 00:46:33 INFO epoch [ 78] train time 0h 0m 11s |  loss |[1253.398]
Fri 04 Oct 2024 00:46:45 INFO epoch [ 79] train time 0h 0m 11s |  loss |[1254.441]
Fri 04 Oct 2024 00:46:56 INFO epoch [ 80] train time 0h 0m 11s |  loss |[1249.709]
Fri 04 Oct 2024 00:48:14 INFO ---------- valid total [245] | valid precision [0.265] | valid recall [0.272] | valid f0.5 [0.242] | valid time 0h 1m 17s
Fri 04 Oct 2024 00:49:31 INFO ---------- test total [246] | test precision [0.284] | test recall [0.277] | test f0.5 [0.243] | test time 0h 1m 17s
Fri 04 Oct 2024 00:49:43 INFO epoch [ 81] train time 0h 0m 11s |  loss |[1251.822]
Fri 04 Oct 2024 00:49:54 INFO epoch [ 82] train time 0h 0m 11s |  loss |[1249.282]
Fri 04 Oct 2024 00:50:06 INFO epoch [ 83] train time 0h 0m 11s |  loss |[1250.101]
Fri 04 Oct 2024 00:50:18 INFO epoch [ 84] train time 0h 0m 11s |  loss |[1245.473]
Fri 04 Oct 2024 00:50:29 INFO epoch [ 85] train time 0h 0m 11s |  loss |[1245.750]
Fri 04 Oct 2024 00:50:41 INFO epoch [ 86] train time 0h 0m 11s |  loss |[1250.967]
Fri 04 Oct 2024 00:50:53 INFO epoch [ 87] train time 0h 0m 11s |  loss |[1243.012]
Fri 04 Oct 2024 00:51:04 INFO epoch [ 88] train time 0h 0m 11s |  loss |[1245.520]
Fri 04 Oct 2024 00:51:16 INFO epoch [ 89] train time 0h 0m 11s |  loss |[1249.507]
Fri 04 Oct 2024 00:51:28 INFO epoch [ 90] train time 0h 0m 11s |  loss |[1246.132]
Fri 04 Oct 2024 00:52:45 INFO ---------- valid total [245] | valid precision [0.257] | valid recall [0.272] | valid f0.5 [0.235] | valid time 0h 1m 17s
Fri 04 Oct 2024 00:54:02 INFO ---------- test total [246] | test precision [0.274] | test recall [0.273] | test f0.5 [0.236] | test time 0h 1m 16s
Fri 04 Oct 2024 00:54:13 INFO epoch [ 91] train time 0h 0m 11s |  loss |[1242.297]
Fri 04 Oct 2024 00:54:25 INFO epoch [ 92] train time 0h 0m 11s |  loss |[1246.073]
Fri 04 Oct 2024 00:54:36 INFO epoch [ 93] train time 0h 0m 11s |  loss |[1240.954]
Fri 04 Oct 2024 00:54:48 INFO epoch [ 94] train time 0h 0m 11s |  loss |[1241.721]
Fri 04 Oct 2024 00:55:00 INFO epoch [ 95] train time 0h 0m 11s |  loss |[1239.945]
Fri 04 Oct 2024 00:55:11 INFO epoch [ 96] train time 0h 0m 11s |  loss |[1246.077]
Fri 04 Oct 2024 00:55:23 INFO epoch [ 97] train time 0h 0m 11s |  loss |[1243.463]
Fri 04 Oct 2024 00:55:34 INFO epoch [ 98] train time 0h 0m 11s |  loss |[1242.427]
Fri 04 Oct 2024 00:55:46 INFO epoch [ 99] train time 0h 0m 11s |  loss |[1242.946]
Fri 04 Oct 2024 00:55:58 INFO epoch [100] train time 0h 0m 11s |  loss |[1238.091]
Fri 04 Oct 2024 00:57:15 INFO ---------- valid total [245] | valid precision [0.255] | valid recall [0.260] | valid f0.5 [0.232] | valid time 0h 1m 17s
Fri 04 Oct 2024 00:58:32 INFO ---------- test total [246] | test precision [0.270] | test recall [0.269] | test f0.5 [0.234] | test time 0h 1m 16s
Fri 04 Oct 2024 00:58:44 INFO epoch [101] train time 0h 0m 11s |  loss |[1238.151]
Fri 04 Oct 2024 00:58:56 INFO epoch [102] train time 0h 0m 11s |  loss |[1239.297]
Fri 04 Oct 2024 00:59:07 INFO epoch [103] train time 0h 0m 11s |  loss |[1240.172]
Fri 04 Oct 2024 00:59:19 INFO epoch [104] train time 0h 0m 11s |  loss |[1242.988]
Fri 04 Oct 2024 00:59:30 INFO epoch [105] train time 0h 0m 11s |  loss |[1242.329]
Fri 04 Oct 2024 00:59:42 INFO epoch [106] train time 0h 0m 11s |  loss |[1233.431]
Fri 04 Oct 2024 00:59:54 INFO epoch [107] train time 0h 0m 11s |  loss |[1234.583]
Fri 04 Oct 2024 01:00:05 INFO epoch [108] train time 0h 0m 11s |  loss |[1234.382]
Fri 04 Oct 2024 01:00:17 INFO epoch [109] train time 0h 0m 11s |  loss |[1237.255]
Fri 04 Oct 2024 01:00:28 INFO epoch [110] train time 0h 0m 11s |  loss |[1233.397]
Fri 04 Oct 2024 01:01:46 INFO ---------- valid total [245] | valid precision [0.256] | valid recall [0.262] | valid f0.5 [0.233] | valid time 0h 1m 17s
Fri 04 Oct 2024 01:03:03 INFO ---------- test total [246] | test precision [0.282] | test recall [0.270] | test f0.5 [0.238] | test time 0h 1m 16s
Fri 04 Oct 2024 01:03:14 INFO epoch [111] train time 0h 0m 11s |  loss |[1232.677]
Fri 04 Oct 2024 01:03:26 INFO epoch [112] train time 0h 0m 11s |  loss |[1236.575]
Fri 04 Oct 2024 01:03:37 INFO epoch [113] train time 0h 0m 11s |  loss |[1231.258]
Fri 04 Oct 2024 01:03:49 INFO epoch [114] train time 0h 0m 11s |  loss |[1231.596]
Fri 04 Oct 2024 01:04:01 INFO epoch [115] train time 0h 0m 11s |  loss |[1230.302]
Fri 04 Oct 2024 01:04:12 INFO epoch [116] train time 0h 0m 11s |  loss |[1227.724]
Fri 04 Oct 2024 01:04:24 INFO epoch [117] train time 0h 0m 11s |  loss |[1229.246]
Fri 04 Oct 2024 01:04:36 INFO epoch [118] train time 0h 0m 11s |  loss |[1230.809]
Fri 04 Oct 2024 01:04:47 INFO epoch [119] train time 0h 0m 11s |  loss |[1228.319]
Fri 04 Oct 2024 01:04:59 INFO epoch [120] train time 0h 0m 11s |  loss |[1225.163]
Fri 04 Oct 2024 01:06:17 INFO ---------- valid total [245] | valid precision [0.250] | valid recall [0.254] | valid f0.5 [0.226] | valid time 0h 1m 17s
Fri 04 Oct 2024 01:07:34 INFO ---------- test total [246] | test precision [0.277] | test recall [0.276] | test f0.5 [0.238] | test time 0h 1m 16s
Fri 04 Oct 2024 01:07:45 INFO epoch [121] train time 0h 0m 11s |  loss |[1229.450]
Fri 04 Oct 2024 01:07:57 INFO epoch [122] train time 0h 0m 11s |  loss |[1227.397]
Fri 04 Oct 2024 01:08:08 INFO epoch [123] train time 0h 0m 11s |  loss |[1226.433]
Fri 04 Oct 2024 01:08:20 INFO epoch [124] train time 0h 0m 11s |  loss |[1228.818]
Fri 04 Oct 2024 01:08:32 INFO epoch [125] train time 0h 0m 11s |  loss |[1230.910]
Fri 04 Oct 2024 01:08:43 INFO epoch [126] train time 0h 0m 11s |  loss |[1228.417]
Fri 04 Oct 2024 01:08:55 INFO epoch [127] train time 0h 0m 11s |  loss |[1229.918]
Fri 04 Oct 2024 01:09:07 INFO epoch [128] train time 0h 0m 11s |  loss |[1228.366]
Fri 04 Oct 2024 01:09:18 INFO epoch [129] train time 0h 0m 11s |  loss |[1226.153]
Fri 04 Oct 2024 01:09:30 INFO epoch [130] train time 0h 0m 11s |  loss |[1225.938]
Fri 04 Oct 2024 01:10:47 INFO ---------- valid total [245] | valid precision [0.257] | valid recall [0.273] | valid f0.5 [0.236] | valid time 0h 1m 17s
Fri 04 Oct 2024 01:12:04 INFO ---------- test total [246] | test precision [0.271] | test recall [0.265] | test f0.5 [0.231] | test time 0h 1m 16s
Fri 04 Oct 2024 01:12:16 INFO epoch [131] train time 0h 0m 11s |  loss |[1224.790]
Fri 04 Oct 2024 01:12:27 INFO epoch [132] train time 0h 0m 11s |  loss |[1228.771]
Fri 04 Oct 2024 01:12:39 INFO epoch [133] train time 0h 0m 11s |  loss |[1226.043]
Fri 04 Oct 2024 01:12:51 INFO epoch [134] train time 0h 0m 11s |  loss |[1226.712]
Fri 04 Oct 2024 01:13:02 INFO epoch [135] train time 0h 0m 11s |  loss |[1220.016]
Fri 04 Oct 2024 01:13:14 INFO epoch [136] train time 0h 0m 11s |  loss |[1225.080]
Fri 04 Oct 2024 01:13:26 INFO epoch [137] train time 0h 0m 11s |  loss |[1225.071]
Fri 04 Oct 2024 01:13:38 INFO epoch [138] train time 0h 0m 11s |  loss |[1221.301]
Fri 04 Oct 2024 01:13:49 INFO epoch [139] train time 0h 0m 11s |  loss |[1221.368]
Fri 04 Oct 2024 01:14:01 INFO epoch [140] train time 0h 0m 11s |  loss |[1221.001]
Fri 04 Oct 2024 01:15:18 INFO ---------- valid total [245] | valid precision [0.261] | valid recall [0.273] | valid f0.5 [0.238] | valid time 0h 1m 17s
Fri 04 Oct 2024 01:16:36 INFO ---------- test total [246] | test precision [0.279] | test recall [0.270] | test f0.5 [0.232] | test time 0h 1m 17s
Fri 04 Oct 2024 01:16:47 INFO epoch [141] train time 0h 0m 11s |  loss |[1218.592]
Fri 04 Oct 2024 01:16:59 INFO epoch [142] train time 0h 0m 11s |  loss |[1223.731]
Fri 04 Oct 2024 01:17:10 INFO epoch [143] train time 0h 0m 11s |  loss |[1220.692]
Fri 04 Oct 2024 01:17:22 INFO epoch [144] train time 0h 0m 11s |  loss |[1223.549]
Fri 04 Oct 2024 01:17:34 INFO epoch [145] train time 0h 0m 11s |  loss |[1219.908]
Fri 04 Oct 2024 01:17:45 INFO epoch [146] train time 0h 0m 11s |  loss |[1218.506]
Fri 04 Oct 2024 01:17:57 INFO epoch [147] train time 0h 0m 11s |  loss |[1216.371]
Fri 04 Oct 2024 01:18:09 INFO epoch [148] train time 0h 0m 11s |  loss |[1219.786]
Fri 04 Oct 2024 01:18:20 INFO epoch [149] train time 0h 0m 11s |  loss |[1224.387]
Fri 04 Oct 2024 01:18:32 INFO epoch [150] train time 0h 0m 11s |  loss |[1213.581]
Fri 04 Oct 2024 01:19:50 INFO ---------- valid total [245] | valid precision [0.251] | valid recall [0.261] | valid f0.5 [0.228] | valid time 0h 1m 17s
Fri 04 Oct 2024 01:21:07 INFO ---------- test total [246] | test precision [0.278] | test recall [0.269] | test f0.5 [0.234] | test time 0h 1m 17s
Fri 04 Oct 2024 01:21:19 INFO epoch [151] train time 0h 0m 11s |  loss |[1219.730]
Fri 04 Oct 2024 01:21:30 INFO epoch [152] train time 0h 0m 11s |  loss |[1216.311]
Fri 04 Oct 2024 01:21:42 INFO epoch [153] train time 0h 0m 11s |  loss |[1216.782]
Fri 04 Oct 2024 01:21:54 INFO epoch [154] train time 0h 0m 11s |  loss |[1211.708]
Fri 04 Oct 2024 01:22:05 INFO epoch [155] train time 0h 0m 11s |  loss |[1216.940]
Fri 04 Oct 2024 01:22:17 INFO epoch [156] train time 0h 0m 11s |  loss |[1213.970]
Fri 04 Oct 2024 01:22:29 INFO epoch [157] train time 0h 0m 11s |  loss |[1217.607]
Fri 04 Oct 2024 01:22:40 INFO epoch [158] train time 0h 0m 11s |  loss |[1209.721]
Fri 04 Oct 2024 01:22:52 INFO epoch [159] train time 0h 0m 11s |  loss |[1215.130]
Fri 04 Oct 2024 01:23:04 INFO epoch [160] train time 0h 0m 11s |  loss |[1218.523]
Fri 04 Oct 2024 01:24:21 INFO ---------- valid total [245] | valid precision [0.260] | valid recall [0.275] | valid f0.5 [0.239] | valid time 0h 1m 17s
Fri 04 Oct 2024 01:25:38 INFO ---------- test total [246] | test precision [0.264] | test recall [0.270] | test f0.5 [0.229] | test time 0h 1m 17s
Fri 04 Oct 2024 01:25:50 INFO epoch [161] train time 0h 0m 11s |  loss |[1215.544]
Fri 04 Oct 2024 01:26:02 INFO epoch [162] train time 0h 0m 11s |  loss |[1219.334]
Fri 04 Oct 2024 01:26:13 INFO epoch [163] train time 0h 0m 11s |  loss |[1217.058]
Fri 04 Oct 2024 01:26:25 INFO epoch [164] train time 0h 0m 11s |  loss |[1215.380]
Fri 04 Oct 2024 01:26:37 INFO epoch [165] train time 0h 0m 11s |  loss |[1213.495]
Fri 04 Oct 2024 01:26:48 INFO epoch [166] train time 0h 0m 11s |  loss |[1217.157]
Fri 04 Oct 2024 01:27:00 INFO epoch [167] train time 0h 0m 11s |  loss |[1210.309]
Fri 04 Oct 2024 01:27:12 INFO epoch [168] train time 0h 0m 11s |  loss |[1212.819]
Fri 04 Oct 2024 01:27:24 INFO epoch [169] train time 0h 0m 11s |  loss |[1214.458]
Fri 04 Oct 2024 01:27:35 INFO epoch [170] train time 0h 0m 11s |  loss |[1218.662]
Fri 04 Oct 2024 01:28:53 INFO ---------- valid total [245] | valid precision [0.250] | valid recall [0.258] | valid f0.5 [0.227] | valid time 0h 1m 17s
Fri 04 Oct 2024 01:30:10 INFO ---------- test total [246] | test precision [0.289] | test recall [0.279] | test f0.5 [0.242] | test time 0h 1m 17s
Fri 04 Oct 2024 01:30:22 INFO epoch [171] train time 0h 0m 11s |  loss |[1209.250]
Fri 04 Oct 2024 01:30:33 INFO epoch [172] train time 0h 0m 11s |  loss |[1210.081]
Fri 04 Oct 2024 01:30:45 INFO epoch [173] train time 0h 0m 11s |  loss |[1212.799]
Fri 04 Oct 2024 01:30:57 INFO epoch [174] train time 0h 0m 11s |  loss |[1211.177]
Fri 04 Oct 2024 01:31:08 INFO epoch [175] train time 0h 0m 11s |  loss |[1209.542]
Fri 04 Oct 2024 01:31:20 INFO epoch [176] train time 0h 0m 11s |  loss |[1212.297]
Fri 04 Oct 2024 01:31:32 INFO epoch [177] train time 0h 0m 11s |  loss |[1212.060]
Fri 04 Oct 2024 01:31:43 INFO epoch [178] train time 0h 0m 11s |  loss |[1207.993]
Fri 04 Oct 2024 01:31:55 INFO epoch [179] train time 0h 0m 11s |  loss |[1205.113]
Fri 04 Oct 2024 01:32:07 INFO epoch [180] train time 0h 0m 11s |  loss |[1207.934]
Fri 04 Oct 2024 01:33:24 INFO ---------- valid total [245] | valid precision [0.251] | valid recall [0.263] | valid f0.5 [0.229] | valid time 0h 1m 17s
Fri 04 Oct 2024 01:34:41 INFO ---------- test total [246] | test precision [0.279] | test recall [0.276] | test f0.5 [0.240] | test time 0h 1m 16s
Fri 04 Oct 2024 01:34:52 INFO epoch [181] train time 0h 0m 11s |  loss |[1205.819]
Fri 04 Oct 2024 01:35:04 INFO epoch [182] train time 0h 0m 11s |  loss |[1206.666]
Fri 04 Oct 2024 01:35:16 INFO epoch [183] train time 0h 0m 11s |  loss |[1210.096]
Fri 04 Oct 2024 01:35:27 INFO epoch [184] train time 0h 0m 11s |  loss |[1209.249]
Fri 04 Oct 2024 01:35:39 INFO epoch [185] train time 0h 0m 11s |  loss |[1206.916]
Fri 04 Oct 2024 01:35:51 INFO epoch [186] train time 0h 0m 11s |  loss |[1208.089]
Fri 04 Oct 2024 01:36:03 INFO epoch [187] train time 0h 0m 11s |  loss |[1204.916]
Fri 04 Oct 2024 01:36:14 INFO epoch [188] train time 0h 0m 11s |  loss |[1210.547]
Fri 04 Oct 2024 01:36:26 INFO epoch [189] train time 0h 0m 11s |  loss |[1203.904]
Fri 04 Oct 2024 01:36:38 INFO epoch [190] train time 0h 0m 11s |  loss |[1206.758]
Fri 04 Oct 2024 01:37:55 INFO ---------- valid total [245] | valid precision [0.242] | valid recall [0.253] | valid f0.5 [0.220] | valid time 0h 1m 17s
Fri 04 Oct 2024 01:39:12 INFO ---------- test total [246] | test precision [0.284] | test recall [0.271] | test f0.5 [0.241] | test time 0h 1m 16s
Fri 04 Oct 2024 01:39:24 INFO epoch [191] train time 0h 0m 11s |  loss |[1209.902]
Fri 04 Oct 2024 01:39:35 INFO epoch [192] train time 0h 0m 11s |  loss |[1205.824]
Fri 04 Oct 2024 01:39:47 INFO epoch [193] train time 0h 0m 11s |  loss |[1207.369]
Fri 04 Oct 2024 01:39:58 INFO epoch [194] train time 0h 0m 11s |  loss |[1201.599]
Fri 04 Oct 2024 01:40:10 INFO epoch [195] train time 0h 0m 11s |  loss |[1207.140]
Fri 04 Oct 2024 01:40:22 INFO epoch [196] train time 0h 0m 11s |  loss |[1198.375]
Fri 04 Oct 2024 01:41:38 INFO ---------- valid total [245] | valid precision [0.245] | valid recall [0.262] | valid f0.5 [0.223] | valid time 0h 1m 16s
Fri 04 Oct 2024 01:42:54 INFO ---------- test total [246] | test precision [0.285] | test recall [0.271] | test f0.5 [0.241] | test time 0h 1m 15s
Fri 04 Oct 2024 01:43:05 INFO epoch [197] train time 0h 0m 11s |  loss |[1206.349]
Fri 04 Oct 2024 01:44:22 INFO ---------- valid total [245] | valid precision [0.242] | valid recall [0.251] | valid f0.5 [0.220] | valid time 0h 1m 16s
Fri 04 Oct 2024 01:45:38 INFO ---------- test total [246] | test precision [0.279] | test recall [0.269] | test f0.5 [0.236] | test time 0h 1m 15s
Fri 04 Oct 2024 01:45:49 INFO epoch [198] train time 0h 0m 11s |  loss |[1203.279]
Fri 04 Oct 2024 01:47:05 INFO ---------- valid total [245] | valid precision [0.256] | valid recall [0.267] | valid f0.5 [0.234] | valid time 0h 1m 15s
Fri 04 Oct 2024 01:48:21 INFO ---------- test total [246] | test precision [0.280] | test recall [0.273] | test f0.5 [0.241] | test time 0h 1m 16s
Fri 04 Oct 2024 01:48:33 INFO epoch [199] train time 0h 0m 11s |  loss |[1208.342]
Fri 04 Oct 2024 01:49:49 INFO ---------- valid total [245] | valid precision [0.245] | valid recall [0.255] | valid f0.5 [0.219] | valid time 0h 1m 16s
Fri 04 Oct 2024 01:51:05 INFO ---------- test total [246] | test precision [0.282] | test recall [0.272] | test f0.5 [0.241] | test time 0h 1m 16s
Fri 04 Oct 2024 01:51:17 INFO epoch [200] train time 0h 0m 11s |  loss |[1207.155]
Fri 04 Oct 2024 01:52:33 INFO ---------- valid total [245] | valid precision [0.246] | valid recall [0.263] | valid f0.5 [0.224] | valid time 0h 1m 16s
Fri 04 Oct 2024 01:53:49 INFO ---------- test total [246] | test precision [0.278] | test recall [0.284] | test f0.5 [0.246] | test time 0h 1m 15s
Fri 04 Oct 2024 01:53:49 INFO training finished.
                            best valid result: precision [0.270] | recall [0.291] | F0.5 [0.248]
                            best test result : precision [0.271] | recall [0.291] | F0.5 [0.245]
Tue 08 Oct 2024 21:01:41 INFO random_seed=2024
use_gpu=True
learning_rate=6e-06
train_batch_size=32
test_batch_size=1
epoch_nums=200
test_step=10
display_train_step=1
gpu_id=5
training_resume=False
load_best_config=False
supervising_mode=fully_supervised
validset_divide=True
test_only=False
shuffle=True
model_config_file=gectoolkit/properties/model/SynGEC.json
best_config_file=gectoolkit/properties/best_config/SynGEC_Visual_OCR.json
dataset_config_file=gectoolkit/properties/dataset/Visual_OCR.json
dataset_dir=dataset/Visual_OCR
checkpoint_file=checkpoint/SynGEC-Visual_OCR.pth
log_file=log/SynGEC-Visual_OCR.log
output_dir=result/SynGEC-Visual_OCR
checkpoint_dir=checkpoint/SynGEC-Visual_OCR
min_word_keep=5
min_generate_keep=5
language=zh
fp16_init_scale=128
distributed_port=-1
decoder_embed_path=None
quant_noise_pq_block_size=8
best_checkpoint_metric=loss
cross_self_attention=False
validate_interval=1
tie_adaptive_weights=False
bpe=None
decoder_normalize_before=False
cpu=False
optimizer_overrides={}
quant_noise_pq=0
lr_scheduler=polynomial_decay
no_save_optimizer_state=False
train_subset=train
no_cross_attention=False
distributed_world_size=1
decoder_layerdrop=0
skip_invalid_size_inputs_valid_test=True
lr=[0.0005]
slowmo_momentum=None
log_interval=100
user_dir=./gectoolkit/model/SynGEC/src/src_syngec/syngec_model
min_loss_scale=0.0001
dual_aggregation_freeze=True
decoder_output_dim=1024
curriculum=0
scoring=bleu
optimizer=adam
adam_betas=(0.9,0.999)
share_decoder_input_output_embed=True
fp16_no_flatten_grads=False
distributed_backend=nccl
adaptive_input=False
dpd_suffix=['dpd']
attention_dropout=0.0
fp16=True
pipeline_checkpoint=never
fix_batches_to_gpus=False
fp16_scale_tolerance=0.0
valid_subset=valid
gen_subset=test
no_last_checkpoints=False
decoder_attention_heads=16
distributed_wrapper=DDP
activation_dropout=0.0
log_format=tqdm
decoder_embed_dim=1024
dual_aggregation_beta=0.5
disable_validation=False
quant_noise_scalar=0
use_bmuf=False
gat_encoder_layers=3
arch=syntax_enhanced_bart_large
eval_bleu_print_samples=False
no_scale_embedding=True
zero_sharding=none
pipeline_decoder_devices=None
save_interval_updates=0
localsgd_frequency=3
ignore_prefix_size=0
eval_bleu_args=None
encoder_layerdrop=0
syntax_type=['dep']
distributed_no_spawn=False
left_pad_source=True
decoder_layers=12
adaptive_softmax_cutoff=None
upsample_primary=1
ddp_backend=c10d
validate_after_updates=0
power=1.0
data_buffer_size=10
memory_efficient_bf16=False
num_batch_buckets=0
share_all_embeddings=True
alpha=1.0
gated_sum=False
distributed_init_method=None
report_accuracy=False
end_learning_rate=0.0
batch_size_valid=None
pipeline_devices=None
left_pad_target=False
source_word_dropout_probs=False
bf16=False
swm_suffix=swm
encoder_embed_dim=1024
force_anneal=None
no_epoch_checkpoints=False
syntax_encoder=GCN
encoder_ffn_embed_dim=4096
label_smoothing=0.1
num_shards=1
find_unused_parameters=True
no_progress_bar=False
load_alignments=False
use_old_adam=False
eval_bleu_detok_args=None
tensorboard_logdir=None
slowmo_algorithm=LocalSGD
fast_stat_sync=False
layernorm_embedding=True
encoder_layers_to_keep=None
eval_bleu_remove_bpe=None
scale_syntax_encoder_lr=None
eval_bleu=False
fp16_scale_window=None
pipeline_encoder_balance=None
pipeline_encoder_devices=None
relu_dropout=0.0
threshold_loss_scale=None
activation_fn=gelu
task=syntax-enhanced-translation
target_lang=tgt
bart_model_file_from_transformers=None
all_gather_list_size=16384
stop_time_hours=0
validate_interval_updates=0
save_interval=1
conll_suffix=['conll']
empty_cache_freq=0
encoder_learned_pos=True
tpu=False
nprocs_per_node=1
keep_last_epochs=10
device_id=0
source_lang_with_nt=src_nt
use_dpd=False
pipeline_chunks=0
cross_syntax_fuse=False
keep_interval_updates=-1
encoder_embed_path=None
adam_eps=1e-08
model_parallel_size=1
sentence_avg=False
encoder_layers=12
decoder_ffn_embed_dim=4096
dataset_impl=None
criterion=label_smoothed_cross_entropy
fixed_validation_seed=None
profile=False
distributed_rank=0
source_lang=src
eval_tokenized_bleu=False
source_word_dropout=0.2
adaptive_softmax_dropout=0
syntax_model_file=None
checkpoint_suffix=
required_seq_len_multiple=1
no_save=False
use_syntax=True
probs_suffix=['probs']
decoder_learned_pos=True
decoder_input_dim=1024
memory_efficient_fp16=False
decoder_layers_to_keep=None
gat_attention_heads=4
bucket_cap_mb=25
checkpoint_shard_count=1
pipeline_model_parallel=False
encoder_normalize_before=False
keep_best_checkpoints=-1
no_token_positional_embeddings=False
pooler_activation_fn=tanh
shard_id=0
only_dsa=False
max_update=0
encoder_attention_heads=16
freeze_bart_parameters=True
tokenizer=None
total_num_update=1000000
pipeline_decoder_balance=None
quantization_config_path=None
broadcast_buffers=False
batch_size=None
maximize_best_checkpoint_metric=False
pooler_dropout=0.0
warmup_updates=2000
min_lr=-1.0
only_gnn=True
eval_bleu_detok=space
no_seed_provided=False
truncate_source=False
pipeline_balance=None
model=SynGEC
dataset=Visual_OCR
augment=none
method=OCR
correctionmodel=SynGEC
device=cuda
map_location=cuda
gpu_nums=1


Tue 08 Oct 2024 21:01:41 INFO [src] dictionary: 21132 types
Tue 08 Oct 2024 21:01:41 INFO [tgt] dictionary: 21132 types
Tue 08 Oct 2024 21:01:41 INFO [syntax label0] dictionary: 51 types
Tue 08 Oct 2024 21:01:41 INFO [src] dictionary: 21132 types
Tue 08 Oct 2024 21:01:41 INFO [tgt] dictionary: 21132 types
Tue 08 Oct 2024 21:01:41 INFO [syntax label0] dictionary: 51 types
Tue 08 Oct 2024 21:01:41 INFO loaded 245 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_with_syntax_bart/bin/valid.src-tgt.src
Tue 08 Oct 2024 21:01:41 INFO loaded 245 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_with_syntax_bart/bin/valid.src-tgt.tgt
Tue 08 Oct 2024 21:01:41 INFO ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_with_syntax_bart/bin valid src-tgt 245 examples
Tue 08 Oct 2024 21:01:41 INFO loaded 245 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_with_syntax_bart/bin/valid.conll.src-tgt.src
Tue 08 Oct 2024 21:01:41 INFO loaded 245 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_with_syntax_bart/bin/valid.dpd.src-tgt.src
Tue 08 Oct 2024 21:01:41 INFO loaded 245 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_with_syntax_bart/bin/valid.probs.src-tgt.src
Tue 08 Oct 2024 21:01:41 INFO success! syntax types: 1, source conll lines: 245
Tue 08 Oct 2024 21:01:41 INFO loaded 1960 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_with_syntax_bart/bin/train.src-tgt.src
Tue 08 Oct 2024 21:01:41 INFO loaded 1960 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_with_syntax_bart/bin/train.src-tgt.tgt
Tue 08 Oct 2024 21:01:41 INFO ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_with_syntax_bart/bin train src-tgt 1960 examples
Tue 08 Oct 2024 21:01:41 INFO loaded 1960 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_with_syntax_bart/bin/train.conll.src-tgt.src
Tue 08 Oct 2024 21:01:41 INFO loaded 1960 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_with_syntax_bart/bin/train.dpd.src-tgt.src
Tue 08 Oct 2024 21:01:41 INFO loaded 1960 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_with_syntax_bart/bin/train.probs.src-tgt.src
Tue 08 Oct 2024 21:01:41 INFO success! syntax types: 1, source conll lines: 1960
Tue 08 Oct 2024 21:01:41 INFO loaded 246 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_test_with_syntax_bart/bin/test.conll.src-tgt.src
Tue 08 Oct 2024 21:01:41 INFO loaded 246 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_test_with_syntax_bart/bin/test.dpd.src-tgt.src
Tue 08 Oct 2024 21:01:41 INFO loaded 246 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_test_with_syntax_bart/bin/test.probs.src-tgt.src
Tue 08 Oct 2024 21:01:41 INFO success! syntax types: 1, source conll lines: 246
Tue 08 Oct 2024 21:01:49 INFO detected shared parameter: encoder.sentence_encoder.embed_tokens.weight <- decoder.embed_tokens.weight
Tue 08 Oct 2024 21:01:49 INFO detected shared parameter: encoder.sentence_encoder.embed_tokens.weight <- decoder.output_projection.weight
Tue 08 Oct 2024 21:01:49 INFO ***********************CUDA enviroments for all 1 workers***********************
Tue 08 Oct 2024 21:01:49 INFO rank   0: capabilities =  8.0  ; total memory = 79.151 GB ; name = NVIDIA A800 80GB PCIe                   
Tue 08 Oct 2024 21:01:49 INFO ***********************CUDA enviroments for all 1 workers***********************
Tue 08 Oct 2024 21:01:53 INFO loaded checkpoint ./gectoolkit/properties/model/SynGEC/preprocess/gopar/chinese_Visual_OCR_bart_baseline/checkpoint_best.pt (epoch 21 @ 1414 updates)
Tue 08 Oct 2024 21:01:53 INFO loading train data for epoch 21
Tue 08 Oct 2024 21:01:53 INFO loaded 1960 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_with_syntax_bart/bin/train.src-tgt.src
Tue 08 Oct 2024 21:01:53 INFO loaded 1960 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_with_syntax_bart/bin/train.src-tgt.tgt
Tue 08 Oct 2024 21:01:53 INFO ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_with_syntax_bart/bin train src-tgt 1960 examples
Tue 08 Oct 2024 21:01:53 INFO loaded 1960 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_with_syntax_bart/bin/train.conll.src-tgt.src
Tue 08 Oct 2024 21:01:53 INFO loaded 1960 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_with_syntax_bart/bin/train.dpd.src-tgt.src
Tue 08 Oct 2024 21:01:53 INFO loaded 1960 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_Visual_OCR_with_syntax_bart/bin/train.probs.src-tgt.src
Tue 08 Oct 2024 21:01:53 INFO success! syntax types: 1, source conll lines: 1960
Tue 08 Oct 2024 21:01:54 INFO SynGEC(
  (model): SyntaxEnhancedBARTModel(
    (encoder): SyntaxEnhancedTransformerEncoder(
      (sentence_encoder): SyntaxEnhancedSentenceTransformerEncoder(
        (dropout_module): FairseqDropout()
        (embed_tokens): Embedding(21132, 1024, padding_idx=1)
        (embed_positions): LearnedPositionalEmbedding(514, 1024, padding_idx=1)
        (layernorm_embedding): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        (layers): ModuleList(
          (0-11): 12 x DSATransformerEncoderLayer(
            (self_attn): DSAMultiheadAttention(
              (dropout_module): FairseqDropout()
              (k_proj): Linear(in_features=1024, out_features=1024, bias=True)
              (v_proj): Linear(in_features=1024, out_features=1024, bias=True)
              (q_proj): Linear(in_features=1024, out_features=1024, bias=True)
              (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
            )
            (self_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
            (dropout_module): FairseqDropout()
            (activation_dropout_module): FairseqDropout()
            (fc1): Linear(in_features=1024, out_features=4096, bias=True)
            (fc2): Linear(in_features=4096, out_features=1024, bias=True)
            (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
      )
      (syntax_encoder): SyntaxEnhancedSyntaxGuidedTransformerEncoder(
        (dropout_module): FairseqDropout()
        (embed_tokens): Embedding(51, 1024, padding_idx=0)
        (layers): ModuleList(
          (0-2): 3 x GCNSyntaxGuidedTransformerEncoderLayer(
            (gcn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
            (dropout_module): FairseqDropout()
            (activation_dropout_module): FairseqDropout()
            (W_out): Linear(in_features=2048, out_features=1024, bias=True)
            (W_in): Linear(in_features=2048, out_features=1024, bias=True)
            (fc): Linear(in_features=1024, out_features=1024, bias=True)
            (fc1): Linear(in_features=1024, out_features=4096, bias=True)
            (fc2): Linear(in_features=4096, out_features=1024, bias=True)
            (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
      )
    )
    (decoder): SyntaxEnhancedTransformerDecoder(
      (dropout_module): FairseqDropout()
      (embed_tokens): Embedding(21132, 1024, padding_idx=1)
      (embed_positions): LearnedPositionalEmbedding(514, 1024, padding_idx=1)
      (layernorm_embedding): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      (layers): ModuleList(
        (0-11): 12 x TransformerDecoderLayer(
          (dropout_module): FairseqDropout()
          (self_attn): MultiheadAttention(
            (dropout_module): FairseqDropout()
            (k_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (v_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (q_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
          )
          (activation_dropout_module): FairseqDropout()
          (self_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          (encoder_attn): MultiheadAttention(
            (dropout_module): FairseqDropout()
            (k_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (v_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (q_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
          )
          (encoder_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          (fc1): Linear(in_features=1024, out_features=4096, bias=True)
          (fc2): Linear(in_features=4096, out_features=1024, bias=True)
          (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        )
      )
      (output_projection): Linear(in_features=1024, out_features=21132, bias=False)
    )
    (classification_heads): ModuleDict()
  )
  (criterion): LabelSmoothedCrossEntropyCriterion()
)
Tue 08 Oct 2024 21:01:54 INFO start training...
Tue 08 Oct 2024 21:01:55 INFO | supervised_trainer |NOTE: overflow detected, setting loss scale to: 64.0
Tue 08 Oct 2024 21:01:55 INFO | supervised_trainer |NOTE: overflow detected, setting loss scale to: 32.0
Tue 08 Oct 2024 21:01:57 INFO | supervised_trainer |NOTE: overflow detected, setting loss scale to: 16.0
Tue 08 Oct 2024 21:01:58 INFO | supervised_trainer |NOTE: overflow detected, setting loss scale to: 8.0
Tue 08 Oct 2024 21:02:01 INFO | supervised_trainer |NOTE: overflow detected, setting loss scale to: 4.0
Tue 08 Oct 2024 21:02:06 INFO epoch [  1] train time 0h 0m 11s |  loss |[6049.123]
Tue 08 Oct 2024 21:02:17 INFO epoch [  2] train time 0h 0m 11s |  loss |[3418.651]
Tue 08 Oct 2024 21:02:29 INFO epoch [  3] train time 0h 0m 11s |  loss |[2067.689]
Tue 08 Oct 2024 21:02:40 INFO epoch [  4] train time 0h 0m 11s |  loss |[1721.607]
Tue 08 Oct 2024 21:02:52 INFO epoch [  5] train time 0h 0m 11s |  loss |[1603.144]
Tue 08 Oct 2024 21:03:03 INFO epoch [  6] train time 0h 0m 11s |  loss |[1539.634]
Tue 08 Oct 2024 21:03:15 INFO epoch [  7] train time 0h 0m 11s |  loss |[1499.631]
Tue 08 Oct 2024 21:03:26 INFO epoch [  8] train time 0h 0m 11s |  loss |[1469.267]
Tue 08 Oct 2024 21:03:38 INFO epoch [  9] train time 0h 0m 11s |  loss |[1449.534]
Tue 08 Oct 2024 21:03:49 INFO epoch [ 10] train time 0h 0m 11s |  loss |[1427.584]
Tue 08 Oct 2024 21:05:04 INFO ---------- valid total [245] | valid precision [0.243] | valid recall [0.257] | valid f0.5 [0.221] | valid time 0h 1m 14s
Tue 08 Oct 2024 21:06:19 INFO ---------- test total [246] | test precision [0.254] | test recall [0.251] | test f0.5 [0.214] | test time 0h 1m 14s
Tue 08 Oct 2024 21:06:32 INFO epoch [ 11] train time 0h 0m 11s |  loss |[1416.158]
Tue 08 Oct 2024 21:06:44 INFO epoch [ 12] train time 0h 0m 11s |  loss |[1397.499]
Tue 08 Oct 2024 21:06:55 INFO epoch [ 13] train time 0h 0m 11s |  loss |[1392.338]
Tue 08 Oct 2024 21:07:07 INFO epoch [ 14] train time 0h 0m 11s |  loss |[1387.154]
Tue 08 Oct 2024 21:07:18 INFO epoch [ 15] train time 0h 0m 11s |  loss |[1372.441]
Tue 08 Oct 2024 21:07:30 INFO epoch [ 16] train time 0h 0m 11s |  loss |[1374.608]
Tue 08 Oct 2024 21:07:42 INFO epoch [ 17] train time 0h 0m 11s |  loss |[1357.838]
Tue 08 Oct 2024 21:07:53 INFO epoch [ 18] train time 0h 0m 11s |  loss |[1356.709]
Tue 08 Oct 2024 21:08:05 INFO epoch [ 19] train time 0h 0m 11s |  loss |[1355.791]
Tue 08 Oct 2024 21:08:16 INFO epoch [ 20] train time 0h 0m 11s |  loss |[1349.160]
Tue 08 Oct 2024 21:09:33 INFO ---------- valid total [245] | valid precision [0.254] | valid recall [0.269] | valid f0.5 [0.232] | valid time 0h 1m 16s
Tue 08 Oct 2024 21:10:50 INFO ---------- test total [246] | test precision [0.285] | test recall [0.291] | test f0.5 [0.250] | test time 0h 1m 16s
Tue 08 Oct 2024 21:11:03 INFO epoch [ 21] train time 0h 0m 11s |  loss |[1339.751]
Tue 08 Oct 2024 21:11:15 INFO epoch [ 22] train time 0h 0m 11s |  loss |[1342.584]
Tue 08 Oct 2024 21:11:26 INFO epoch [ 23] train time 0h 0m 11s |  loss |[1337.812]
Tue 08 Oct 2024 21:11:38 INFO epoch [ 24] train time 0h 0m 11s |  loss |[1330.108]
Tue 08 Oct 2024 21:11:49 INFO epoch [ 25] train time 0h 0m 11s |  loss |[1337.830]
Tue 08 Oct 2024 21:12:01 INFO epoch [ 26] train time 0h 0m 11s |  loss |[1326.882]
Tue 08 Oct 2024 21:12:12 INFO epoch [ 27] train time 0h 0m 11s |  loss |[1325.649]
Tue 08 Oct 2024 21:12:24 INFO epoch [ 28] train time 0h 0m 11s |  loss |[1321.635]
Tue 08 Oct 2024 21:12:35 INFO epoch [ 29] train time 0h 0m 11s |  loss |[1318.840]
Tue 08 Oct 2024 21:12:47 INFO epoch [ 30] train time 0h 0m 11s |  loss |[1313.096]
Tue 08 Oct 2024 21:14:02 INFO ---------- valid total [245] | valid precision [0.264] | valid recall [0.289] | valid f0.5 [0.243] | valid time 0h 1m 15s
Tue 08 Oct 2024 21:15:17 INFO ---------- test total [246] | test precision [0.264] | test recall [0.285] | test f0.5 [0.241] | test time 0h 1m 14s
Tue 08 Oct 2024 21:15:30 INFO epoch [ 31] train time 0h 0m 11s |  loss |[1312.765]
Tue 08 Oct 2024 21:15:42 INFO epoch [ 32] train time 0h 0m 11s |  loss |[1318.232]
Tue 08 Oct 2024 21:15:53 INFO epoch [ 33] train time 0h 0m 11s |  loss |[1311.689]
Tue 08 Oct 2024 21:16:05 INFO epoch [ 34] train time 0h 0m 11s |  loss |[1308.529]
Tue 08 Oct 2024 21:16:16 INFO epoch [ 35] train time 0h 0m 11s |  loss |[1307.371]
Tue 08 Oct 2024 21:16:21 INFO | supervised_trainer |NOTE: overflow detected, setting loss scale to: 2.0
Tue 08 Oct 2024 21:16:28 INFO epoch [ 36] train time 0h 0m 11s |  loss |[1301.306]
Tue 08 Oct 2024 21:16:40 INFO epoch [ 37] train time 0h 0m 11s |  loss |[1300.096]
Tue 08 Oct 2024 21:16:51 INFO epoch [ 38] train time 0h 0m 11s |  loss |[1301.142]
Tue 08 Oct 2024 21:17:03 INFO epoch [ 39] train time 0h 0m 11s |  loss |[1298.520]
Tue 08 Oct 2024 21:17:14 INFO epoch [ 40] train time 0h 0m 11s |  loss |[1296.595]
Tue 08 Oct 2024 21:18:30 INFO ---------- valid total [245] | valid precision [0.265] | valid recall [0.282] | valid f0.5 [0.243] | valid time 0h 1m 15s
Tue 08 Oct 2024 21:19:45 INFO ---------- test total [246] | test precision [0.271] | test recall [0.277] | test f0.5 [0.239] | test time 0h 1m 14s
Tue 08 Oct 2024 21:19:57 INFO epoch [ 41] train time 0h 0m 11s |  loss |[1293.669]
Tue 08 Oct 2024 21:20:08 INFO epoch [ 42] train time 0h 0m 11s |  loss |[1292.755]
Tue 08 Oct 2024 21:20:20 INFO epoch [ 43] train time 0h 0m 11s |  loss |[1290.804]
Tue 08 Oct 2024 21:20:31 INFO epoch [ 44] train time 0h 0m 11s |  loss |[1292.968]
Tue 08 Oct 2024 21:20:43 INFO epoch [ 45] train time 0h 0m 11s |  loss |[1288.270]
Tue 08 Oct 2024 21:20:54 INFO epoch [ 46] train time 0h 0m 11s |  loss |[1287.579]
Tue 08 Oct 2024 21:21:06 INFO epoch [ 47] train time 0h 0m 11s |  loss |[1284.289]
Tue 08 Oct 2024 21:21:18 INFO epoch [ 48] train time 0h 0m 11s |  loss |[1289.514]
Tue 08 Oct 2024 21:21:29 INFO epoch [ 49] train time 0h 0m 11s |  loss |[1285.004]
Tue 08 Oct 2024 21:21:41 INFO epoch [ 50] train time 0h 0m 11s |  loss |[1279.670]
Tue 08 Oct 2024 21:22:56 INFO ---------- valid total [245] | valid precision [0.256] | valid recall [0.281] | valid f0.5 [0.235] | valid time 0h 1m 15s
Tue 08 Oct 2024 21:24:11 INFO ---------- test total [246] | test precision [0.275] | test recall [0.285] | test f0.5 [0.247] | test time 0h 1m 15s
Tue 08 Oct 2024 21:24:23 INFO epoch [ 51] train time 0h 0m 11s |  loss |[1278.755]
Tue 08 Oct 2024 21:24:34 INFO epoch [ 52] train time 0h 0m 11s |  loss |[1272.464]
Tue 08 Oct 2024 21:24:46 INFO epoch [ 53] train time 0h 0m 11s |  loss |[1273.807]
Tue 08 Oct 2024 21:24:57 INFO epoch [ 54] train time 0h 0m 11s |  loss |[1278.089]
Tue 08 Oct 2024 21:25:09 INFO epoch [ 55] train time 0h 0m 11s |  loss |[1279.848]
Tue 08 Oct 2024 21:25:21 INFO epoch [ 56] train time 0h 0m 11s |  loss |[1271.964]
Tue 08 Oct 2024 21:25:32 INFO epoch [ 57] train time 0h 0m 11s |  loss |[1268.991]
Tue 08 Oct 2024 21:25:44 INFO epoch [ 58] train time 0h 0m 11s |  loss |[1271.193]
Tue 08 Oct 2024 21:25:55 INFO epoch [ 59] train time 0h 0m 11s |  loss |[1273.943]
Tue 08 Oct 2024 21:26:07 INFO epoch [ 60] train time 0h 0m 11s |  loss |[1268.949]
Tue 08 Oct 2024 21:27:22 INFO ---------- valid total [245] | valid precision [0.279] | valid recall [0.295] | valid f0.5 [0.257] | valid time 0h 1m 15s
Tue 08 Oct 2024 21:28:38 INFO ---------- test total [246] | test precision [0.281] | test recall [0.287] | test f0.5 [0.246] | test time 0h 1m 15s
Tue 08 Oct 2024 21:28:51 INFO epoch [ 61] train time 0h 0m 11s |  loss |[1266.861]
Tue 08 Oct 2024 21:29:03 INFO epoch [ 62] train time 0h 0m 11s |  loss |[1268.993]
Tue 08 Oct 2024 21:29:14 INFO epoch [ 63] train time 0h 0m 11s |  loss |[1263.416]
Tue 08 Oct 2024 21:29:26 INFO epoch [ 64] train time 0h 0m 11s |  loss |[1260.935]
Tue 08 Oct 2024 21:29:37 INFO epoch [ 65] train time 0h 0m 11s |  loss |[1264.035]
Tue 08 Oct 2024 21:29:49 INFO epoch [ 66] train time 0h 0m 11s |  loss |[1263.236]
Tue 08 Oct 2024 21:30:00 INFO epoch [ 67] train time 0h 0m 11s |  loss |[1263.663]
Tue 08 Oct 2024 21:30:12 INFO epoch [ 68] train time 0h 0m 11s |  loss |[1256.433]
Tue 08 Oct 2024 21:30:24 INFO epoch [ 69] train time 0h 0m 11s |  loss |[1261.058]
Tue 08 Oct 2024 21:30:35 INFO epoch [ 70] train time 0h 0m 11s |  loss |[1258.561]
Tue 08 Oct 2024 21:31:51 INFO ---------- valid total [245] | valid precision [0.273] | valid recall [0.288] | valid f0.5 [0.251] | valid time 0h 1m 15s
Tue 08 Oct 2024 21:33:06 INFO ---------- test total [246] | test precision [0.258] | test recall [0.272] | test f0.5 [0.229] | test time 0h 1m 15s
Tue 08 Oct 2024 21:33:18 INFO epoch [ 71] train time 0h 0m 11s |  loss |[1268.478]
Tue 08 Oct 2024 21:33:29 INFO epoch [ 72] train time 0h 0m 11s |  loss |[1257.284]
Tue 08 Oct 2024 21:33:41 INFO epoch [ 73] train time 0h 0m 11s |  loss |[1252.687]
Tue 08 Oct 2024 21:33:52 INFO epoch [ 74] train time 0h 0m 11s |  loss |[1256.751]
Tue 08 Oct 2024 21:34:04 INFO epoch [ 75] train time 0h 0m 11s |  loss |[1256.360]
Tue 08 Oct 2024 21:34:15 INFO epoch [ 76] train time 0h 0m 11s |  loss |[1258.406]
Tue 08 Oct 2024 21:34:27 INFO epoch [ 77] train time 0h 0m 11s |  loss |[1254.584]
Tue 08 Oct 2024 21:34:39 INFO epoch [ 78] train time 0h 0m 11s |  loss |[1254.078]
Tue 08 Oct 2024 21:34:50 INFO epoch [ 79] train time 0h 0m 11s |  loss |[1256.126]
Tue 08 Oct 2024 21:35:02 INFO epoch [ 80] train time 0h 0m 11s |  loss |[1250.222]
Tue 08 Oct 2024 21:36:17 INFO ---------- valid total [245] | valid precision [0.273] | valid recall [0.284] | valid f0.5 [0.250] | valid time 0h 1m 15s
Tue 08 Oct 2024 21:37:32 INFO ---------- test total [246] | test precision [0.274] | test recall [0.269] | test f0.5 [0.237] | test time 0h 1m 14s
Tue 08 Oct 2024 21:37:44 INFO epoch [ 81] train time 0h 0m 11s |  loss |[1253.189]
Tue 08 Oct 2024 21:37:55 INFO epoch [ 82] train time 0h 0m 11s |  loss |[1250.326]
Tue 08 Oct 2024 21:38:07 INFO epoch [ 83] train time 0h 0m 11s |  loss |[1250.341]
Tue 08 Oct 2024 21:38:18 INFO epoch [ 84] train time 0h 0m 11s |  loss |[1246.344]
Tue 08 Oct 2024 21:38:30 INFO epoch [ 85] train time 0h 0m 11s |  loss |[1247.070]
Tue 08 Oct 2024 21:38:42 INFO epoch [ 86] train time 0h 0m 11s |  loss |[1252.616]
Tue 08 Oct 2024 21:38:53 INFO epoch [ 87] train time 0h 0m 11s |  loss |[1244.166]
Tue 08 Oct 2024 21:39:05 INFO epoch [ 88] train time 0h 0m 11s |  loss |[1245.142]
Tue 08 Oct 2024 21:39:17 INFO epoch [ 89] train time 0h 0m 11s |  loss |[1248.866]
Tue 08 Oct 2024 21:39:28 INFO epoch [ 90] train time 0h 0m 11s |  loss |[1245.556]
Tue 08 Oct 2024 21:40:44 INFO ---------- valid total [245] | valid precision [0.269] | valid recall [0.278] | valid f0.5 [0.246] | valid time 0h 1m 15s
Tue 08 Oct 2024 21:41:59 INFO ---------- test total [246] | test precision [0.283] | test recall [0.282] | test f0.5 [0.250] | test time 0h 1m 14s
Tue 08 Oct 2024 21:42:10 INFO epoch [ 91] train time 0h 0m 11s |  loss |[1241.147]
Tue 08 Oct 2024 21:42:22 INFO epoch [ 92] train time 0h 0m 11s |  loss |[1245.907]
Tue 08 Oct 2024 21:42:33 INFO epoch [ 93] train time 0h 0m 11s |  loss |[1240.966]
Tue 08 Oct 2024 21:42:45 INFO epoch [ 94] train time 0h 0m 11s |  loss |[1241.570]
Tue 08 Oct 2024 21:42:56 INFO epoch [ 95] train time 0h 0m 11s |  loss |[1239.900]
Tue 08 Oct 2024 21:43:08 INFO epoch [ 96] train time 0h 0m 11s |  loss |[1247.433]
Tue 08 Oct 2024 21:43:20 INFO epoch [ 97] train time 0h 0m 11s |  loss |[1243.835]
Tue 08 Oct 2024 21:43:31 INFO epoch [ 98] train time 0h 0m 11s |  loss |[1242.048]
Tue 08 Oct 2024 21:43:43 INFO epoch [ 99] train time 0h 0m 11s |  loss |[1242.460]
Tue 08 Oct 2024 21:43:55 INFO epoch [100] train time 0h 0m 11s |  loss |[1238.461]
Tue 08 Oct 2024 21:45:09 INFO ---------- valid total [245] | valid precision [0.274] | valid recall [0.280] | valid f0.5 [0.250] | valid time 0h 1m 14s
Tue 08 Oct 2024 21:46:24 INFO ---------- test total [246] | test precision [0.282] | test recall [0.276] | test f0.5 [0.245] | test time 0h 1m 14s
Tue 08 Oct 2024 21:46:36 INFO epoch [101] train time 0h 0m 11s |  loss |[1237.158]
Tue 08 Oct 2024 21:46:47 INFO epoch [102] train time 0h 0m 11s |  loss |[1239.911]
Tue 08 Oct 2024 21:46:59 INFO epoch [103] train time 0h 0m 11s |  loss |[1240.122]
Tue 08 Oct 2024 21:47:10 INFO epoch [104] train time 0h 0m 11s |  loss |[1242.249]
Tue 08 Oct 2024 21:47:22 INFO epoch [105] train time 0h 0m 11s |  loss |[1241.478]
Tue 08 Oct 2024 21:47:33 INFO epoch [106] train time 0h 0m 11s |  loss |[1234.045]
Tue 08 Oct 2024 21:47:45 INFO epoch [107] train time 0h 0m 11s |  loss |[1234.963]
Tue 08 Oct 2024 21:47:57 INFO epoch [108] train time 0h 0m 11s |  loss |[1234.321]
Tue 08 Oct 2024 21:48:08 INFO epoch [109] train time 0h 0m 11s |  loss |[1237.364]
Tue 08 Oct 2024 21:48:20 INFO epoch [110] train time 0h 0m 11s |  loss |[1233.947]
Tue 08 Oct 2024 21:49:35 INFO ---------- valid total [245] | valid precision [0.252] | valid recall [0.262] | valid f0.5 [0.230] | valid time 0h 1m 15s
Tue 08 Oct 2024 21:50:50 INFO ---------- test total [246] | test precision [0.285] | test recall [0.282] | test f0.5 [0.249] | test time 0h 1m 14s
Tue 08 Oct 2024 21:51:01 INFO epoch [111] train time 0h 0m 11s |  loss |[1233.372]
Tue 08 Oct 2024 21:51:13 INFO epoch [112] train time 0h 0m 11s |  loss |[1235.826]
Tue 08 Oct 2024 21:51:24 INFO epoch [113] train time 0h 0m 11s |  loss |[1230.438]
Tue 08 Oct 2024 21:51:36 INFO epoch [114] train time 0h 0m 11s |  loss |[1230.390]
Tue 08 Oct 2024 21:51:47 INFO epoch [115] train time 0h 0m 11s |  loss |[1230.575]
Tue 08 Oct 2024 21:51:59 INFO epoch [116] train time 0h 0m 11s |  loss |[1227.429]
Tue 08 Oct 2024 21:52:11 INFO epoch [117] train time 0h 0m 11s |  loss |[1229.767]
Tue 08 Oct 2024 21:52:22 INFO epoch [118] train time 0h 0m 11s |  loss |[1231.288]
Tue 08 Oct 2024 21:52:34 INFO epoch [119] train time 0h 0m 11s |  loss |[1228.716]
Tue 08 Oct 2024 21:52:46 INFO epoch [120] train time 0h 0m 11s |  loss |[1224.414]
Tue 08 Oct 2024 21:54:01 INFO ---------- valid total [245] | valid precision [0.267] | valid recall [0.280] | valid f0.5 [0.244] | valid time 0h 1m 15s
Tue 08 Oct 2024 21:55:16 INFO ---------- test total [246] | test precision [0.282] | test recall [0.290] | test f0.5 [0.251] | test time 0h 1m 15s
Tue 08 Oct 2024 21:55:28 INFO epoch [121] train time 0h 0m 11s |  loss |[1229.103]
Tue 08 Oct 2024 21:55:39 INFO epoch [122] train time 0h 0m 11s |  loss |[1226.844]
Tue 08 Oct 2024 21:55:51 INFO epoch [123] train time 0h 0m 11s |  loss |[1227.346]
Tue 08 Oct 2024 21:56:03 INFO epoch [124] train time 0h 0m 11s |  loss |[1227.124]
Tue 08 Oct 2024 21:56:14 INFO epoch [125] train time 0h 0m 11s |  loss |[1230.891]
Tue 08 Oct 2024 21:56:26 INFO epoch [126] train time 0h 0m 11s |  loss |[1227.466]
Tue 08 Oct 2024 21:56:37 INFO epoch [127] train time 0h 0m 11s |  loss |[1230.137]
Tue 08 Oct 2024 21:56:49 INFO epoch [128] train time 0h 0m 11s |  loss |[1229.012]
Tue 08 Oct 2024 21:57:00 INFO epoch [129] train time 0h 0m 11s |  loss |[1226.284]
Tue 08 Oct 2024 21:57:12 INFO epoch [130] train time 0h 0m 11s |  loss |[1225.863]
Tue 08 Oct 2024 21:58:26 INFO ---------- valid total [245] | valid precision [0.258] | valid recall [0.268] | valid f0.5 [0.236] | valid time 0h 1m 14s
Tue 08 Oct 2024 21:59:41 INFO ---------- test total [246] | test precision [0.274] | test recall [0.270] | test f0.5 [0.238] | test time 0h 1m 14s
Tue 08 Oct 2024 21:59:53 INFO epoch [131] train time 0h 0m 11s |  loss |[1223.826]
Tue 08 Oct 2024 22:00:04 INFO epoch [132] train time 0h 0m 11s |  loss |[1228.116]
Tue 08 Oct 2024 22:00:16 INFO epoch [133] train time 0h 0m 11s |  loss |[1226.346]
Tue 08 Oct 2024 22:00:27 INFO epoch [134] train time 0h 0m 11s |  loss |[1226.498]
Tue 08 Oct 2024 22:00:38 INFO epoch [135] train time 0h 0m 11s |  loss |[1220.091]
Tue 08 Oct 2024 22:00:50 INFO epoch [136] train time 0h 0m 11s |  loss |[1224.541]
Tue 08 Oct 2024 22:01:02 INFO epoch [137] train time 0h 0m 11s |  loss |[1225.828]
Tue 08 Oct 2024 22:01:13 INFO epoch [138] train time 0h 0m 11s |  loss |[1220.502]
Tue 08 Oct 2024 22:01:25 INFO epoch [139] train time 0h 0m 11s |  loss |[1220.818]
Tue 08 Oct 2024 22:01:36 INFO epoch [140] train time 0h 0m 11s |  loss |[1220.555]
Tue 08 Oct 2024 22:02:51 INFO ---------- valid total [245] | valid precision [0.264] | valid recall [0.267] | valid f0.5 [0.241] | valid time 0h 1m 14s
Tue 08 Oct 2024 22:04:06 INFO ---------- test total [246] | test precision [0.284] | test recall [0.282] | test f0.5 [0.244] | test time 0h 1m 14s
Tue 08 Oct 2024 22:04:17 INFO epoch [141] train time 0h 0m 11s |  loss |[1218.431]
Tue 08 Oct 2024 22:04:29 INFO epoch [142] train time 0h 0m 11s |  loss |[1223.029]
Tue 08 Oct 2024 22:04:40 INFO epoch [143] train time 0h 0m 11s |  loss |[1218.952]
Tue 08 Oct 2024 22:04:52 INFO epoch [144] train time 0h 0m 11s |  loss |[1223.414]
Tue 08 Oct 2024 22:05:03 INFO epoch [145] train time 0h 0m 11s |  loss |[1219.653]
Tue 08 Oct 2024 22:05:14 INFO epoch [146] train time 0h 0m 11s |  loss |[1218.114]
Tue 08 Oct 2024 22:05:26 INFO epoch [147] train time 0h 0m 11s |  loss |[1215.039]
Tue 08 Oct 2024 22:05:37 INFO epoch [148] train time 0h 0m 11s |  loss |[1219.130]
Tue 08 Oct 2024 22:05:49 INFO epoch [149] train time 0h 0m 11s |  loss |[1222.904]
Tue 08 Oct 2024 22:06:00 INFO epoch [150] train time 0h 0m 11s |  loss |[1213.122]
Tue 08 Oct 2024 22:07:15 INFO ---------- valid total [245] | valid precision [0.249] | valid recall [0.258] | valid f0.5 [0.226] | valid time 0h 1m 14s
Tue 08 Oct 2024 22:08:29 INFO ---------- test total [246] | test precision [0.281] | test recall [0.275] | test f0.5 [0.241] | test time 0h 1m 14s
Tue 08 Oct 2024 22:08:41 INFO epoch [151] train time 0h 0m 11s |  loss |[1218.814]
Tue 08 Oct 2024 22:08:52 INFO epoch [152] train time 0h 0m 11s |  loss |[1214.996]
Tue 08 Oct 2024 22:09:04 INFO epoch [153] train time 0h 0m 11s |  loss |[1215.419]
Tue 08 Oct 2024 22:09:15 INFO epoch [154] train time 0h 0m 11s |  loss |[1211.274]
Tue 08 Oct 2024 22:09:27 INFO epoch [155] train time 0h 0m 11s |  loss |[1216.440]
Tue 08 Oct 2024 22:09:38 INFO epoch [156] train time 0h 0m 11s |  loss |[1213.889]
Tue 08 Oct 2024 22:09:50 INFO epoch [157] train time 0h 0m 11s |  loss |[1216.241]
Tue 08 Oct 2024 22:10:01 INFO epoch [158] train time 0h 0m 11s |  loss |[1208.572]
Tue 08 Oct 2024 22:10:13 INFO epoch [159] train time 0h 0m 11s |  loss |[1215.148]
Tue 08 Oct 2024 22:10:24 INFO epoch [160] train time 0h 0m 11s |  loss |[1218.316]
Tue 08 Oct 2024 22:11:39 INFO ---------- valid total [245] | valid precision [0.273] | valid recall [0.284] | valid f0.5 [0.250] | valid time 0h 1m 15s
Tue 08 Oct 2024 22:12:54 INFO ---------- test total [246] | test precision [0.277] | test recall [0.278] | test f0.5 [0.238] | test time 0h 1m 14s
Tue 08 Oct 2024 22:13:05 INFO epoch [161] train time 0h 0m 11s |  loss |[1214.214]
Tue 08 Oct 2024 22:13:17 INFO epoch [162] train time 0h 0m 11s |  loss |[1218.271]
Tue 08 Oct 2024 22:13:28 INFO epoch [163] train time 0h 0m 11s |  loss |[1216.101]
Tue 08 Oct 2024 22:13:36 INFO | supervised_trainer |NOTE: overflow detected, setting loss scale to: 1.0
Tue 08 Oct 2024 22:13:40 INFO epoch [164] train time 0h 0m 11s |  loss |[1215.734]
Tue 08 Oct 2024 22:13:51 INFO epoch [165] train time 0h 0m 11s |  loss |[1212.811]
Tue 08 Oct 2024 22:14:03 INFO epoch [166] train time 0h 0m 11s |  loss |[1216.259]
Tue 08 Oct 2024 22:14:14 INFO epoch [167] train time 0h 0m 11s |  loss |[1208.657]
Tue 08 Oct 2024 22:14:26 INFO epoch [168] train time 0h 0m 11s |  loss |[1210.405]
Tue 08 Oct 2024 22:14:37 INFO epoch [169] train time 0h 0m 11s |  loss |[1214.428]
Tue 08 Oct 2024 22:14:49 INFO epoch [170] train time 0h 0m 11s |  loss |[1218.833]
Tue 08 Oct 2024 22:16:03 INFO ---------- valid total [245] | valid precision [0.271] | valid recall [0.274] | valid f0.5 [0.247] | valid time 0h 1m 14s
Tue 08 Oct 2024 22:17:18 INFO ---------- test total [246] | test precision [0.283] | test recall [0.280] | test f0.5 [0.240] | test time 0h 1m 14s
Tue 08 Oct 2024 22:17:30 INFO epoch [171] train time 0h 0m 11s |  loss |[1207.647]
Tue 08 Oct 2024 22:17:41 INFO epoch [172] train time 0h 0m 11s |  loss |[1209.048]
Tue 08 Oct 2024 22:17:53 INFO epoch [173] train time 0h 0m 11s |  loss |[1212.045]
Tue 08 Oct 2024 22:18:04 INFO epoch [174] train time 0h 0m 11s |  loss |[1209.379]
Tue 08 Oct 2024 22:18:15 INFO epoch [175] train time 0h 0m 11s |  loss |[1208.436]
Tue 08 Oct 2024 22:18:27 INFO epoch [176] train time 0h 0m 11s |  loss |[1211.459]
Tue 08 Oct 2024 22:18:38 INFO epoch [177] train time 0h 0m 11s |  loss |[1209.538]
Tue 08 Oct 2024 22:18:50 INFO epoch [178] train time 0h 0m 11s |  loss |[1206.972]
Tue 08 Oct 2024 22:19:01 INFO epoch [179] train time 0h 0m 11s |  loss |[1204.763]
Tue 08 Oct 2024 22:19:13 INFO epoch [180] train time 0h 0m 11s |  loss |[1206.449]
Tue 08 Oct 2024 22:20:28 INFO ---------- valid total [245] | valid precision [0.258] | valid recall [0.273] | valid f0.5 [0.236] | valid time 0h 1m 14s
Tue 08 Oct 2024 22:21:42 INFO ---------- test total [246] | test precision [0.280] | test recall [0.277] | test f0.5 [0.241] | test time 0h 1m 14s
Tue 08 Oct 2024 22:21:54 INFO epoch [181] train time 0h 0m 11s |  loss |[1205.651]
Tue 08 Oct 2024 22:22:05 INFO epoch [182] train time 0h 0m 11s |  loss |[1206.174]
Tue 08 Oct 2024 22:22:16 INFO epoch [183] train time 0h 0m 11s |  loss |[1208.800]
Tue 08 Oct 2024 22:22:28 INFO epoch [184] train time 0h 0m 11s |  loss |[1208.429]
Tue 08 Oct 2024 22:22:39 INFO epoch [185] train time 0h 0m 11s |  loss |[1206.712]
Tue 08 Oct 2024 22:22:51 INFO epoch [186] train time 0h 0m 11s |  loss |[1207.451]
Tue 08 Oct 2024 22:23:02 INFO epoch [187] train time 0h 0m 11s |  loss |[1203.751]
Tue 08 Oct 2024 22:23:14 INFO epoch [188] train time 0h 0m 11s |  loss |[1208.455]
Tue 08 Oct 2024 22:23:25 INFO epoch [189] train time 0h 0m 11s |  loss |[1203.376]
Tue 08 Oct 2024 22:23:37 INFO epoch [190] train time 0h 0m 11s |  loss |[1205.965]
Tue 08 Oct 2024 22:24:52 INFO ---------- valid total [245] | valid precision [0.270] | valid recall [0.285] | valid f0.5 [0.247] | valid time 0h 1m 14s
Tue 08 Oct 2024 22:26:06 INFO ---------- test total [246] | test precision [0.286] | test recall [0.279] | test f0.5 [0.242] | test time 0h 1m 14s
Tue 08 Oct 2024 22:26:17 INFO epoch [191] train time 0h 0m 11s |  loss |[1209.215]
Tue 08 Oct 2024 22:26:29 INFO epoch [192] train time 0h 0m 11s |  loss |[1205.116]
Tue 08 Oct 2024 22:26:40 INFO epoch [193] train time 0h 0m 11s |  loss |[1206.670]
Tue 08 Oct 2024 22:26:52 INFO epoch [194] train time 0h 0m 11s |  loss |[1199.331]
Tue 08 Oct 2024 22:27:03 INFO epoch [195] train time 0h 0m 11s |  loss |[1207.696]
Tue 08 Oct 2024 22:27:15 INFO epoch [196] train time 0h 0m 11s |  loss |[1197.397]
Tue 08 Oct 2024 22:28:30 INFO ---------- valid total [245] | valid precision [0.264] | valid recall [0.276] | valid f0.5 [0.242] | valid time 0h 1m 14s
Tue 08 Oct 2024 22:29:43 INFO ---------- test total [246] | test precision [0.286] | test recall [0.282] | test f0.5 [0.246] | test time 0h 1m 13s
Tue 08 Oct 2024 22:29:55 INFO epoch [197] train time 0h 0m 11s |  loss |[1205.461]
Tue 08 Oct 2024 22:31:09 INFO ---------- valid total [245] | valid precision [0.273] | valid recall [0.279] | valid f0.5 [0.249] | valid time 0h 1m 14s
Tue 08 Oct 2024 22:32:23 INFO ---------- test total [246] | test precision [0.285] | test recall [0.268] | test f0.5 [0.237] | test time 0h 1m 13s
Tue 08 Oct 2024 22:32:34 INFO epoch [198] train time 0h 0m 11s |  loss |[1202.193]
Tue 08 Oct 2024 22:33:48 INFO ---------- valid total [245] | valid precision [0.278] | valid recall [0.289] | valid f0.5 [0.255] | valid time 0h 1m 13s
Tue 08 Oct 2024 22:35:02 INFO ---------- test total [246] | test precision [0.283] | test recall [0.277] | test f0.5 [0.240] | test time 0h 1m 13s
Tue 08 Oct 2024 22:35:13 INFO epoch [199] train time 0h 0m 11s |  loss |[1207.896]
Tue 08 Oct 2024 22:36:27 INFO ---------- valid total [245] | valid precision [0.282] | valid recall [0.287] | valid f0.5 [0.259] | valid time 0h 1m 14s
Tue 08 Oct 2024 22:37:41 INFO ---------- test total [246] | test precision [0.287] | test recall [0.282] | test f0.5 [0.247] | test time 0h 1m 13s
Tue 08 Oct 2024 22:37:54 INFO epoch [200] train time 0h 0m 11s |  loss |[1205.815]
Tue 08 Oct 2024 22:39:10 INFO ---------- valid total [245] | valid precision [0.275] | valid recall [0.285] | valid f0.5 [0.253] | valid time 0h 1m 15s
Tue 08 Oct 2024 22:40:25 INFO ---------- test total [246] | test precision [0.280] | test recall [0.279] | test f0.5 [0.240] | test time 0h 1m 15s
Tue 08 Oct 2024 22:40:25 INFO training finished.
                            best valid result: precision [0.282] | recall [0.287] | F0.5 [0.259]
                            best test result : precision [0.287] | recall [0.282] | F0.5 [0.247]
