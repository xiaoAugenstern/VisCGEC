Thu 10 Oct 2024 21:45:14 INFO random_seed=2024
use_gpu=True
learning_rate=6e-06
train_batch_size=32
test_batch_size=1
epoch_nums=250
test_step=5
display_train_step=1
gpu_id=5
training_resume=False
load_best_config=False
supervising_mode=fully_supervised
validset_divide=True
test_only=False
shuffle=True
model_config_file=gectoolkit/properties/model/Transformer.json
best_config_file=gectoolkit/properties/best_config/Transformer_nlpcc18.json
dataset_config_file=gectoolkit/properties/dataset/nlpcc18.json
dataset_dir=dataset/nlpcc18
checkpoint_file=checkpoint/Transformer-nlpcc18.pth
log_file=log/Transformer-nlpcc18.log
output_dir=result/Transformer-nlpcc18
checkpoint_dir=checkpoint/Transformer-nlpcc18
min_word_keep=5
min_generate_keep=5
language=zh
pretrained_model_path=./gectoolkit/properties/model/Transformer
approx=none
backend=nccl
loss_type=FC_FT_CRF
dropout=0.2
embed_dim=512
hidden_dim=128
ff_embed_dim=2048
max_output_len=100
max_input_len=100
layers=6
gamma=2
num_heads=8
device=cuda
model=Transformer
dataset=nlpcc18
augment=none
map_location=cuda
gpu_nums=1


Thu 10 Oct 2024 21:46:27 INFO Transformer(
  (in_tok_embed): Embedding(21135, 512, padding_idx=0)
  (positional_embed): LearnedPositionalEmbedding(
    (weights): Embedding(1024, 512)
  )
  (self_attention_mask): SelfAttentionMask()
  (encoder_stack): ModuleList(
    (0-5): 6 x TransformerLayer(
      (self_attn): MultiheadAttention(
        (out_proj): Linear(in_features=512, out_features=512, bias=True)
      )
      (fc1): Linear(in_features=512, out_features=2048, bias=True)
      (fc2): Linear(in_features=2048, out_features=512, bias=True)
      (attn_layer_norm): LayerNorm()
      (ff_layer_norm): LayerNorm()
    )
  )
  (decoder_stack): ModuleList(
    (0-5): 6 x TransformerLayer(
      (self_attn): MultiheadAttention(
        (out_proj): Linear(in_features=512, out_features=512, bias=True)
      )
      (fc1): Linear(in_features=512, out_features=2048, bias=True)
      (fc2): Linear(in_features=2048, out_features=512, bias=True)
      (attn_layer_norm): LayerNorm()
      (ff_layer_norm): LayerNorm()
      (external_attn): MultiheadAttention(
        (out_proj): Linear(in_features=512, out_features=512, bias=True)
      )
      (external_layer_norm): LayerNorm()
    )
  )
  (out_tok_embed): Linear(in_features=512, out_features=21135, bias=True)
)
Thu 10 Oct 2024 21:46:27 INFO start training...
Thu 10 Oct 2024 21:48:26 INFO random_seed=2024
use_gpu=True
learning_rate=6e-06
train_batch_size=32
test_batch_size=1
epoch_nums=100
test_step=5
display_train_step=1
gpu_id=5
training_resume=False
load_best_config=False
supervising_mode=fully_supervised
validset_divide=True
test_only=False
shuffle=True
model_config_file=gectoolkit/properties/model/Transformer.json
best_config_file=gectoolkit/properties/best_config/Transformer_nlpcc18.json
dataset_config_file=gectoolkit/properties/dataset/nlpcc18.json
dataset_dir=dataset/nlpcc18
checkpoint_file=checkpoint/Transformer-nlpcc18.pth
log_file=log/Transformer-nlpcc18.log
output_dir=result/Transformer-nlpcc18
checkpoint_dir=checkpoint/Transformer-nlpcc18
min_word_keep=5
min_generate_keep=5
language=zh
pretrained_model_path=./gectoolkit/properties/model/Transformer
approx=none
backend=nccl
loss_type=FC_FT_CRF
dropout=0.2
embed_dim=512
hidden_dim=128
ff_embed_dim=2048
max_output_len=100
max_input_len=100
layers=6
gamma=2
num_heads=8
device=cuda
model=Transformer
dataset=nlpcc18
augment=none
map_location=cuda
gpu_nums=1


Thu 10 Oct 2024 21:49:40 INFO Transformer(
  (in_tok_embed): Embedding(21135, 512, padding_idx=0)
  (positional_embed): LearnedPositionalEmbedding(
    (weights): Embedding(1024, 512)
  )
  (self_attention_mask): SelfAttentionMask()
  (encoder_stack): ModuleList(
    (0-5): 6 x TransformerLayer(
      (self_attn): MultiheadAttention(
        (out_proj): Linear(in_features=512, out_features=512, bias=True)
      )
      (fc1): Linear(in_features=512, out_features=2048, bias=True)
      (fc2): Linear(in_features=2048, out_features=512, bias=True)
      (attn_layer_norm): LayerNorm()
      (ff_layer_norm): LayerNorm()
    )
  )
  (decoder_stack): ModuleList(
    (0-5): 6 x TransformerLayer(
      (self_attn): MultiheadAttention(
        (out_proj): Linear(in_features=512, out_features=512, bias=True)
      )
      (fc1): Linear(in_features=512, out_features=2048, bias=True)
      (fc2): Linear(in_features=2048, out_features=512, bias=True)
      (attn_layer_norm): LayerNorm()
      (ff_layer_norm): LayerNorm()
      (external_attn): MultiheadAttention(
        (out_proj): Linear(in_features=512, out_features=512, bias=True)
      )
      (external_layer_norm): LayerNorm()
    )
  )
  (out_tok_embed): Linear(in_features=512, out_features=21135, bias=True)
)
Thu 10 Oct 2024 21:49:40 INFO start training...
Thu 10 Oct 2024 22:05:02 INFO epoch [  1] train time 0h 15m 22s |  loss |[3.382]
Thu 10 Oct 2024 22:20:28 INFO epoch [  2] train time 0h 15m 18s |  loss |[1.796]
Thu 10 Oct 2024 22:35:50 INFO epoch [  3] train time 0h 15m 14s |  loss |[1.353]
Thu 10 Oct 2024 22:51:31 INFO epoch [  4] train time 0h 15m 25s |  loss |[1.180]
Thu 10 Oct 2024 23:07:12 INFO epoch [  5] train time 0h 15m 26s |  loss |[1.089]
Fri 11 Oct 2024 06:39:50 INFO random_seed=2024
use_gpu=True
learning_rate=6e-06
train_batch_size=32
test_batch_size=1
epoch_nums=100
test_step=5
display_train_step=1
gpu_id=5
training_resume=False
load_best_config=False
supervising_mode=fully_supervised
validset_divide=True
test_only=False
shuffle=True
model_config_file=gectoolkit/properties/model/Transformer.json
best_config_file=gectoolkit/properties/best_config/Transformer_nlpcc18.json
dataset_config_file=gectoolkit/properties/dataset/nlpcc18.json
dataset_dir=dataset/nlpcc18
checkpoint_file=checkpoint/Transformer-nlpcc18.pth
log_file=log/Transformer-nlpcc18.log
output_dir=result/Transformer-nlpcc18
checkpoint_dir=checkpoint/Transformer-nlpcc18
min_word_keep=5
min_generate_keep=5
language=zh
pretrained_model_path=./gectoolkit/properties/model/Transformer
approx=none
backend=nccl
loss_type=FC_FT_CRF
dropout=0.2
embed_dim=512
hidden_dim=128
ff_embed_dim=2048
max_output_len=100
max_input_len=100
layers=6
gamma=2
num_heads=8
device=cuda
model=Transformer
dataset=nlpcc18
augment=none
map_location=cuda
gpu_nums=1


Fri 11 Oct 2024 06:41:04 INFO Transformer(
  (in_tok_embed): Embedding(21135, 512, padding_idx=0)
  (positional_embed): LearnedPositionalEmbedding(
    (weights): Embedding(1024, 512)
  )
  (self_attention_mask): SelfAttentionMask()
  (encoder_stack): ModuleList(
    (0-5): 6 x TransformerLayer(
      (self_attn): MultiheadAttention(
        (out_proj): Linear(in_features=512, out_features=512, bias=True)
      )
      (fc1): Linear(in_features=512, out_features=2048, bias=True)
      (fc2): Linear(in_features=2048, out_features=512, bias=True)
      (attn_layer_norm): LayerNorm()
      (ff_layer_norm): LayerNorm()
    )
  )
  (decoder_stack): ModuleList(
    (0-5): 6 x TransformerLayer(
      (self_attn): MultiheadAttention(
        (out_proj): Linear(in_features=512, out_features=512, bias=True)
      )
      (fc1): Linear(in_features=512, out_features=2048, bias=True)
      (fc2): Linear(in_features=2048, out_features=512, bias=True)
      (attn_layer_norm): LayerNorm()
      (ff_layer_norm): LayerNorm()
      (external_attn): MultiheadAttention(
        (out_proj): Linear(in_features=512, out_features=512, bias=True)
      )
      (external_layer_norm): LayerNorm()
    )
  )
  (out_tok_embed): Linear(in_features=512, out_features=21135, bias=True)
)
Fri 11 Oct 2024 06:41:04 INFO train_batch_nums: 14838
Fri 11 Oct 2024 06:41:04 INFO start training...
Fri 11 Oct 2024 06:41:06 INFO epoch [  1] train time 0h 0m 2s |  loss |[0.007]
Fri 11 Oct 2024 06:41:08 INFO epoch [  2] train time 0h 0m 1s |  loss |[0.006]
Fri 11 Oct 2024 06:41:10 INFO epoch [  3] train time 0h 0m 1s |  loss |[0.006]
Fri 11 Oct 2024 06:41:12 INFO epoch [  4] train time 0h 0m 1s |  loss |[0.006]
Fri 11 Oct 2024 06:41:13 INFO epoch [  5] train time 0h 0m 1s |  loss |[0.006]
Fri 11 Oct 2024 06:44:38 INFO ---------- valid total [100] | valid precision [0.000] | valid recall [0.000] | valid f0.5 [0.000] | valid time 0h 3m 25s
Fri 11 Oct 2024 06:47:18 INFO random_seed=2024
use_gpu=True
learning_rate=6e-06
train_batch_size=32
test_batch_size=1
epoch_nums=100
test_step=5
display_train_step=1
gpu_id=5
training_resume=False
load_best_config=False
supervising_mode=fully_supervised
validset_divide=True
test_only=False
shuffle=True
model_config_file=gectoolkit/properties/model/Transformer.json
best_config_file=gectoolkit/properties/best_config/Transformer_nlpcc18.json
dataset_config_file=gectoolkit/properties/dataset/nlpcc18.json
dataset_dir=dataset/nlpcc18
checkpoint_file=checkpoint/Transformer-nlpcc18.pth
log_file=log/Transformer-nlpcc18.log
output_dir=result/Transformer-nlpcc18
checkpoint_dir=checkpoint/Transformer-nlpcc18
min_word_keep=5
min_generate_keep=5
language=zh
pretrained_model_path=./gectoolkit/properties/model/Transformer
approx=none
backend=nccl
loss_type=FC_FT_CRF
dropout=0.2
embed_dim=512
hidden_dim=128
ff_embed_dim=2048
max_output_len=100
max_input_len=100
layers=6
gamma=2
num_heads=8
device=cuda
model=Transformer
dataset=nlpcc18
augment=none
map_location=cuda
gpu_nums=1


Fri 11 Oct 2024 06:48:31 INFO Transformer(
  (in_tok_embed): Embedding(21135, 512, padding_idx=0)
  (positional_embed): LearnedPositionalEmbedding(
    (weights): Embedding(1024, 512)
  )
  (self_attention_mask): SelfAttentionMask()
  (encoder_stack): ModuleList(
    (0-5): 6 x TransformerLayer(
      (self_attn): MultiheadAttention(
        (out_proj): Linear(in_features=512, out_features=512, bias=True)
      )
      (fc1): Linear(in_features=512, out_features=2048, bias=True)
      (fc2): Linear(in_features=2048, out_features=512, bias=True)
      (attn_layer_norm): LayerNorm()
      (ff_layer_norm): LayerNorm()
    )
  )
  (decoder_stack): ModuleList(
    (0-5): 6 x TransformerLayer(
      (self_attn): MultiheadAttention(
        (out_proj): Linear(in_features=512, out_features=512, bias=True)
      )
      (fc1): Linear(in_features=512, out_features=2048, bias=True)
      (fc2): Linear(in_features=2048, out_features=512, bias=True)
      (attn_layer_norm): LayerNorm()
      (ff_layer_norm): LayerNorm()
      (external_attn): MultiheadAttention(
        (out_proj): Linear(in_features=512, out_features=512, bias=True)
      )
      (external_layer_norm): LayerNorm()
    )
  )
  (out_tok_embed): Linear(in_features=512, out_features=21135, bias=True)
)
Fri 11 Oct 2024 06:48:31 INFO train_batch_nums: 14838
Fri 11 Oct 2024 06:48:31 INFO start training...
Fri 11 Oct 2024 06:51:39 INFO epoch [  1] train time 0h 3m 7s |  loss |[1.111]
Fri 11 Oct 2024 06:54:53 INFO epoch [  2] train time 0h 3m 11s |  loss |[0.733]
Fri 11 Oct 2024 06:58:01 INFO epoch [  3] train time 0h 3m 6s |  loss |[0.596]
Fri 11 Oct 2024 07:01:11 INFO epoch [  4] train time 0h 3m 7s |  loss |[0.511]
Fri 11 Oct 2024 07:04:21 INFO epoch [  5] train time 0h 3m 7s |  loss |[0.455]
Fri 11 Oct 2024 07:16:22 INFO ---------- valid total [500] | valid precision [0.210] | valid recall [0.017] | valid f0.5 [0.014] | valid time 0h 12m 1s
Fri 11 Oct 2024 07:28:28 INFO ---------- test total [500] | test precision [0.090] | test recall [0.031] | test f0.5 [0.019] | test time 0h 12m 5s
Fri 11 Oct 2024 07:31:37 INFO epoch [  6] train time 0h 3m 5s |  loss |[0.414]
Fri 11 Oct 2024 07:32:45 INFO random_seed=2024
use_gpu=True
learning_rate=6e-06
train_batch_size=32
test_batch_size=1
epoch_nums=100
test_step=10
display_train_step=1
gpu_id=5
training_resume=True
load_best_config=False
supervising_mode=fully_supervised
validset_divide=True
test_only=False
shuffle=True
model_config_file=gectoolkit/properties/model/Transformer.json
best_config_file=gectoolkit/properties/best_config/Transformer_nlpcc18.json
dataset_config_file=gectoolkit/properties/dataset/nlpcc18.json
dataset_dir=dataset/nlpcc18
checkpoint_file=checkpoint/Transformer-nlpcc18.pth
log_file=log/Transformer-nlpcc18.log
output_dir=result/Transformer-nlpcc18
checkpoint_dir=checkpoint/Transformer-nlpcc18
min_word_keep=5
min_generate_keep=5
language=zh
pretrained_model_path=./gectoolkit/properties/model/Transformer
approx=none
backend=nccl
loss_type=FC_FT_CRF
dropout=0.2
embed_dim=512
hidden_dim=128
ff_embed_dim=2048
max_output_len=100
max_input_len=100
layers=6
gamma=2
num_heads=8
model=Transformer
dataset=nlpcc18
augment=none
map_location=cuda
gpu_nums=1
device=cuda


Fri 11 Oct 2024 07:34:00 INFO Transformer(
  (in_tok_embed): Embedding(21135, 512, padding_idx=0)
  (positional_embed): LearnedPositionalEmbedding(
    (weights): Embedding(1024, 512)
  )
  (self_attention_mask): SelfAttentionMask()
  (encoder_stack): ModuleList(
    (0-5): 6 x TransformerLayer(
      (self_attn): MultiheadAttention(
        (out_proj): Linear(in_features=512, out_features=512, bias=True)
      )
      (fc1): Linear(in_features=512, out_features=2048, bias=True)
      (fc2): Linear(in_features=2048, out_features=512, bias=True)
      (attn_layer_norm): LayerNorm()
      (ff_layer_norm): LayerNorm()
    )
  )
  (decoder_stack): ModuleList(
    (0-5): 6 x TransformerLayer(
      (self_attn): MultiheadAttention(
        (out_proj): Linear(in_features=512, out_features=512, bias=True)
      )
      (fc1): Linear(in_features=512, out_features=2048, bias=True)
      (fc2): Linear(in_features=2048, out_features=512, bias=True)
      (attn_layer_norm): LayerNorm()
      (ff_layer_norm): LayerNorm()
      (external_attn): MultiheadAttention(
        (out_proj): Linear(in_features=512, out_features=512, bias=True)
      )
      (external_layer_norm): LayerNorm()
    )
  )
  (out_tok_embed): Linear(in_features=512, out_features=21135, bias=True)
)
Fri 11 Oct 2024 07:34:00 INFO train_batch_nums: 14838
Fri 11 Oct 2024 07:34:00 INFO start training...
Fri 11 Oct 2024 07:37:21 INFO epoch [  6] train time 0h 3m 20s |  loss |[0.414]
Fri 11 Oct 2024 07:40:47 INFO epoch [  7] train time 0h 3m 21s |  loss |[0.382]
Fri 11 Oct 2024 07:44:10 INFO epoch [  8] train time 0h 3m 19s |  loss |[0.357]
Fri 11 Oct 2024 07:47:35 INFO epoch [  9] train time 0h 3m 21s |  loss |[0.330]
Fri 11 Oct 2024 07:50:57 INFO epoch [ 10] train time 0h 3m 18s |  loss |[0.309]
Fri 11 Oct 2024 08:03:00 INFO ---------- valid total [500] | valid precision [0.514] | valid recall [0.018] | valid f0.5 [0.017] | valid time 0h 12m 3s
Fri 11 Oct 2024 08:15:05 INFO ---------- test total [500] | test precision [0.410] | test recall [0.026] | test f0.5 [0.023] | test time 0h 12m 5s
Fri 11 Oct 2024 08:18:35 INFO epoch [ 11] train time 0h 3m 25s |  loss |[0.296]
Fri 11 Oct 2024 08:22:00 INFO epoch [ 12] train time 0h 3m 21s |  loss |[0.282]
Fri 11 Oct 2024 08:25:26 INFO epoch [ 13] train time 0h 3m 22s |  loss |[0.271]
Fri 11 Oct 2024 08:28:58 INFO epoch [ 14] train time 0h 3m 28s |  loss |[0.261]
Fri 11 Oct 2024 08:32:24 INFO epoch [ 15] train time 0h 3m 22s |  loss |[0.253]
Fri 11 Oct 2024 08:35:50 INFO epoch [ 16] train time 0h 3m 23s |  loss |[0.248]
Fri 11 Oct 2024 08:39:20 INFO epoch [ 17] train time 0h 3m 26s |  loss |[0.243]
Fri 11 Oct 2024 08:42:43 INFO epoch [ 18] train time 0h 3m 20s |  loss |[0.237]
Fri 11 Oct 2024 08:46:06 INFO epoch [ 19] train time 0h 3m 20s |  loss |[0.233]
Fri 11 Oct 2024 08:49:32 INFO epoch [ 20] train time 0h 3m 22s |  loss |[0.230]
Fri 11 Oct 2024 09:01:58 INFO ---------- valid total [500] | valid precision [0.799] | valid recall [0.030] | valid f0.5 [0.036] | valid time 0h 12m 25s
Fri 11 Oct 2024 09:15:15 INFO ---------- test total [500] | test precision [0.691] | test recall [0.022] | test f0.5 [0.027] | test time 0h 13m 17s
Fri 11 Oct 2024 09:18:40 INFO epoch [ 21] train time 0h 3m 20s |  loss |[0.223]
Fri 11 Oct 2024 09:22:07 INFO epoch [ 22] train time 0h 3m 23s |  loss |[0.223]
Fri 11 Oct 2024 09:25:33 INFO epoch [ 23] train time 0h 3m 23s |  loss |[0.219]
Fri 11 Oct 2024 09:28:55 INFO epoch [ 24] train time 0h 3m 19s |  loss |[0.217]
Fri 11 Oct 2024 09:32:19 INFO epoch [ 25] train time 0h 3m 20s |  loss |[0.213]
Fri 11 Oct 2024 09:35:43 INFO epoch [ 26] train time 0h 3m 20s |  loss |[0.211]
Fri 11 Oct 2024 09:39:05 INFO epoch [ 27] train time 0h 3m 19s |  loss |[0.208]
Fri 11 Oct 2024 09:42:27 INFO epoch [ 28] train time 0h 3m 19s |  loss |[0.206]
Fri 11 Oct 2024 09:45:50 INFO epoch [ 29] train time 0h 3m 20s |  loss |[0.205]
Fri 11 Oct 2024 09:49:11 INFO epoch [ 30] train time 0h 3m 17s |  loss |[0.203]
Fri 11 Oct 2024 10:01:14 INFO ---------- valid total [500] | valid precision [0.758] | valid recall [0.032] | valid f0.5 [0.040] | valid time 0h 12m 3s
Fri 11 Oct 2024 10:13:56 INFO ---------- test total [500] | test precision [0.603] | test recall [0.044] | test f0.5 [0.038] | test time 0h 12m 42s
Fri 11 Oct 2024 10:17:17 INFO epoch [ 31] train time 0h 3m 16s |  loss |[0.201]
Fri 11 Oct 2024 10:20:36 INFO epoch [ 32] train time 0h 3m 17s |  loss |[0.199]
Fri 11 Oct 2024 10:23:55 INFO epoch [ 33] train time 0h 3m 17s |  loss |[0.198]
Fri 11 Oct 2024 10:27:14 INFO epoch [ 34] train time 0h 3m 16s |  loss |[0.196]
Fri 11 Oct 2024 10:30:34 INFO epoch [ 35] train time 0h 3m 17s |  loss |[0.194]
Fri 11 Oct 2024 10:33:55 INFO epoch [ 36] train time 0h 3m 18s |  loss |[0.192]
Fri 11 Oct 2024 10:37:17 INFO epoch [ 37] train time 0h 3m 19s |  loss |[0.192]
Fri 11 Oct 2024 10:40:36 INFO epoch [ 38] train time 0h 3m 17s |  loss |[0.190]
Fri 11 Oct 2024 10:43:57 INFO epoch [ 39] train time 0h 3m 18s |  loss |[0.189]
Fri 11 Oct 2024 10:47:17 INFO epoch [ 40] train time 0h 3m 18s |  loss |[0.188]
Fri 11 Oct 2024 10:58:32 INFO ---------- valid total [500] | valid precision [0.735] | valid recall [0.039] | valid f0.5 [0.048] | valid time 0h 11m 15s
Fri 11 Oct 2024 11:10:48 INFO ---------- test total [500] | test precision [0.607] | test recall [0.049] | test f0.5 [0.042] | test time 0h 12m 15s
Fri 11 Oct 2024 11:14:09 INFO epoch [ 41] train time 0h 3m 17s |  loss |[0.186]
Fri 11 Oct 2024 11:17:28 INFO epoch [ 42] train time 0h 3m 16s |  loss |[0.186]
Fri 11 Oct 2024 11:20:46 INFO epoch [ 43] train time 0h 3m 16s |  loss |[0.186]
Fri 11 Oct 2024 11:24:08 INFO epoch [ 44] train time 0h 3m 19s |  loss |[0.184]
Fri 11 Oct 2024 11:27:28 INFO epoch [ 45] train time 0h 3m 17s |  loss |[0.184]
Fri 11 Oct 2024 11:30:48 INFO epoch [ 46] train time 0h 3m 18s |  loss |[0.180]
Fri 11 Oct 2024 11:34:08 INFO epoch [ 47] train time 0h 3m 17s |  loss |[0.181]
Fri 11 Oct 2024 11:37:26 INFO epoch [ 48] train time 0h 3m 16s |  loss |[0.179]
Fri 11 Oct 2024 11:40:45 INFO epoch [ 49] train time 0h 3m 17s |  loss |[0.179]
Fri 11 Oct 2024 11:44:03 INFO epoch [ 50] train time 0h 3m 14s |  loss |[0.179]
Fri 11 Oct 2024 11:55:24 INFO ---------- valid total [500] | valid precision [0.742] | valid recall [0.048] | valid f0.5 [0.061] | valid time 0h 11m 21s
Fri 11 Oct 2024 12:06:59 INFO ---------- test total [500] | test precision [0.702] | test recall [0.038] | test f0.5 [0.047] | test time 0h 11m 35s
Fri 11 Oct 2024 12:10:19 INFO epoch [ 51] train time 0h 3m 16s |  loss |[0.178]
Fri 11 Oct 2024 12:13:40 INFO epoch [ 52] train time 0h 3m 18s |  loss |[0.177]
Fri 11 Oct 2024 12:17:03 INFO epoch [ 53] train time 0h 3m 20s |  loss |[0.175]
Fri 11 Oct 2024 12:20:21 INFO epoch [ 54] train time 0h 3m 15s |  loss |[0.176]
Fri 11 Oct 2024 12:23:41 INFO epoch [ 55] train time 0h 3m 17s |  loss |[0.174]
Fri 11 Oct 2024 12:27:01 INFO epoch [ 56] train time 0h 3m 17s |  loss |[0.173]
Fri 11 Oct 2024 12:30:20 INFO epoch [ 57] train time 0h 3m 16s |  loss |[0.173]
Fri 11 Oct 2024 12:33:40 INFO epoch [ 58] train time 0h 3m 17s |  loss |[0.172]
Fri 11 Oct 2024 12:37:00 INFO epoch [ 59] train time 0h 3m 17s |  loss |[0.172]
Fri 11 Oct 2024 12:40:19 INFO epoch [ 60] train time 0h 3m 16s |  loss |[0.169]
Fri 11 Oct 2024 12:51:45 INFO ---------- valid total [500] | valid precision [0.742] | valid recall [0.048] | valid f0.5 [0.065] | valid time 0h 11m 25s
Fri 11 Oct 2024 13:03:50 INFO ---------- test total [500] | test precision [0.693] | test recall [0.044] | test f0.5 [0.055] | test time 0h 12m 4s
Fri 11 Oct 2024 13:07:07 INFO epoch [ 61] train time 0h 3m 14s |  loss |[0.170]
Fri 11 Oct 2024 13:10:26 INFO epoch [ 62] train time 0h 3m 16s |  loss |[0.169]
Fri 11 Oct 2024 13:13:46 INFO epoch [ 63] train time 0h 3m 17s |  loss |[0.169]
Fri 11 Oct 2024 13:17:05 INFO epoch [ 64] train time 0h 3m 16s |  loss |[0.166]
Fri 11 Oct 2024 13:20:25 INFO epoch [ 65] train time 0h 3m 18s |  loss |[0.166]
Fri 11 Oct 2024 13:23:45 INFO epoch [ 66] train time 0h 3m 17s |  loss |[0.166]
Fri 11 Oct 2024 13:27:04 INFO epoch [ 67] train time 0h 3m 16s |  loss |[0.165]
Fri 11 Oct 2024 13:30:23 INFO epoch [ 68] train time 0h 3m 17s |  loss |[0.165]
Fri 11 Oct 2024 13:33:43 INFO epoch [ 69] train time 0h 3m 17s |  loss |[0.164]
Fri 11 Oct 2024 13:37:02 INFO epoch [ 70] train time 0h 3m 16s |  loss |[0.162]
Fri 11 Oct 2024 13:48:53 INFO ---------- valid total [500] | valid precision [0.685] | valid recall [0.041] | valid f0.5 [0.054] | valid time 0h 11m 50s
Fri 11 Oct 2024 14:01:18 INFO ---------- test total [500] | test precision [0.614] | test recall [0.053] | test f0.5 [0.058] | test time 0h 12m 25s
Fri 11 Oct 2024 14:04:38 INFO epoch [ 71] train time 0h 3m 16s |  loss |[0.162]
Fri 11 Oct 2024 14:07:58 INFO epoch [ 72] train time 0h 3m 18s |  loss |[0.162]
Fri 11 Oct 2024 14:11:19 INFO epoch [ 73] train time 0h 3m 18s |  loss |[0.160]
Fri 11 Oct 2024 14:14:39 INFO epoch [ 74] train time 0h 3m 17s |  loss |[0.160]
Fri 11 Oct 2024 14:17:58 INFO epoch [ 75] train time 0h 3m 16s |  loss |[0.160]
Fri 11 Oct 2024 14:21:17 INFO epoch [ 76] train time 0h 3m 16s |  loss |[0.160]
Fri 11 Oct 2024 14:24:38 INFO epoch [ 77] train time 0h 3m 18s |  loss |[0.159]
Fri 11 Oct 2024 14:27:58 INFO epoch [ 78] train time 0h 3m 17s |  loss |[0.159]
Fri 11 Oct 2024 14:31:19 INFO epoch [ 79] train time 0h 3m 18s |  loss |[0.157]
Fri 11 Oct 2024 14:34:40 INFO epoch [ 80] train time 0h 3m 17s |  loss |[0.157]
Fri 11 Oct 2024 14:46:27 INFO ---------- valid total [500] | valid precision [0.689] | valid recall [0.042] | valid f0.5 [0.054] | valid time 0h 11m 47s
Fri 11 Oct 2024 14:59:04 INFO ---------- test total [500] | test precision [0.601] | test recall [0.068] | test f0.5 [0.069] | test time 0h 12m 37s
Fri 11 Oct 2024 15:02:24 INFO epoch [ 81] train time 0h 3m 17s |  loss |[0.157]
Fri 11 Oct 2024 15:05:44 INFO epoch [ 82] train time 0h 3m 16s |  loss |[0.156]
Fri 11 Oct 2024 15:09:04 INFO epoch [ 83] train time 0h 3m 17s |  loss |[0.157]
Fri 11 Oct 2024 15:12:25 INFO epoch [ 84] train time 0h 3m 18s |  loss |[0.155]
Fri 11 Oct 2024 15:15:43 INFO epoch [ 85] train time 0h 3m 15s |  loss |[0.156]
Fri 11 Oct 2024 15:19:04 INFO epoch [ 86] train time 0h 3m 17s |  loss |[0.153]
Fri 11 Oct 2024 15:22:23 INFO epoch [ 87] train time 0h 3m 16s |  loss |[0.154]
Fri 11 Oct 2024 15:25:43 INFO epoch [ 88] train time 0h 3m 17s |  loss |[0.153]
Fri 11 Oct 2024 15:29:03 INFO epoch [ 89] train time 0h 3m 17s |  loss |[0.152]
Fri 11 Oct 2024 15:32:23 INFO epoch [ 90] train time 0h 3m 17s |  loss |[0.152]
Fri 11 Oct 2024 15:43:59 INFO ---------- valid total [500] | valid precision [0.643] | valid recall [0.088] | valid f0.5 [0.096] | valid time 0h 11m 36s
Fri 11 Oct 2024 15:55:58 INFO ---------- test total [500] | test precision [0.694] | test recall [0.054] | test f0.5 [0.069] | test time 0h 11m 58s
Fri 11 Oct 2024 15:59:18 INFO epoch [ 91] train time 0h 3m 15s |  loss |[0.152]
Fri 11 Oct 2024 16:02:39 INFO epoch [ 92] train time 0h 3m 18s |  loss |[0.151]
Fri 11 Oct 2024 16:06:00 INFO epoch [ 93] train time 0h 3m 17s |  loss |[0.152]
Fri 11 Oct 2024 16:09:22 INFO epoch [ 94] train time 0h 3m 19s |  loss |[0.150]
Fri 11 Oct 2024 16:12:43 INFO epoch [ 95] train time 0h 3m 17s |  loss |[0.150]
Fri 11 Oct 2024 16:16:04 INFO epoch [ 96] train time 0h 3m 18s |  loss |[0.152]
Fri 11 Oct 2024 16:27:39 INFO ---------- valid total [500] | valid precision [0.674] | valid recall [0.098] | valid f0.5 [0.107] | valid time 0h 11m 35s
Fri 11 Oct 2024 16:40:04 INFO ---------- test total [500] | test precision [0.675] | test recall [0.062] | test f0.5 [0.081] | test time 0h 12m 25s
Fri 11 Oct 2024 16:43:23 INFO epoch [ 97] train time 0h 3m 14s |  loss |[0.148]
Fri 11 Oct 2024 16:55:24 INFO ---------- valid total [500] | valid precision [0.632] | valid recall [0.054] | valid f0.5 [0.072] | valid time 0h 12m 1s
Fri 11 Oct 2024 17:08:03 INFO ---------- test total [500] | test precision [0.582] | test recall [0.063] | test f0.5 [0.066] | test time 0h 12m 39s
Fri 11 Oct 2024 17:11:23 INFO epoch [ 98] train time 0h 3m 17s |  loss |[0.150]
Fri 11 Oct 2024 17:23:04 INFO ---------- valid total [500] | valid precision [0.826] | valid recall [0.041] | valid f0.5 [0.047] | valid time 0h 11m 40s
Fri 11 Oct 2024 17:35:50 INFO ---------- test total [500] | test precision [0.623] | test recall [0.067] | test f0.5 [0.068] | test time 0h 12m 46s
Fri 11 Oct 2024 17:39:11 INFO epoch [ 99] train time 0h 3m 17s |  loss |[0.149]
Fri 11 Oct 2024 17:50:45 INFO ---------- valid total [500] | valid precision [0.757] | valid recall [0.043] | valid f0.5 [0.049] | valid time 0h 11m 34s
Fri 11 Oct 2024 18:02:47 INFO ---------- test total [500] | test precision [0.688] | test recall [0.059] | test f0.5 [0.073] | test time 0h 12m 1s
Fri 11 Oct 2024 18:06:07 INFO epoch [100] train time 0h 3m 17s |  loss |[0.149]
Fri 11 Oct 2024 18:17:53 INFO ---------- valid total [500] | valid precision [0.712] | valid recall [0.053] | valid f0.5 [0.064] | valid time 0h 11m 45s
Fri 11 Oct 2024 18:30:20 INFO ---------- test total [500] | test precision [0.677] | test recall [0.067] | test f0.5 [0.081] | test time 0h 12m 27s
Fri 11 Oct 2024 18:30:20 INFO training finished.
                            best valid result: precision [0.674] | recall [0.098] | F0.5 [0.107]
                            best test result : precision [0.675] | recall [0.062] | F0.5 [0.081]
Fri 11 Oct 2024 21:55:25 INFO random_seed=2024
use_gpu=True
learning_rate=6e-06
train_batch_size=32
test_batch_size=1
epoch_nums=200
test_step=10
display_train_step=1
gpu_id=5
training_resume=True
load_best_config=False
supervising_mode=fully_supervised
validset_divide=True
test_only=False
shuffle=True
model_config_file=gectoolkit/properties/model/Transformer.json
best_config_file=gectoolkit/properties/best_config/Transformer_nlpcc18.json
dataset_config_file=gectoolkit/properties/dataset/nlpcc18.json
dataset_dir=dataset/nlpcc18
checkpoint_file=checkpoint/Transformer-nlpcc18.pth
log_file=log/Transformer-nlpcc18.log
output_dir=result/Transformer-nlpcc18
checkpoint_dir=checkpoint/Transformer-nlpcc18
min_word_keep=5
min_generate_keep=5
language=zh
pretrained_model_path=./gectoolkit/properties/model/Transformer
approx=none
backend=nccl
loss_type=FC_FT_CRF
dropout=0.2
embed_dim=512
hidden_dim=128
ff_embed_dim=2048
max_output_len=100
max_input_len=100
layers=6
gamma=2
num_heads=8
model=Transformer
dataset=nlpcc18
augment=none
map_location=cuda
gpu_nums=1
device=cuda


Fri 11 Oct 2024 21:56:38 INFO Transformer(
  (in_tok_embed): Embedding(21135, 512, padding_idx=0)
  (positional_embed): LearnedPositionalEmbedding(
    (weights): Embedding(1024, 512)
  )
  (self_attention_mask): SelfAttentionMask()
  (encoder_stack): ModuleList(
    (0-5): 6 x TransformerLayer(
      (self_attn): MultiheadAttention(
        (out_proj): Linear(in_features=512, out_features=512, bias=True)
      )
      (fc1): Linear(in_features=512, out_features=2048, bias=True)
      (fc2): Linear(in_features=2048, out_features=512, bias=True)
      (attn_layer_norm): LayerNorm()
      (ff_layer_norm): LayerNorm()
    )
  )
  (decoder_stack): ModuleList(
    (0-5): 6 x TransformerLayer(
      (self_attn): MultiheadAttention(
        (out_proj): Linear(in_features=512, out_features=512, bias=True)
      )
      (fc1): Linear(in_features=512, out_features=2048, bias=True)
      (fc2): Linear(in_features=2048, out_features=512, bias=True)
      (attn_layer_norm): LayerNorm()
      (ff_layer_norm): LayerNorm()
      (external_attn): MultiheadAttention(
        (out_proj): Linear(in_features=512, out_features=512, bias=True)
      )
      (external_layer_norm): LayerNorm()
    )
  )
  (out_tok_embed): Linear(in_features=512, out_features=21135, bias=True)
)
Fri 11 Oct 2024 21:56:38 INFO train_batch_nums: 14838
Fri 11 Oct 2024 21:56:38 INFO start training...
Fri 11 Oct 2024 21:59:59 INFO epoch [ 97] train time 0h 3m 20s |  loss |[0.149]
Fri 11 Oct 2024 22:03:21 INFO epoch [ 98] train time 0h 3m 20s |  loss |[0.148]
Fri 11 Oct 2024 22:06:42 INFO epoch [ 99] train time 0h 3m 18s |  loss |[0.148]
Fri 11 Oct 2024 22:10:07 INFO epoch [100] train time 0h 3m 22s |  loss |[0.146]
Fri 11 Oct 2024 22:21:41 INFO ---------- valid total [500] | valid precision [0.680] | valid recall [0.046] | valid f0.5 [0.057] | valid time 0h 11m 33s
Fri 11 Oct 2024 22:33:20 INFO ---------- test total [500] | test precision [0.716] | test recall [0.054] | test f0.5 [0.068] | test time 0h 11m 39s
Fri 11 Oct 2024 22:36:40 INFO epoch [101] train time 0h 3m 17s |  loss |[0.146]
Fri 11 Oct 2024 22:40:02 INFO epoch [102] train time 0h 3m 18s |  loss |[0.146]
Fri 11 Oct 2024 22:43:24 INFO epoch [103] train time 0h 3m 18s |  loss |[0.146]
Fri 11 Oct 2024 22:46:46 INFO epoch [104] train time 0h 3m 19s |  loss |[0.145]
Fri 11 Oct 2024 22:50:12 INFO epoch [105] train time 0h 3m 22s |  loss |[0.145]
Fri 11 Oct 2024 22:53:33 INFO epoch [106] train time 0h 3m 18s |  loss |[0.144]
Fri 11 Oct 2024 22:56:53 INFO epoch [107] train time 0h 3m 16s |  loss |[0.144]
Fri 11 Oct 2024 23:00:17 INFO epoch [108] train time 0h 3m 21s |  loss |[0.144]
Fri 11 Oct 2024 23:03:39 INFO epoch [109] train time 0h 3m 18s |  loss |[0.143]
Fri 11 Oct 2024 23:06:59 INFO epoch [110] train time 0h 3m 18s |  loss |[0.143]
Fri 11 Oct 2024 23:19:06 INFO ---------- valid total [500] | valid precision [0.691] | valid recall [0.071] | valid f0.5 [0.077] | valid time 0h 12m 6s
Fri 11 Oct 2024 23:32:00 INFO ---------- test total [500] | test precision [0.651] | test recall [0.067] | test f0.5 [0.085] | test time 0h 12m 53s
Fri 11 Oct 2024 23:35:23 INFO epoch [111] train time 0h 3m 20s |  loss |[0.143]
Fri 11 Oct 2024 23:38:47 INFO epoch [112] train time 0h 3m 20s |  loss |[0.140]
Fri 11 Oct 2024 23:42:12 INFO epoch [113] train time 0h 3m 22s |  loss |[0.143]
Fri 11 Oct 2024 23:45:38 INFO epoch [114] train time 0h 3m 22s |  loss |[0.141]
Fri 11 Oct 2024 23:49:02 INFO epoch [115] train time 0h 3m 21s |  loss |[0.142]
Fri 11 Oct 2024 23:52:25 INFO epoch [116] train time 0h 3m 20s |  loss |[0.140]
Fri 11 Oct 2024 23:55:51 INFO epoch [117] train time 0h 3m 23s |  loss |[0.140]
Fri 11 Oct 2024 23:59:14 INFO epoch [118] train time 0h 3m 19s |  loss |[0.139]
Sat 12 Oct 2024 00:02:37 INFO epoch [119] train time 0h 3m 20s |  loss |[0.139]
Sat 12 Oct 2024 00:06:00 INFO epoch [120] train time 0h 3m 19s |  loss |[0.139]
Sat 12 Oct 2024 00:18:06 INFO ---------- valid total [500] | valid precision [0.659] | valid recall [0.059] | valid f0.5 [0.071] | valid time 0h 12m 6s
Sat 12 Oct 2024 00:31:20 INFO ---------- test total [500] | test precision [0.564] | test recall [0.063] | test f0.5 [0.069] | test time 0h 13m 13s
Sat 12 Oct 2024 00:34:40 INFO epoch [121] train time 0h 3m 17s |  loss |[0.138]
Sat 12 Oct 2024 00:38:00 INFO epoch [122] train time 0h 3m 17s |  loss |[0.138]
Sat 12 Oct 2024 00:41:21 INFO epoch [123] train time 0h 3m 17s |  loss |[0.138]
Sat 12 Oct 2024 00:44:42 INFO epoch [124] train time 0h 3m 19s |  loss |[0.138]
Sat 12 Oct 2024 00:48:01 INFO epoch [125] train time 0h 3m 15s |  loss |[0.137]
Sat 12 Oct 2024 00:51:22 INFO epoch [126] train time 0h 3m 17s |  loss |[0.136]
Sat 12 Oct 2024 00:54:43 INFO epoch [127] train time 0h 3m 17s |  loss |[0.135]
Sat 12 Oct 2024 00:58:03 INFO epoch [128] train time 0h 3m 18s |  loss |[0.137]
Sat 12 Oct 2024 01:01:22 INFO epoch [129] train time 0h 3m 16s |  loss |[0.135]
Sat 12 Oct 2024 01:04:43 INFO epoch [130] train time 0h 3m 18s |  loss |[0.135]
Sat 12 Oct 2024 01:16:17 INFO ---------- valid total [500] | valid precision [0.629] | valid recall [0.097] | valid f0.5 [0.110] | valid time 0h 11m 34s
Sat 12 Oct 2024 01:28:42 INFO ---------- test total [500] | test precision [0.566] | test recall [0.076] | test f0.5 [0.075] | test time 0h 12m 24s
Sat 12 Oct 2024 01:32:02 INFO epoch [131] train time 0h 3m 16s |  loss |[0.135]
Sat 12 Oct 2024 01:35:24 INFO epoch [132] train time 0h 3m 19s |  loss |[0.134]
Sat 12 Oct 2024 01:38:43 INFO epoch [133] train time 0h 3m 16s |  loss |[0.134]
Sat 12 Oct 2024 01:42:02 INFO epoch [134] train time 0h 3m 16s |  loss |[0.135]
Sat 12 Oct 2024 01:45:21 INFO epoch [135] train time 0h 3m 16s |  loss |[0.134]
Sat 12 Oct 2024 01:48:40 INFO epoch [136] train time 0h 3m 16s |  loss |[0.135]
Sat 12 Oct 2024 01:52:01 INFO epoch [137] train time 0h 3m 18s |  loss |[0.132]
Sat 12 Oct 2024 01:55:21 INFO epoch [138] train time 0h 3m 17s |  loss |[0.133]
Sat 12 Oct 2024 01:58:40 INFO epoch [139] train time 0h 3m 17s |  loss |[0.132]
Sat 12 Oct 2024 02:02:00 INFO epoch [140] train time 0h 3m 18s |  loss |[0.133]
Sat 12 Oct 2024 02:13:17 INFO ---------- valid total [500] | valid precision [0.664] | valid recall [0.068] | valid f0.5 [0.081] | valid time 0h 11m 16s
Sat 12 Oct 2024 02:24:45 INFO ---------- test total [500] | test precision [0.679] | test recall [0.066] | test f0.5 [0.084] | test time 0h 11m 27s
Sat 12 Oct 2024 02:28:01 INFO epoch [141] train time 0h 3m 13s |  loss |[0.133]
Sat 12 Oct 2024 02:31:20 INFO epoch [142] train time 0h 3m 16s |  loss |[0.132]
Sat 12 Oct 2024 02:34:42 INFO epoch [143] train time 0h 3m 19s |  loss |[0.132]
Sat 12 Oct 2024 02:38:04 INFO epoch [144] train time 0h 3m 19s |  loss |[0.131]
Sat 12 Oct 2024 02:41:22 INFO epoch [145] train time 0h 3m 15s |  loss |[0.132]
Sat 12 Oct 2024 02:44:44 INFO epoch [146] train time 0h 3m 20s |  loss |[0.130]
Sat 12 Oct 2024 02:48:06 INFO epoch [147] train time 0h 3m 19s |  loss |[0.131]
Sat 12 Oct 2024 02:51:29 INFO epoch [148] train time 0h 3m 20s |  loss |[0.130]
Sat 12 Oct 2024 02:54:53 INFO epoch [149] train time 0h 3m 21s |  loss |[0.130]
Sat 12 Oct 2024 02:58:15 INFO epoch [150] train time 0h 3m 19s |  loss |[0.130]
Sat 12 Oct 2024 03:09:45 INFO ---------- valid total [500] | valid precision [0.684] | valid recall [0.075] | valid f0.5 [0.089] | valid time 0h 11m 29s
Sat 12 Oct 2024 03:21:53 INFO ---------- test total [500] | test precision [0.621] | test recall [0.082] | test f0.5 [0.098] | test time 0h 12m 8s
Sat 12 Oct 2024 03:25:19 INFO epoch [151] train time 0h 3m 23s |  loss |[0.128]
Sat 12 Oct 2024 03:28:39 INFO epoch [152] train time 0h 3m 17s |  loss |[0.129]
Sat 12 Oct 2024 03:32:04 INFO epoch [153] train time 0h 3m 22s |  loss |[0.129]
Sat 12 Oct 2024 03:35:29 INFO epoch [154] train time 0h 3m 22s |  loss |[0.129]
Sat 12 Oct 2024 03:38:52 INFO epoch [155] train time 0h 3m 20s |  loss |[0.127]
Sat 12 Oct 2024 03:42:17 INFO epoch [156] train time 0h 3m 22s |  loss |[0.127]
Sat 12 Oct 2024 03:45:40 INFO epoch [157] train time 0h 3m 20s |  loss |[0.128]
Sat 12 Oct 2024 03:49:02 INFO epoch [158] train time 0h 3m 19s |  loss |[0.127]
Sat 12 Oct 2024 03:52:26 INFO epoch [159] train time 0h 3m 21s |  loss |[0.127]
Sat 12 Oct 2024 03:55:48 INFO epoch [160] train time 0h 3m 19s |  loss |[0.127]
Sat 12 Oct 2024 04:07:48 INFO ---------- valid total [500] | valid precision [0.666] | valid recall [0.060] | valid f0.5 [0.073] | valid time 0h 12m 0s
Sat 12 Oct 2024 04:20:18 INFO ---------- test total [500] | test precision [0.537] | test recall [0.069] | test f0.5 [0.074] | test time 0h 12m 29s
Sat 12 Oct 2024 04:23:44 INFO epoch [161] train time 0h 3m 23s |  loss |[0.125]
Sat 12 Oct 2024 04:27:09 INFO epoch [162] train time 0h 3m 22s |  loss |[0.125]
Sat 12 Oct 2024 04:30:31 INFO epoch [163] train time 0h 3m 19s |  loss |[0.126]
Sat 12 Oct 2024 04:33:52 INFO epoch [164] train time 0h 3m 18s |  loss |[0.124]
Sat 12 Oct 2024 04:37:15 INFO epoch [165] train time 0h 3m 19s |  loss |[0.124]
Sat 12 Oct 2024 04:40:36 INFO epoch [166] train time 0h 3m 18s |  loss |[0.125]
Sat 12 Oct 2024 04:43:57 INFO epoch [167] train time 0h 3m 19s |  loss |[0.124]
Sat 12 Oct 2024 04:47:19 INFO epoch [168] train time 0h 3m 18s |  loss |[0.124]
Sat 12 Oct 2024 04:50:42 INFO epoch [169] train time 0h 3m 20s |  loss |[0.125]
Sat 12 Oct 2024 04:54:03 INFO epoch [170] train time 0h 3m 19s |  loss |[0.123]
Sat 12 Oct 2024 05:05:52 INFO ---------- valid total [500] | valid precision [0.605] | valid recall [0.056] | valid f0.5 [0.066] | valid time 0h 11m 48s
Sat 12 Oct 2024 05:18:35 INFO ---------- test total [500] | test precision [0.562] | test recall [0.087] | test f0.5 [0.088] | test time 0h 12m 42s
Sat 12 Oct 2024 05:21:56 INFO epoch [171] train time 0h 3m 18s |  loss |[0.123]
Sat 12 Oct 2024 05:25:15 INFO epoch [172] train time 0h 3m 16s |  loss |[0.123]
Sat 12 Oct 2024 05:28:32 INFO epoch [173] train time 0h 3m 14s |  loss |[0.122]
Sat 12 Oct 2024 05:31:51 INFO epoch [174] train time 0h 3m 16s |  loss |[0.123]
Sat 12 Oct 2024 05:35:09 INFO epoch [175] train time 0h 3m 16s |  loss |[0.122]
Sat 12 Oct 2024 05:38:27 INFO epoch [176] train time 0h 3m 15s |  loss |[0.123]
Sat 12 Oct 2024 05:41:46 INFO epoch [177] train time 0h 3m 15s |  loss |[0.121]
Sat 12 Oct 2024 05:45:03 INFO epoch [178] train time 0h 3m 15s |  loss |[0.122]
Sat 12 Oct 2024 05:48:25 INFO epoch [179] train time 0h 3m 19s |  loss |[0.121]
Sat 12 Oct 2024 05:51:44 INFO epoch [180] train time 0h 3m 16s |  loss |[0.120]
Sat 12 Oct 2024 06:03:18 INFO ---------- valid total [500] | valid precision [0.624] | valid recall [0.109] | valid f0.5 [0.120] | valid time 0h 11m 33s
Sat 12 Oct 2024 06:15:16 INFO ---------- test total [500] | test precision [0.653] | test recall [0.068] | test f0.5 [0.083] | test time 0h 11m 58s
Sat 12 Oct 2024 06:18:36 INFO epoch [181] train time 0h 3m 16s |  loss |[0.121]
Sat 12 Oct 2024 06:21:56 INFO epoch [182] train time 0h 3m 16s |  loss |[0.120]
Sat 12 Oct 2024 06:25:15 INFO epoch [183] train time 0h 3m 17s |  loss |[0.119]
Sat 12 Oct 2024 06:28:35 INFO epoch [184] train time 0h 3m 17s |  loss |[0.121]
Sat 12 Oct 2024 06:31:55 INFO epoch [185] train time 0h 3m 17s |  loss |[0.119]
Sat 12 Oct 2024 06:35:15 INFO epoch [186] train time 0h 3m 16s |  loss |[0.119]
Sat 12 Oct 2024 06:38:34 INFO epoch [187] train time 0h 3m 17s |  loss |[0.121]
Sat 12 Oct 2024 06:41:52 INFO epoch [188] train time 0h 3m 15s |  loss |[0.121]
Sat 12 Oct 2024 06:45:12 INFO epoch [189] train time 0h 3m 17s |  loss |[0.123]
Sat 12 Oct 2024 06:48:32 INFO epoch [190] train time 0h 3m 16s |  loss |[0.122]
Sat 12 Oct 2024 07:00:09 INFO ---------- valid total [500] | valid precision [0.618] | valid recall [0.119] | valid f0.5 [0.132] | valid time 0h 11m 37s
Sat 12 Oct 2024 07:12:35 INFO ---------- test total [500] | test precision [0.602] | test recall [0.088] | test f0.5 [0.103] | test time 0h 12m 26s
Sat 12 Oct 2024 07:15:55 INFO epoch [191] train time 0h 3m 15s |  loss |[0.122]
Sat 12 Oct 2024 07:19:14 INFO epoch [192] train time 0h 3m 16s |  loss |[0.121]
Sat 12 Oct 2024 07:22:33 INFO epoch [193] train time 0h 3m 16s |  loss |[0.121]
Sat 12 Oct 2024 07:25:54 INFO epoch [194] train time 0h 3m 18s |  loss |[0.121]
Sat 12 Oct 2024 07:29:14 INFO epoch [195] train time 0h 3m 16s |  loss |[0.120]
Sat 12 Oct 2024 07:32:33 INFO epoch [196] train time 0h 3m 16s |  loss |[0.120]
Sat 12 Oct 2024 07:44:18 INFO ---------- valid total [500] | valid precision [0.589] | valid recall [0.072] | valid f0.5 [0.095] | valid time 0h 11m 44s
Sat 12 Oct 2024 07:56:46 INFO ---------- test total [500] | test precision [0.544] | test recall [0.081] | test f0.5 [0.086] | test time 0h 12m 28s
Sat 12 Oct 2024 08:00:07 INFO epoch [197] train time 0h 3m 18s |  loss |[0.122]
Sat 12 Oct 2024 08:11:37 INFO ---------- valid total [500] | valid precision [0.748] | valid recall [0.054] | valid f0.5 [0.061] | valid time 0h 11m 30s
Sat 12 Oct 2024 08:24:16 INFO ---------- test total [500] | test precision [0.540] | test recall [0.089] | test f0.5 [0.084] | test time 0h 12m 38s
Sat 12 Oct 2024 08:27:35 INFO epoch [198] train time 0h 3m 16s |  loss |[0.120]
Sat 12 Oct 2024 08:39:01 INFO ---------- valid total [500] | valid precision [0.730] | valid recall [0.050] | valid f0.5 [0.055] | valid time 0h 11m 26s
Sat 12 Oct 2024 08:50:55 INFO ---------- test total [500] | test precision [0.668] | test recall [0.069] | test f0.5 [0.082] | test time 0h 11m 54s
Sat 12 Oct 2024 08:54:14 INFO epoch [199] train time 0h 3m 16s |  loss |[0.120]
Sat 12 Oct 2024 09:05:54 INFO ---------- valid total [500] | valid precision [0.669] | valid recall [0.080] | valid f0.5 [0.095] | valid time 0h 11m 39s
Sat 12 Oct 2024 09:18:17 INFO ---------- test total [500] | test precision [0.629] | test recall [0.087] | test f0.5 [0.105] | test time 0h 12m 22s
Sat 12 Oct 2024 09:21:35 INFO epoch [200] train time 0h 3m 15s |  loss |[0.120]
Sat 12 Oct 2024 09:33:09 INFO ---------- valid total [500] | valid precision [0.684] | valid recall [0.095] | valid f0.5 [0.112] | valid time 0h 11m 33s
Sat 12 Oct 2024 09:45:39 INFO ---------- test total [500] | test precision [0.543] | test recall [0.074] | test f0.5 [0.077] | test time 0h 12m 30s
Sat 12 Oct 2024 09:45:39 INFO training finished.
                            best valid result: precision [0.618] | recall [0.119] | F0.5 [0.132]
                            best test result : precision [0.602] | recall [0.088] | F0.5 [0.103]
Sat 12 Oct 2024 10:15:40 INFO random_seed=2024
use_gpu=True
learning_rate=0.0001
train_batch_size=64
test_batch_size=1
epoch_nums=100
test_step=5
display_train_step=1
gpu_id=5
training_resume=False
load_best_config=False
supervising_mode=fully_supervised
validset_divide=True
test_only=False
shuffle=True
model_config_file=gectoolkit/properties/model/Transformer.json
best_config_file=gectoolkit/properties/best_config/Transformer_nlpcc18.json
dataset_config_file=gectoolkit/properties/dataset/nlpcc18.json
dataset_dir=dataset/nlpcc18
checkpoint_file=checkpoint/Transformer-nlpcc18.pth
log_file=log/Transformer-nlpcc18.log
output_dir=result/Transformer-nlpcc18
checkpoint_dir=checkpoint/Transformer-nlpcc18
min_word_keep=5
min_generate_keep=5
language=zh
pretrained_model_path=./gectoolkit/properties/model/Transformer
approx=none
backend=nccl
loss_type=FC_FT_CRF
dropout=0.2
embed_dim=512
hidden_dim=128
ff_embed_dim=2048
max_output_len=100
max_input_len=100
layers=6
gamma=2
num_heads=8
model=Transformer
dataset=nlpcc18
augment=none
map_location=cuda
gpu_nums=8
device=cuda


Sat 12 Oct 2024 10:23:40 INFO test total [246] | precision [0.570] | recall [0.096] | f0.5 [0.097] | test time 0h 6m 43s
