Sun 08 Sep 2024 02:26:26 INFO random_seed=2023
use_gpu=True
learning_rate=6e-05
train_batch_size=32
test_batch_size=1
epoch_nums=100
test_step=5
display_train_step=1
gpu_id=5
training_resume=False
load_best_config=False
supervising_mode=fully_supervised
validset_divide=True
test_only=False
shuffle=True
model_config_file=gectoolkit/properties/model/SynGEC.json
best_config_file=gectoolkit/properties/best_config/SynGEC_handwritten.json
dataset_config_file=gectoolkit/properties/dataset/handwritten.json
dataset_dir=dataset/handwritten
checkpoint_file=checkpoint/SynGEC-handwritten.pth
log_file=log/SynGEC-handwritten.log
output_dir=result/SynGEC-handwritten
checkpoint_dir=checkpoint/SynGEC-handwritten
min_word_keep=5
min_generate_keep=5
language=zh
fp16_init_scale=128
distributed_port=-1
decoder_embed_path=None
quant_noise_pq_block_size=8
best_checkpoint_metric=loss
cross_self_attention=False
validate_interval=1
tie_adaptive_weights=False
bpe=None
decoder_normalize_before=False
cpu=False
optimizer_overrides={}
quant_noise_pq=0
lr_scheduler=polynomial_decay
no_save_optimizer_state=False
train_subset=train
no_cross_attention=False
distributed_world_size=1
decoder_layerdrop=0
skip_invalid_size_inputs_valid_test=True
lr=[0.0005]
slowmo_momentum=None
log_interval=100
user_dir=./gectoolkit/model/SynGEC/src/src_syngec/syngec_model
min_loss_scale=0.0001
dual_aggregation_freeze=True
decoder_output_dim=1024
curriculum=0
scoring=bleu
optimizer=adam
adam_betas=(0.9,0.999)
share_decoder_input_output_embed=True
fp16_no_flatten_grads=False
distributed_backend=nccl
adaptive_input=False
dpd_suffix=['dpd']
attention_dropout=0.0
fp16=True
pipeline_checkpoint=never
fix_batches_to_gpus=False
fp16_scale_tolerance=0.0
valid_subset=valid
gen_subset=test
no_last_checkpoints=False
decoder_attention_heads=16
distributed_wrapper=DDP
activation_dropout=0.0
log_format=tqdm
decoder_embed_dim=1024
dual_aggregation_beta=0.5
disable_validation=False
quant_noise_scalar=0
use_bmuf=False
gat_encoder_layers=3
arch=syntax_enhanced_bart_large
eval_bleu_print_samples=False
no_scale_embedding=True
zero_sharding=none
pipeline_decoder_devices=None
save_interval_updates=0
localsgd_frequency=3
ignore_prefix_size=0
eval_bleu_args=None
encoder_layerdrop=0
syntax_type=['dep']
distributed_no_spawn=False
left_pad_source=True
decoder_layers=12
adaptive_softmax_cutoff=None
upsample_primary=1
ddp_backend=c10d
validate_after_updates=0
power=1.0
data_buffer_size=10
memory_efficient_bf16=False
num_batch_buckets=0
share_all_embeddings=True
alpha=1.0
gated_sum=False
distributed_init_method=None
report_accuracy=False
end_learning_rate=0.0
batch_size_valid=None
pipeline_devices=None
left_pad_target=False
source_word_dropout_probs=False
bf16=False
swm_suffix=swm
encoder_embed_dim=1024
force_anneal=None
no_epoch_checkpoints=False
syntax_encoder=GCN
encoder_ffn_embed_dim=4096
label_smoothing=0.1
num_shards=1
find_unused_parameters=True
no_progress_bar=False
load_alignments=False
use_old_adam=False
eval_bleu_detok_args=None
tensorboard_logdir=None
slowmo_algorithm=LocalSGD
fast_stat_sync=False
layernorm_embedding=True
encoder_layers_to_keep=None
eval_bleu_remove_bpe=None
scale_syntax_encoder_lr=None
eval_bleu=False
fp16_scale_window=None
pipeline_encoder_balance=None
pipeline_encoder_devices=None
relu_dropout=0.0
threshold_loss_scale=None
activation_fn=gelu
task=syntax-enhanced-translation
target_lang=tgt
bart_model_file_from_transformers=None
all_gather_list_size=16384
stop_time_hours=0
validate_interval_updates=0
save_interval=1
conll_suffix=['conll']
empty_cache_freq=0
encoder_learned_pos=True
tpu=False
nprocs_per_node=1
keep_last_epochs=10
device_id=0
source_lang_with_nt=src_nt
use_dpd=False
pipeline_chunks=0
cross_syntax_fuse=False
keep_interval_updates=-1
encoder_embed_path=None
adam_eps=1e-08
model_parallel_size=1
sentence_avg=False
encoder_layers=12
decoder_ffn_embed_dim=4096
dataset_impl=None
criterion=label_smoothed_cross_entropy
fixed_validation_seed=None
profile=False
distributed_rank=0
source_lang=src
eval_tokenized_bleu=False
source_word_dropout=0.2
adaptive_softmax_dropout=0
syntax_model_file=None
checkpoint_suffix=
required_seq_len_multiple=1
no_save=False
use_syntax=True
probs_suffix=['probs']
decoder_learned_pos=True
decoder_input_dim=1024
memory_efficient_fp16=False
decoder_layers_to_keep=None
gat_attention_heads=4
bucket_cap_mb=25
checkpoint_shard_count=1
pipeline_model_parallel=False
encoder_normalize_before=False
keep_best_checkpoints=-1
no_token_positional_embeddings=False
pooler_activation_fn=tanh
shard_id=0
only_dsa=False
max_update=0
encoder_attention_heads=16
freeze_bart_parameters=True
tokenizer=None
total_num_update=1000000
pipeline_decoder_balance=None
quantization_config_path=None
broadcast_buffers=False
batch_size=None
maximize_best_checkpoint_metric=False
pooler_dropout=0.0
warmup_updates=2000
min_lr=-1.0
only_gnn=True
eval_bleu_detok=space
no_seed_provided=False
truncate_source=False
pipeline_balance=None
model=SynGEC
dataset=handwritten
augment=none
device=cuda
map_location=cuda
gpu_nums=8


Sun 08 Sep 2024 08:52:03 INFO random_seed=2023
use_gpu=True
learning_rate=6e-05
train_batch_size=32
test_batch_size=1
epoch_nums=100
test_step=5
display_train_step=1
gpu_id=5
training_resume=False
load_best_config=False
supervising_mode=fully_supervised
validset_divide=True
test_only=False
shuffle=True
model_config_file=gectoolkit/properties/model/SynGEC.json
best_config_file=gectoolkit/properties/best_config/SynGEC_handwritten.json
dataset_config_file=gectoolkit/properties/dataset/handwritten.json
dataset_dir=dataset/handwritten
checkpoint_file=checkpoint/SynGEC-handwritten.pth
log_file=log/SynGEC-handwritten.log
output_dir=result/SynGEC-handwritten
checkpoint_dir=checkpoint/SynGEC-handwritten
min_word_keep=5
min_generate_keep=5
language=zh
fp16_init_scale=128
distributed_port=-1
decoder_embed_path=None
quant_noise_pq_block_size=8
best_checkpoint_metric=loss
cross_self_attention=False
validate_interval=1
tie_adaptive_weights=False
bpe=None
decoder_normalize_before=False
cpu=False
optimizer_overrides={}
quant_noise_pq=0
lr_scheduler=polynomial_decay
no_save_optimizer_state=False
train_subset=train
no_cross_attention=False
distributed_world_size=1
decoder_layerdrop=0
skip_invalid_size_inputs_valid_test=True
lr=[0.0005]
slowmo_momentum=None
log_interval=100
user_dir=./gectoolkit/model/SynGEC/src/src_syngec/syngec_model
min_loss_scale=0.0001
dual_aggregation_freeze=True
decoder_output_dim=1024
curriculum=0
scoring=bleu
optimizer=adam
adam_betas=(0.9,0.999)
share_decoder_input_output_embed=True
fp16_no_flatten_grads=False
distributed_backend=nccl
adaptive_input=False
dpd_suffix=['dpd']
attention_dropout=0.0
fp16=True
pipeline_checkpoint=never
fix_batches_to_gpus=False
fp16_scale_tolerance=0.0
valid_subset=valid
gen_subset=test
no_last_checkpoints=False
decoder_attention_heads=16
distributed_wrapper=DDP
activation_dropout=0.0
log_format=tqdm
decoder_embed_dim=1024
dual_aggregation_beta=0.5
disable_validation=False
quant_noise_scalar=0
use_bmuf=False
gat_encoder_layers=3
arch=syntax_enhanced_bart_large
eval_bleu_print_samples=False
no_scale_embedding=True
zero_sharding=none
pipeline_decoder_devices=None
save_interval_updates=0
localsgd_frequency=3
ignore_prefix_size=0
eval_bleu_args=None
encoder_layerdrop=0
syntax_type=['dep']
distributed_no_spawn=False
left_pad_source=True
decoder_layers=12
adaptive_softmax_cutoff=None
upsample_primary=1
ddp_backend=c10d
validate_after_updates=0
power=1.0
data_buffer_size=10
memory_efficient_bf16=False
num_batch_buckets=0
share_all_embeddings=True
alpha=1.0
gated_sum=False
distributed_init_method=None
report_accuracy=False
end_learning_rate=0.0
batch_size_valid=None
pipeline_devices=None
left_pad_target=False
source_word_dropout_probs=False
bf16=False
swm_suffix=swm
encoder_embed_dim=1024
force_anneal=None
no_epoch_checkpoints=False
syntax_encoder=GCN
encoder_ffn_embed_dim=4096
label_smoothing=0.1
num_shards=1
find_unused_parameters=True
no_progress_bar=False
load_alignments=False
use_old_adam=False
eval_bleu_detok_args=None
tensorboard_logdir=None
slowmo_algorithm=LocalSGD
fast_stat_sync=False
layernorm_embedding=True
encoder_layers_to_keep=None
eval_bleu_remove_bpe=None
scale_syntax_encoder_lr=None
eval_bleu=False
fp16_scale_window=None
pipeline_encoder_balance=None
pipeline_encoder_devices=None
relu_dropout=0.0
threshold_loss_scale=None
activation_fn=gelu
task=syntax-enhanced-translation
target_lang=tgt
bart_model_file_from_transformers=None
all_gather_list_size=16384
stop_time_hours=0
validate_interval_updates=0
save_interval=1
conll_suffix=['conll']
empty_cache_freq=0
encoder_learned_pos=True
tpu=False
nprocs_per_node=1
keep_last_epochs=10
device_id=0
source_lang_with_nt=src_nt
use_dpd=False
pipeline_chunks=0
cross_syntax_fuse=False
keep_interval_updates=-1
encoder_embed_path=None
adam_eps=1e-08
model_parallel_size=1
sentence_avg=False
encoder_layers=12
decoder_ffn_embed_dim=4096
dataset_impl=None
criterion=label_smoothed_cross_entropy
fixed_validation_seed=None
profile=False
distributed_rank=0
source_lang=src
eval_tokenized_bleu=False
source_word_dropout=0.2
adaptive_softmax_dropout=0
syntax_model_file=None
checkpoint_suffix=
required_seq_len_multiple=1
no_save=False
use_syntax=True
probs_suffix=['probs']
decoder_learned_pos=True
decoder_input_dim=1024
memory_efficient_fp16=False
decoder_layers_to_keep=None
gat_attention_heads=4
bucket_cap_mb=25
checkpoint_shard_count=1
pipeline_model_parallel=False
encoder_normalize_before=False
keep_best_checkpoints=-1
no_token_positional_embeddings=False
pooler_activation_fn=tanh
shard_id=0
only_dsa=False
max_update=0
encoder_attention_heads=16
freeze_bart_parameters=True
tokenizer=None
total_num_update=1000000
pipeline_decoder_balance=None
quantization_config_path=None
broadcast_buffers=False
batch_size=None
maximize_best_checkpoint_metric=False
pooler_dropout=0.0
warmup_updates=2000
min_lr=-1.0
only_gnn=True
eval_bleu_detok=space
no_seed_provided=False
truncate_source=False
pipeline_balance=None
model=SynGEC
dataset=handwritten
augment=none
device=cuda
map_location=cuda
gpu_nums=8


Sun 08 Sep 2024 08:57:41 INFO random_seed=2023
use_gpu=True
learning_rate=6e-05
train_batch_size=32
test_batch_size=1
epoch_nums=100
test_step=5
display_train_step=1
gpu_id=5
training_resume=False
load_best_config=False
supervising_mode=fully_supervised
validset_divide=True
test_only=False
shuffle=True
model_config_file=gectoolkit/properties/model/SynGEC.json
best_config_file=gectoolkit/properties/best_config/SynGEC_handwritten.json
dataset_config_file=gectoolkit/properties/dataset/handwritten.json
dataset_dir=dataset/handwritten
checkpoint_file=checkpoint/SynGEC-handwritten.pth
log_file=log/SynGEC-handwritten.log
output_dir=result/SynGEC-handwritten
checkpoint_dir=checkpoint/SynGEC-handwritten
min_word_keep=5
min_generate_keep=5
language=zh
fp16_init_scale=128
distributed_port=-1
decoder_embed_path=None
quant_noise_pq_block_size=8
best_checkpoint_metric=loss
cross_self_attention=False
validate_interval=1
tie_adaptive_weights=False
bpe=None
decoder_normalize_before=False
cpu=False
optimizer_overrides={}
quant_noise_pq=0
lr_scheduler=polynomial_decay
no_save_optimizer_state=False
train_subset=train
no_cross_attention=False
distributed_world_size=1
decoder_layerdrop=0
skip_invalid_size_inputs_valid_test=True
lr=[0.0005]
slowmo_momentum=None
log_interval=100
user_dir=./gectoolkit/model/SynGEC/src/src_syngec/syngec_model
min_loss_scale=0.0001
dual_aggregation_freeze=True
decoder_output_dim=1024
curriculum=0
scoring=bleu
optimizer=adam
adam_betas=(0.9,0.999)
share_decoder_input_output_embed=True
fp16_no_flatten_grads=False
distributed_backend=nccl
adaptive_input=False
dpd_suffix=['dpd']
attention_dropout=0.0
fp16=True
pipeline_checkpoint=never
fix_batches_to_gpus=False
fp16_scale_tolerance=0.0
valid_subset=valid
gen_subset=test
no_last_checkpoints=False
decoder_attention_heads=16
distributed_wrapper=DDP
activation_dropout=0.0
log_format=tqdm
decoder_embed_dim=1024
dual_aggregation_beta=0.5
disable_validation=False
quant_noise_scalar=0
use_bmuf=False
gat_encoder_layers=3
arch=syntax_enhanced_bart_large
eval_bleu_print_samples=False
no_scale_embedding=True
zero_sharding=none
pipeline_decoder_devices=None
save_interval_updates=0
localsgd_frequency=3
ignore_prefix_size=0
eval_bleu_args=None
encoder_layerdrop=0
syntax_type=['dep']
distributed_no_spawn=False
left_pad_source=True
decoder_layers=12
adaptive_softmax_cutoff=None
upsample_primary=1
ddp_backend=c10d
validate_after_updates=0
power=1.0
data_buffer_size=10
memory_efficient_bf16=False
num_batch_buckets=0
share_all_embeddings=True
alpha=1.0
gated_sum=False
distributed_init_method=None
report_accuracy=False
end_learning_rate=0.0
batch_size_valid=None
pipeline_devices=None
left_pad_target=False
source_word_dropout_probs=False
bf16=False
swm_suffix=swm
encoder_embed_dim=1024
force_anneal=None
no_epoch_checkpoints=False
syntax_encoder=GCN
encoder_ffn_embed_dim=4096
label_smoothing=0.1
num_shards=1
find_unused_parameters=True
no_progress_bar=False
load_alignments=False
use_old_adam=False
eval_bleu_detok_args=None
tensorboard_logdir=None
slowmo_algorithm=LocalSGD
fast_stat_sync=False
layernorm_embedding=True
encoder_layers_to_keep=None
eval_bleu_remove_bpe=None
scale_syntax_encoder_lr=None
eval_bleu=False
fp16_scale_window=None
pipeline_encoder_balance=None
pipeline_encoder_devices=None
relu_dropout=0.0
threshold_loss_scale=None
activation_fn=gelu
task=syntax-enhanced-translation
target_lang=tgt
bart_model_file_from_transformers=None
all_gather_list_size=16384
stop_time_hours=0
validate_interval_updates=0
save_interval=1
conll_suffix=['conll']
empty_cache_freq=0
encoder_learned_pos=True
tpu=False
nprocs_per_node=1
keep_last_epochs=10
device_id=0
source_lang_with_nt=src_nt
use_dpd=False
pipeline_chunks=0
cross_syntax_fuse=False
keep_interval_updates=-1
encoder_embed_path=None
adam_eps=1e-08
model_parallel_size=1
sentence_avg=False
encoder_layers=12
decoder_ffn_embed_dim=4096
dataset_impl=None
criterion=label_smoothed_cross_entropy
fixed_validation_seed=None
profile=False
distributed_rank=0
source_lang=src
eval_tokenized_bleu=False
source_word_dropout=0.2
adaptive_softmax_dropout=0
syntax_model_file=None
checkpoint_suffix=
required_seq_len_multiple=1
no_save=False
use_syntax=True
probs_suffix=['probs']
decoder_learned_pos=True
decoder_input_dim=1024
memory_efficient_fp16=False
decoder_layers_to_keep=None
gat_attention_heads=4
bucket_cap_mb=25
checkpoint_shard_count=1
pipeline_model_parallel=False
encoder_normalize_before=False
keep_best_checkpoints=-1
no_token_positional_embeddings=False
pooler_activation_fn=tanh
shard_id=0
only_dsa=False
max_update=0
encoder_attention_heads=16
freeze_bart_parameters=True
tokenizer=None
total_num_update=1000000
pipeline_decoder_balance=None
quantization_config_path=None
broadcast_buffers=False
batch_size=None
maximize_best_checkpoint_metric=False
pooler_dropout=0.0
warmup_updates=2000
min_lr=-1.0
only_gnn=True
eval_bleu_detok=space
no_seed_provided=False
truncate_source=False
pipeline_balance=None
model=SynGEC
dataset=handwritten
augment=none
device=cuda
map_location=cuda
gpu_nums=8


Sun 08 Sep 2024 08:57:41 INFO [src] dictionary: 21132 types
Sun 08 Sep 2024 08:57:41 INFO [tgt] dictionary: 21132 types
Sun 08 Sep 2024 08:57:41 INFO [syntax label0] dictionary: 51 types
Sun 08 Sep 2024 08:57:41 INFO [src] dictionary: 21132 types
Sun 08 Sep 2024 08:57:41 INFO [tgt] dictionary: 21132 types
Sun 08 Sep 2024 08:57:41 INFO [syntax label0] dictionary: 51 types
Sun 08 Sep 2024 08:57:41 INFO loaded 123 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/valid.src-tgt.src
Sun 08 Sep 2024 08:57:41 INFO loaded 123 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/valid.src-tgt.tgt
Sun 08 Sep 2024 08:57:41 INFO ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin valid src-tgt 123 examples
Sun 08 Sep 2024 08:57:41 INFO loaded 123 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/valid.conll.src-tgt.src
Sun 08 Sep 2024 08:57:41 INFO loaded 123 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/valid.dpd.src-tgt.src
Sun 08 Sep 2024 08:57:41 INFO loaded 123 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/valid.probs.src-tgt.src
Sun 08 Sep 2024 08:57:41 INFO success! syntax types: 1, source conll lines: 123
Sun 08 Sep 2024 08:57:41 INFO loaded 981 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/train.src-tgt.src
Sun 08 Sep 2024 08:57:41 INFO loaded 981 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/train.src-tgt.tgt
Sun 08 Sep 2024 08:57:41 INFO ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin train src-tgt 981 examples
Sun 08 Sep 2024 08:57:41 INFO loaded 981 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/train.conll.src-tgt.src
Sun 08 Sep 2024 08:57:41 INFO loaded 981 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/train.dpd.src-tgt.src
Sun 08 Sep 2024 08:57:41 INFO loaded 981 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/train.probs.src-tgt.src
Sun 08 Sep 2024 08:57:41 INFO success! syntax types: 1, source conll lines: 981
Sun 08 Sep 2024 08:57:41 INFO loaded 123 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_test_with_syntax_bart/bin/test.conll.src-tgt.src
Sun 08 Sep 2024 08:57:41 INFO loaded 123 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_test_with_syntax_bart/bin/test.dpd.src-tgt.src
Sun 08 Sep 2024 08:57:41 INFO loaded 123 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_test_with_syntax_bart/bin/test.probs.src-tgt.src
Sun 08 Sep 2024 09:01:17 INFO random_seed=2023
use_gpu=True
learning_rate=6e-05
train_batch_size=32
test_batch_size=1
epoch_nums=100
test_step=5
display_train_step=1
gpu_id=5
training_resume=False
load_best_config=False
supervising_mode=fully_supervised
validset_divide=True
test_only=False
shuffle=True
model_config_file=gectoolkit/properties/model/SynGEC.json
best_config_file=gectoolkit/properties/best_config/SynGEC_handwritten.json
dataset_config_file=gectoolkit/properties/dataset/handwritten.json
dataset_dir=dataset/handwritten
checkpoint_file=checkpoint/SynGEC-handwritten.pth
log_file=log/SynGEC-handwritten.log
output_dir=result/SynGEC-handwritten
checkpoint_dir=checkpoint/SynGEC-handwritten
min_word_keep=5
min_generate_keep=5
language=zh
fp16_init_scale=128
distributed_port=-1
decoder_embed_path=None
quant_noise_pq_block_size=8
best_checkpoint_metric=loss
cross_self_attention=False
validate_interval=1
tie_adaptive_weights=False
bpe=None
decoder_normalize_before=False
cpu=False
optimizer_overrides={}
quant_noise_pq=0
lr_scheduler=polynomial_decay
no_save_optimizer_state=False
train_subset=train
no_cross_attention=False
distributed_world_size=1
decoder_layerdrop=0
skip_invalid_size_inputs_valid_test=True
lr=[0.0005]
slowmo_momentum=None
log_interval=100
user_dir=./gectoolkit/model/SynGEC/src/src_syngec/syngec_model
min_loss_scale=0.0001
dual_aggregation_freeze=True
decoder_output_dim=1024
curriculum=0
scoring=bleu
optimizer=adam
adam_betas=(0.9,0.999)
share_decoder_input_output_embed=True
fp16_no_flatten_grads=False
distributed_backend=nccl
adaptive_input=False
dpd_suffix=['dpd']
attention_dropout=0.0
fp16=True
pipeline_checkpoint=never
fix_batches_to_gpus=False
fp16_scale_tolerance=0.0
valid_subset=valid
gen_subset=test
no_last_checkpoints=False
decoder_attention_heads=16
distributed_wrapper=DDP
activation_dropout=0.0
log_format=tqdm
decoder_embed_dim=1024
dual_aggregation_beta=0.5
disable_validation=False
quant_noise_scalar=0
use_bmuf=False
gat_encoder_layers=3
arch=syntax_enhanced_bart_large
eval_bleu_print_samples=False
no_scale_embedding=True
zero_sharding=none
pipeline_decoder_devices=None
save_interval_updates=0
localsgd_frequency=3
ignore_prefix_size=0
eval_bleu_args=None
encoder_layerdrop=0
syntax_type=['dep']
distributed_no_spawn=False
left_pad_source=True
decoder_layers=12
adaptive_softmax_cutoff=None
upsample_primary=1
ddp_backend=c10d
validate_after_updates=0
power=1.0
data_buffer_size=10
memory_efficient_bf16=False
num_batch_buckets=0
share_all_embeddings=True
alpha=1.0
gated_sum=False
distributed_init_method=None
report_accuracy=False
end_learning_rate=0.0
batch_size_valid=None
pipeline_devices=None
left_pad_target=False
source_word_dropout_probs=False
bf16=False
swm_suffix=swm
encoder_embed_dim=1024
force_anneal=None
no_epoch_checkpoints=False
syntax_encoder=GCN
encoder_ffn_embed_dim=4096
label_smoothing=0.1
num_shards=1
find_unused_parameters=True
no_progress_bar=False
load_alignments=False
use_old_adam=False
eval_bleu_detok_args=None
tensorboard_logdir=None
slowmo_algorithm=LocalSGD
fast_stat_sync=False
layernorm_embedding=True
encoder_layers_to_keep=None
eval_bleu_remove_bpe=None
scale_syntax_encoder_lr=None
eval_bleu=False
fp16_scale_window=None
pipeline_encoder_balance=None
pipeline_encoder_devices=None
relu_dropout=0.0
threshold_loss_scale=None
activation_fn=gelu
task=syntax-enhanced-translation
target_lang=tgt
bart_model_file_from_transformers=None
all_gather_list_size=16384
stop_time_hours=0
validate_interval_updates=0
save_interval=1
conll_suffix=['conll']
empty_cache_freq=0
encoder_learned_pos=True
tpu=False
nprocs_per_node=1
keep_last_epochs=10
device_id=0
source_lang_with_nt=src_nt
use_dpd=False
pipeline_chunks=0
cross_syntax_fuse=False
keep_interval_updates=-1
encoder_embed_path=None
adam_eps=1e-08
model_parallel_size=1
sentence_avg=False
encoder_layers=12
decoder_ffn_embed_dim=4096
dataset_impl=None
criterion=label_smoothed_cross_entropy
fixed_validation_seed=None
profile=False
distributed_rank=0
source_lang=src
eval_tokenized_bleu=False
source_word_dropout=0.2
adaptive_softmax_dropout=0
syntax_model_file=None
checkpoint_suffix=
required_seq_len_multiple=1
no_save=False
use_syntax=True
probs_suffix=['probs']
decoder_learned_pos=True
decoder_input_dim=1024
memory_efficient_fp16=False
decoder_layers_to_keep=None
gat_attention_heads=4
bucket_cap_mb=25
checkpoint_shard_count=1
pipeline_model_parallel=False
encoder_normalize_before=False
keep_best_checkpoints=-1
no_token_positional_embeddings=False
pooler_activation_fn=tanh
shard_id=0
only_dsa=False
max_update=0
encoder_attention_heads=16
freeze_bart_parameters=True
tokenizer=None
total_num_update=1000000
pipeline_decoder_balance=None
quantization_config_path=None
broadcast_buffers=False
batch_size=None
maximize_best_checkpoint_metric=False
pooler_dropout=0.0
warmup_updates=2000
min_lr=-1.0
only_gnn=True
eval_bleu_detok=space
no_seed_provided=False
truncate_source=False
pipeline_balance=None
model=SynGEC
dataset=handwritten
augment=none
device=cuda
map_location=cuda
gpu_nums=8


Sun 08 Sep 2024 09:01:17 INFO [src] dictionary: 21132 types
Sun 08 Sep 2024 09:01:17 INFO [tgt] dictionary: 21132 types
Sun 08 Sep 2024 09:01:17 INFO [syntax label0] dictionary: 51 types
Sun 08 Sep 2024 09:01:17 INFO [src] dictionary: 21132 types
Sun 08 Sep 2024 09:01:17 INFO [tgt] dictionary: 21132 types
Sun 08 Sep 2024 09:01:17 INFO [syntax label0] dictionary: 51 types
Sun 08 Sep 2024 09:01:17 INFO loaded 123 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/valid.src-tgt.src
Sun 08 Sep 2024 09:01:17 INFO loaded 123 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/valid.src-tgt.tgt
Sun 08 Sep 2024 09:01:17 INFO ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin valid src-tgt 123 examples
Sun 08 Sep 2024 09:01:17 INFO loaded 123 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/valid.conll.src-tgt.src
Sun 08 Sep 2024 09:01:17 INFO loaded 123 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/valid.dpd.src-tgt.src
Sun 08 Sep 2024 09:01:17 INFO loaded 123 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/valid.probs.src-tgt.src
Sun 08 Sep 2024 09:01:17 INFO success! syntax types: 1, source conll lines: 123
Sun 08 Sep 2024 09:01:17 INFO loaded 981 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/train.src-tgt.src
Sun 08 Sep 2024 09:01:17 INFO loaded 981 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/train.src-tgt.tgt
Sun 08 Sep 2024 09:01:17 INFO ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin train src-tgt 981 examples
Sun 08 Sep 2024 09:01:17 INFO loaded 981 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/train.conll.src-tgt.src
Sun 08 Sep 2024 09:01:17 INFO loaded 981 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/train.dpd.src-tgt.src
Sun 08 Sep 2024 09:01:17 INFO loaded 981 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/train.probs.src-tgt.src
Sun 08 Sep 2024 09:01:17 INFO success! syntax types: 1, source conll lines: 981
Sun 08 Sep 2024 09:01:17 INFO loaded 123 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_test_with_syntax_bart/bin/test.conll.src-tgt.src
Sun 08 Sep 2024 09:01:17 INFO loaded 123 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_test_with_syntax_bart/bin/test.dpd.src-tgt.src
Sun 08 Sep 2024 09:01:17 INFO loaded 123 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_test_with_syntax_bart/bin/test.probs.src-tgt.src
Sun 08 Sep 2024 09:03:02 INFO random_seed=2023
use_gpu=True
learning_rate=6e-05
train_batch_size=32
test_batch_size=1
epoch_nums=100
test_step=5
display_train_step=1
gpu_id=5
training_resume=False
load_best_config=False
supervising_mode=fully_supervised
validset_divide=True
test_only=False
shuffle=True
model_config_file=gectoolkit/properties/model/SynGEC.json
best_config_file=gectoolkit/properties/best_config/SynGEC_handwritten.json
dataset_config_file=gectoolkit/properties/dataset/handwritten.json
dataset_dir=dataset/handwritten
checkpoint_file=checkpoint/SynGEC-handwritten.pth
log_file=log/SynGEC-handwritten.log
output_dir=result/SynGEC-handwritten
checkpoint_dir=checkpoint/SynGEC-handwritten
min_word_keep=5
min_generate_keep=5
language=zh
fp16_init_scale=128
distributed_port=-1
decoder_embed_path=None
quant_noise_pq_block_size=8
best_checkpoint_metric=loss
cross_self_attention=False
validate_interval=1
tie_adaptive_weights=False
bpe=None
decoder_normalize_before=False
cpu=False
optimizer_overrides={}
quant_noise_pq=0
lr_scheduler=polynomial_decay
no_save_optimizer_state=False
train_subset=train
no_cross_attention=False
distributed_world_size=1
decoder_layerdrop=0
skip_invalid_size_inputs_valid_test=True
lr=[0.0005]
slowmo_momentum=None
log_interval=100
user_dir=./gectoolkit/model/SynGEC/src/src_syngec/syngec_model
min_loss_scale=0.0001
dual_aggregation_freeze=True
decoder_output_dim=1024
curriculum=0
scoring=bleu
optimizer=adam
adam_betas=(0.9,0.999)
share_decoder_input_output_embed=True
fp16_no_flatten_grads=False
distributed_backend=nccl
adaptive_input=False
dpd_suffix=['dpd']
attention_dropout=0.0
fp16=True
pipeline_checkpoint=never
fix_batches_to_gpus=False
fp16_scale_tolerance=0.0
valid_subset=valid
gen_subset=test
no_last_checkpoints=False
decoder_attention_heads=16
distributed_wrapper=DDP
activation_dropout=0.0
log_format=tqdm
decoder_embed_dim=1024
dual_aggregation_beta=0.5
disable_validation=False
quant_noise_scalar=0
use_bmuf=False
gat_encoder_layers=3
arch=syntax_enhanced_bart_large
eval_bleu_print_samples=False
no_scale_embedding=True
zero_sharding=none
pipeline_decoder_devices=None
save_interval_updates=0
localsgd_frequency=3
ignore_prefix_size=0
eval_bleu_args=None
encoder_layerdrop=0
syntax_type=['dep']
distributed_no_spawn=False
left_pad_source=True
decoder_layers=12
adaptive_softmax_cutoff=None
upsample_primary=1
ddp_backend=c10d
validate_after_updates=0
power=1.0
data_buffer_size=10
memory_efficient_bf16=False
num_batch_buckets=0
share_all_embeddings=True
alpha=1.0
gated_sum=False
distributed_init_method=None
report_accuracy=False
end_learning_rate=0.0
batch_size_valid=None
pipeline_devices=None
left_pad_target=False
source_word_dropout_probs=False
bf16=False
swm_suffix=swm
encoder_embed_dim=1024
force_anneal=None
no_epoch_checkpoints=False
syntax_encoder=GCN
encoder_ffn_embed_dim=4096
label_smoothing=0.1
num_shards=1
find_unused_parameters=True
no_progress_bar=False
load_alignments=False
use_old_adam=False
eval_bleu_detok_args=None
tensorboard_logdir=None
slowmo_algorithm=LocalSGD
fast_stat_sync=False
layernorm_embedding=True
encoder_layers_to_keep=None
eval_bleu_remove_bpe=None
scale_syntax_encoder_lr=None
eval_bleu=False
fp16_scale_window=None
pipeline_encoder_balance=None
pipeline_encoder_devices=None
relu_dropout=0.0
threshold_loss_scale=None
activation_fn=gelu
task=syntax-enhanced-translation
target_lang=tgt
bart_model_file_from_transformers=None
all_gather_list_size=16384
stop_time_hours=0
validate_interval_updates=0
save_interval=1
conll_suffix=['conll']
empty_cache_freq=0
encoder_learned_pos=True
tpu=False
nprocs_per_node=1
keep_last_epochs=10
device_id=0
source_lang_with_nt=src_nt
use_dpd=False
pipeline_chunks=0
cross_syntax_fuse=False
keep_interval_updates=-1
encoder_embed_path=None
adam_eps=1e-08
model_parallel_size=1
sentence_avg=False
encoder_layers=12
decoder_ffn_embed_dim=4096
dataset_impl=None
criterion=label_smoothed_cross_entropy
fixed_validation_seed=None
profile=False
distributed_rank=0
source_lang=src
eval_tokenized_bleu=False
source_word_dropout=0.2
adaptive_softmax_dropout=0
syntax_model_file=None
checkpoint_suffix=
required_seq_len_multiple=1
no_save=False
use_syntax=True
probs_suffix=['probs']
decoder_learned_pos=True
decoder_input_dim=1024
memory_efficient_fp16=False
decoder_layers_to_keep=None
gat_attention_heads=4
bucket_cap_mb=25
checkpoint_shard_count=1
pipeline_model_parallel=False
encoder_normalize_before=False
keep_best_checkpoints=-1
no_token_positional_embeddings=False
pooler_activation_fn=tanh
shard_id=0
only_dsa=False
max_update=0
encoder_attention_heads=16
freeze_bart_parameters=True
tokenizer=None
total_num_update=1000000
pipeline_decoder_balance=None
quantization_config_path=None
broadcast_buffers=False
batch_size=None
maximize_best_checkpoint_metric=False
pooler_dropout=0.0
warmup_updates=2000
min_lr=-1.0
only_gnn=True
eval_bleu_detok=space
no_seed_provided=False
truncate_source=False
pipeline_balance=None
model=SynGEC
dataset=handwritten
augment=none
device=cuda
map_location=cuda
gpu_nums=8


Sun 08 Sep 2024 09:03:02 INFO [src] dictionary: 21132 types
Sun 08 Sep 2024 09:03:02 INFO [tgt] dictionary: 21132 types
Sun 08 Sep 2024 09:03:02 INFO [syntax label0] dictionary: 51 types
Sun 08 Sep 2024 09:03:02 INFO [src] dictionary: 21132 types
Sun 08 Sep 2024 09:03:02 INFO [tgt] dictionary: 21132 types
Sun 08 Sep 2024 09:03:02 INFO [syntax label0] dictionary: 51 types
Sun 08 Sep 2024 09:03:02 INFO loaded 123 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/valid.src-tgt.src
Sun 08 Sep 2024 09:03:02 INFO loaded 123 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/valid.src-tgt.tgt
Sun 08 Sep 2024 09:03:02 INFO ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin valid src-tgt 123 examples
Sun 08 Sep 2024 09:03:02 INFO loaded 123 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/valid.conll.src-tgt.src
Sun 08 Sep 2024 09:03:02 INFO loaded 123 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/valid.dpd.src-tgt.src
Sun 08 Sep 2024 09:03:02 INFO loaded 123 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/valid.probs.src-tgt.src
Sun 08 Sep 2024 09:03:02 INFO success! syntax types: 1, source conll lines: 123
Sun 08 Sep 2024 09:03:02 INFO loaded 981 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/train.src-tgt.src
Sun 08 Sep 2024 09:03:02 INFO loaded 981 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/train.src-tgt.tgt
Sun 08 Sep 2024 09:03:02 INFO ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin train src-tgt 981 examples
Sun 08 Sep 2024 09:03:02 INFO loaded 981 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/train.conll.src-tgt.src
Sun 08 Sep 2024 09:03:02 INFO loaded 981 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/train.dpd.src-tgt.src
Sun 08 Sep 2024 09:03:02 INFO loaded 981 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/train.probs.src-tgt.src
Sun 08 Sep 2024 09:03:02 INFO success! syntax types: 1, source conll lines: 981
Sun 08 Sep 2024 09:03:02 INFO loaded 123 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_test_with_syntax_bart/bin/test.conll.src-tgt.src
Sun 08 Sep 2024 09:03:02 INFO loaded 123 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_test_with_syntax_bart/bin/test.dpd.src-tgt.src
Sun 08 Sep 2024 09:03:02 INFO loaded 123 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_test_with_syntax_bart/bin/test.probs.src-tgt.src
Sun 08 Sep 2024 09:03:02 INFO success! syntax types: 1, source conll lines: 123
Sun 08 Sep 2024 09:03:09 INFO detected shared parameter: encoder.sentence_encoder.embed_tokens.weight <- decoder.embed_tokens.weight
Sun 08 Sep 2024 09:03:09 INFO detected shared parameter: encoder.sentence_encoder.embed_tokens.weight <- decoder.output_projection.weight
Sun 08 Sep 2024 09:03:09 INFO ***********************CUDA enviroments for all 1 workers***********************
Sun 08 Sep 2024 09:03:09 INFO rank   0: capabilities =  8.0  ; total memory = 79.151 GB ; name = NVIDIA A800 80GB PCIe                   
Sun 08 Sep 2024 09:03:09 INFO ***********************CUDA enviroments for all 1 workers***********************
Sun 08 Sep 2024 09:03:09 INFO no existing checkpoint found ./gectoolkit/properties/model/SynGEC/preprocess/baseline_bart_model/chinese_bart_baseline.pt
Sun 08 Sep 2024 09:03:09 INFO loading train data for epoch 1
Sun 08 Sep 2024 09:03:09 INFO loaded 981 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/train.src-tgt.src
Sun 08 Sep 2024 09:03:09 INFO loaded 981 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/train.src-tgt.tgt
Sun 08 Sep 2024 09:03:09 INFO ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin train src-tgt 981 examples
Sun 08 Sep 2024 09:03:09 INFO loaded 981 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/train.conll.src-tgt.src
Sun 08 Sep 2024 09:03:09 INFO loaded 981 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/train.dpd.src-tgt.src
Sun 08 Sep 2024 09:03:09 INFO loaded 981 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/train.probs.src-tgt.src
Sun 08 Sep 2024 09:03:09 INFO success! syntax types: 1, source conll lines: 981
Sun 08 Sep 2024 09:03:10 INFO SynGEC(
  (model): SyntaxEnhancedBARTModel(
    (encoder): SyntaxEnhancedTransformerEncoder(
      (sentence_encoder): SyntaxEnhancedSentenceTransformerEncoder(
        (dropout_module): FairseqDropout()
        (embed_tokens): Embedding(21132, 1024, padding_idx=1)
        (embed_positions): LearnedPositionalEmbedding(514, 1024, padding_idx=1)
        (layernorm_embedding): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        (layers): ModuleList(
          (0-11): 12 x DSATransformerEncoderLayer(
            (self_attn): DSAMultiheadAttention(
              (dropout_module): FairseqDropout()
              (k_proj): Linear(in_features=1024, out_features=1024, bias=True)
              (v_proj): Linear(in_features=1024, out_features=1024, bias=True)
              (q_proj): Linear(in_features=1024, out_features=1024, bias=True)
              (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
            )
            (self_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
            (dropout_module): FairseqDropout()
            (activation_dropout_module): FairseqDropout()
            (fc1): Linear(in_features=1024, out_features=4096, bias=True)
            (fc2): Linear(in_features=4096, out_features=1024, bias=True)
            (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
      )
      (syntax_encoder): SyntaxEnhancedSyntaxGuidedTransformerEncoder(
        (dropout_module): FairseqDropout()
        (embed_tokens): Embedding(51, 1024, padding_idx=0)
        (layers): ModuleList(
          (0-2): 3 x GCNSyntaxGuidedTransformerEncoderLayer(
            (gcn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
            (dropout_module): FairseqDropout()
            (activation_dropout_module): FairseqDropout()
            (W_out): Linear(in_features=2048, out_features=1024, bias=True)
            (W_in): Linear(in_features=2048, out_features=1024, bias=True)
            (fc): Linear(in_features=1024, out_features=1024, bias=True)
            (fc1): Linear(in_features=1024, out_features=4096, bias=True)
            (fc2): Linear(in_features=4096, out_features=1024, bias=True)
            (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
      )
    )
    (decoder): SyntaxEnhancedTransformerDecoder(
      (dropout_module): FairseqDropout()
      (embed_tokens): Embedding(21132, 1024, padding_idx=1)
      (embed_positions): LearnedPositionalEmbedding(514, 1024, padding_idx=1)
      (layernorm_embedding): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      (layers): ModuleList(
        (0-11): 12 x TransformerDecoderLayer(
          (dropout_module): FairseqDropout()
          (self_attn): MultiheadAttention(
            (dropout_module): FairseqDropout()
            (k_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (v_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (q_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
          )
          (activation_dropout_module): FairseqDropout()
          (self_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          (encoder_attn): MultiheadAttention(
            (dropout_module): FairseqDropout()
            (k_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (v_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (q_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
          )
          (encoder_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          (fc1): Linear(in_features=1024, out_features=4096, bias=True)
          (fc2): Linear(in_features=4096, out_features=1024, bias=True)
          (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        )
      )
      (output_projection): Linear(in_features=1024, out_features=21132, bias=False)
    )
    (classification_heads): ModuleDict()
  )
  (criterion): LabelSmoothedCrossEntropyCriterion()
)
Sun 08 Sep 2024 09:03:10 INFO start training...
Sun 08 Sep 2024 09:03:16 INFO epoch [  1] train time 0h 0m 6s |  loss |[8560.020]
Sun 08 Sep 2024 09:04:45 INFO random_seed=2023
use_gpu=True
learning_rate=6e-05
train_batch_size=32
test_batch_size=1
epoch_nums=100
test_step=5
display_train_step=1
gpu_id=5
training_resume=False
load_best_config=False
supervising_mode=fully_supervised
validset_divide=True
test_only=False
shuffle=True
model_config_file=gectoolkit/properties/model/SynGEC.json
best_config_file=gectoolkit/properties/best_config/SynGEC_handwritten.json
dataset_config_file=gectoolkit/properties/dataset/handwritten.json
dataset_dir=dataset/handwritten
checkpoint_file=checkpoint/SynGEC-handwritten.pth
log_file=log/SynGEC-handwritten.log
output_dir=result/SynGEC-handwritten
checkpoint_dir=checkpoint/SynGEC-handwritten
min_word_keep=5
min_generate_keep=5
language=zh
fp16_init_scale=128
distributed_port=-1
decoder_embed_path=None
quant_noise_pq_block_size=8
best_checkpoint_metric=loss
cross_self_attention=False
validate_interval=1
tie_adaptive_weights=False
bpe=None
decoder_normalize_before=False
cpu=False
optimizer_overrides={}
quant_noise_pq=0
lr_scheduler=polynomial_decay
no_save_optimizer_state=False
train_subset=train
no_cross_attention=False
distributed_world_size=1
decoder_layerdrop=0
skip_invalid_size_inputs_valid_test=True
lr=[0.0005]
slowmo_momentum=None
log_interval=100
user_dir=./gectoolkit/model/SynGEC/src/src_syngec/syngec_model
min_loss_scale=0.0001
dual_aggregation_freeze=True
decoder_output_dim=1024
curriculum=0
scoring=bleu
optimizer=adam
adam_betas=(0.9,0.999)
share_decoder_input_output_embed=True
fp16_no_flatten_grads=False
distributed_backend=nccl
adaptive_input=False
dpd_suffix=['dpd']
attention_dropout=0.0
fp16=True
pipeline_checkpoint=never
fix_batches_to_gpus=False
fp16_scale_tolerance=0.0
valid_subset=valid
gen_subset=test
no_last_checkpoints=False
decoder_attention_heads=16
distributed_wrapper=DDP
activation_dropout=0.0
log_format=tqdm
decoder_embed_dim=1024
dual_aggregation_beta=0.5
disable_validation=False
quant_noise_scalar=0
use_bmuf=False
gat_encoder_layers=3
arch=syntax_enhanced_bart_large
eval_bleu_print_samples=False
no_scale_embedding=True
zero_sharding=none
pipeline_decoder_devices=None
save_interval_updates=0
localsgd_frequency=3
ignore_prefix_size=0
eval_bleu_args=None
encoder_layerdrop=0
syntax_type=['dep']
distributed_no_spawn=False
left_pad_source=True
decoder_layers=12
adaptive_softmax_cutoff=None
upsample_primary=1
ddp_backend=c10d
validate_after_updates=0
power=1.0
data_buffer_size=10
memory_efficient_bf16=False
num_batch_buckets=0
share_all_embeddings=True
alpha=1.0
gated_sum=False
distributed_init_method=None
report_accuracy=False
end_learning_rate=0.0
batch_size_valid=None
pipeline_devices=None
left_pad_target=False
source_word_dropout_probs=False
bf16=False
swm_suffix=swm
encoder_embed_dim=1024
force_anneal=None
no_epoch_checkpoints=False
syntax_encoder=GCN
encoder_ffn_embed_dim=4096
label_smoothing=0.1
num_shards=1
find_unused_parameters=True
no_progress_bar=False
load_alignments=False
use_old_adam=False
eval_bleu_detok_args=None
tensorboard_logdir=None
slowmo_algorithm=LocalSGD
fast_stat_sync=False
layernorm_embedding=True
encoder_layers_to_keep=None
eval_bleu_remove_bpe=None
scale_syntax_encoder_lr=None
eval_bleu=False
fp16_scale_window=None
pipeline_encoder_balance=None
pipeline_encoder_devices=None
relu_dropout=0.0
threshold_loss_scale=None
activation_fn=gelu
task=syntax-enhanced-translation
target_lang=tgt
bart_model_file_from_transformers=None
all_gather_list_size=16384
stop_time_hours=0
validate_interval_updates=0
save_interval=1
conll_suffix=['conll']
empty_cache_freq=0
encoder_learned_pos=True
tpu=False
nprocs_per_node=1
keep_last_epochs=10
device_id=0
source_lang_with_nt=src_nt
use_dpd=False
pipeline_chunks=0
cross_syntax_fuse=False
keep_interval_updates=-1
encoder_embed_path=None
adam_eps=1e-08
model_parallel_size=1
sentence_avg=False
encoder_layers=12
decoder_ffn_embed_dim=4096
dataset_impl=None
criterion=label_smoothed_cross_entropy
fixed_validation_seed=None
profile=False
distributed_rank=0
source_lang=src
eval_tokenized_bleu=False
source_word_dropout=0.2
adaptive_softmax_dropout=0
syntax_model_file=None
checkpoint_suffix=
required_seq_len_multiple=1
no_save=False
use_syntax=True
probs_suffix=['probs']
decoder_learned_pos=True
decoder_input_dim=1024
memory_efficient_fp16=False
decoder_layers_to_keep=None
gat_attention_heads=4
bucket_cap_mb=25
checkpoint_shard_count=1
pipeline_model_parallel=False
encoder_normalize_before=False
keep_best_checkpoints=-1
no_token_positional_embeddings=False
pooler_activation_fn=tanh
shard_id=0
only_dsa=False
max_update=0
encoder_attention_heads=16
freeze_bart_parameters=True
tokenizer=None
total_num_update=1000000
pipeline_decoder_balance=None
quantization_config_path=None
broadcast_buffers=False
batch_size=None
maximize_best_checkpoint_metric=False
pooler_dropout=0.0
warmup_updates=2000
min_lr=-1.0
only_gnn=True
eval_bleu_detok=space
no_seed_provided=False
truncate_source=False
pipeline_balance=None
model=SynGEC
dataset=handwritten
augment=none
device=cuda
map_location=cuda
gpu_nums=8


Sun 08 Sep 2024 09:04:45 INFO [src] dictionary: 21132 types
Sun 08 Sep 2024 09:04:45 INFO [tgt] dictionary: 21132 types
Sun 08 Sep 2024 09:04:45 INFO [syntax label0] dictionary: 51 types
Sun 08 Sep 2024 09:04:45 INFO [src] dictionary: 21132 types
Sun 08 Sep 2024 09:04:45 INFO [tgt] dictionary: 21132 types
Sun 08 Sep 2024 09:04:45 INFO [syntax label0] dictionary: 51 types
Sun 08 Sep 2024 09:04:45 INFO loaded 123 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/valid.src-tgt.src
Sun 08 Sep 2024 09:04:45 INFO loaded 123 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/valid.src-tgt.tgt
Sun 08 Sep 2024 09:04:45 INFO ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin valid src-tgt 123 examples
Sun 08 Sep 2024 09:04:45 INFO loaded 123 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/valid.conll.src-tgt.src
Sun 08 Sep 2024 09:04:45 INFO loaded 123 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/valid.dpd.src-tgt.src
Sun 08 Sep 2024 09:04:45 INFO loaded 123 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/valid.probs.src-tgt.src
Sun 08 Sep 2024 09:04:45 INFO success! syntax types: 1, source conll lines: 123
Sun 08 Sep 2024 09:04:45 INFO loaded 981 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/train.src-tgt.src
Sun 08 Sep 2024 09:04:45 INFO loaded 981 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/train.src-tgt.tgt
Sun 08 Sep 2024 09:04:45 INFO ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin train src-tgt 981 examples
Sun 08 Sep 2024 09:04:45 INFO loaded 981 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/train.conll.src-tgt.src
Sun 08 Sep 2024 09:04:45 INFO loaded 981 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/train.dpd.src-tgt.src
Sun 08 Sep 2024 09:04:45 INFO loaded 981 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/train.probs.src-tgt.src
Sun 08 Sep 2024 09:04:45 INFO success! syntax types: 1, source conll lines: 981
Sun 08 Sep 2024 09:04:45 INFO loaded 123 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_test_with_syntax_bart/bin/test.conll.src-tgt.src
Sun 08 Sep 2024 09:04:45 INFO loaded 123 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_test_with_syntax_bart/bin/test.dpd.src-tgt.src
Sun 08 Sep 2024 09:04:45 INFO loaded 123 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_test_with_syntax_bart/bin/test.probs.src-tgt.src
Sun 08 Sep 2024 09:04:45 INFO success! syntax types: 1, source conll lines: 123
Sun 08 Sep 2024 09:04:52 INFO detected shared parameter: encoder.sentence_encoder.embed_tokens.weight <- decoder.embed_tokens.weight
Sun 08 Sep 2024 09:04:52 INFO detected shared parameter: encoder.sentence_encoder.embed_tokens.weight <- decoder.output_projection.weight
Sun 08 Sep 2024 09:04:52 INFO ***********************CUDA enviroments for all 1 workers***********************
Sun 08 Sep 2024 09:04:52 INFO rank   0: capabilities =  8.0  ; total memory = 79.151 GB ; name = NVIDIA A800 80GB PCIe                   
Sun 08 Sep 2024 09:04:52 INFO ***********************CUDA enviroments for all 1 workers***********************
Sun 08 Sep 2024 09:04:53 INFO no existing checkpoint found ./gectoolkit/properties/model/SynGEC/preprocess/baseline_bart_model/chinese_bart_baseline.pt
Sun 08 Sep 2024 09:04:53 INFO loading train data for epoch 1
Sun 08 Sep 2024 09:04:53 INFO loaded 981 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/train.src-tgt.src
Sun 08 Sep 2024 09:04:53 INFO loaded 981 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/train.src-tgt.tgt
Sun 08 Sep 2024 09:04:53 INFO ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin train src-tgt 981 examples
Sun 08 Sep 2024 09:04:53 INFO loaded 981 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/train.conll.src-tgt.src
Sun 08 Sep 2024 09:04:53 INFO loaded 981 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/train.dpd.src-tgt.src
Sun 08 Sep 2024 09:04:53 INFO loaded 981 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/train.probs.src-tgt.src
Sun 08 Sep 2024 09:04:53 INFO success! syntax types: 1, source conll lines: 981
Sun 08 Sep 2024 09:04:55 INFO SynGEC(
  (model): SyntaxEnhancedBARTModel(
    (encoder): SyntaxEnhancedTransformerEncoder(
      (sentence_encoder): SyntaxEnhancedSentenceTransformerEncoder(
        (dropout_module): FairseqDropout()
        (embed_tokens): Embedding(21132, 1024, padding_idx=1)
        (embed_positions): LearnedPositionalEmbedding(514, 1024, padding_idx=1)
        (layernorm_embedding): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        (layers): ModuleList(
          (0-11): 12 x DSATransformerEncoderLayer(
            (self_attn): DSAMultiheadAttention(
              (dropout_module): FairseqDropout()
              (k_proj): Linear(in_features=1024, out_features=1024, bias=True)
              (v_proj): Linear(in_features=1024, out_features=1024, bias=True)
              (q_proj): Linear(in_features=1024, out_features=1024, bias=True)
              (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
            )
            (self_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
            (dropout_module): FairseqDropout()
            (activation_dropout_module): FairseqDropout()
            (fc1): Linear(in_features=1024, out_features=4096, bias=True)
            (fc2): Linear(in_features=4096, out_features=1024, bias=True)
            (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
      )
      (syntax_encoder): SyntaxEnhancedSyntaxGuidedTransformerEncoder(
        (dropout_module): FairseqDropout()
        (embed_tokens): Embedding(51, 1024, padding_idx=0)
        (layers): ModuleList(
          (0-2): 3 x GCNSyntaxGuidedTransformerEncoderLayer(
            (gcn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
            (dropout_module): FairseqDropout()
            (activation_dropout_module): FairseqDropout()
            (W_out): Linear(in_features=2048, out_features=1024, bias=True)
            (W_in): Linear(in_features=2048, out_features=1024, bias=True)
            (fc): Linear(in_features=1024, out_features=1024, bias=True)
            (fc1): Linear(in_features=1024, out_features=4096, bias=True)
            (fc2): Linear(in_features=4096, out_features=1024, bias=True)
            (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
      )
    )
    (decoder): SyntaxEnhancedTransformerDecoder(
      (dropout_module): FairseqDropout()
      (embed_tokens): Embedding(21132, 1024, padding_idx=1)
      (embed_positions): LearnedPositionalEmbedding(514, 1024, padding_idx=1)
      (layernorm_embedding): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      (layers): ModuleList(
        (0-11): 12 x TransformerDecoderLayer(
          (dropout_module): FairseqDropout()
          (self_attn): MultiheadAttention(
            (dropout_module): FairseqDropout()
            (k_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (v_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (q_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
          )
          (activation_dropout_module): FairseqDropout()
          (self_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          (encoder_attn): MultiheadAttention(
            (dropout_module): FairseqDropout()
            (k_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (v_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (q_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
          )
          (encoder_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          (fc1): Linear(in_features=1024, out_features=4096, bias=True)
          (fc2): Linear(in_features=4096, out_features=1024, bias=True)
          (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        )
      )
      (output_projection): Linear(in_features=1024, out_features=21132, bias=False)
    )
    (classification_heads): ModuleDict()
  )
  (criterion): LabelSmoothedCrossEntropyCriterion()
)
Sun 08 Sep 2024 09:04:55 INFO start training...
Sun 08 Sep 2024 09:05:02 INFO epoch [  1] train time 0h 0m 7s |  loss |[8560.020]
Sun 08 Sep 2024 09:07:30 INFO random_seed=2023
use_gpu=True
learning_rate=6e-05
train_batch_size=32
test_batch_size=1
epoch_nums=100
test_step=5
display_train_step=1
gpu_id=5
training_resume=False
load_best_config=False
supervising_mode=fully_supervised
validset_divide=True
test_only=False
shuffle=True
model_config_file=gectoolkit/properties/model/SynGEC.json
best_config_file=gectoolkit/properties/best_config/SynGEC_handwritten.json
dataset_config_file=gectoolkit/properties/dataset/handwritten.json
dataset_dir=dataset/handwritten
checkpoint_file=checkpoint/SynGEC-handwritten.pth
log_file=log/SynGEC-handwritten.log
output_dir=result/SynGEC-handwritten
checkpoint_dir=checkpoint/SynGEC-handwritten
min_word_keep=5
min_generate_keep=5
language=zh
fp16_init_scale=128
distributed_port=-1
decoder_embed_path=None
quant_noise_pq_block_size=8
best_checkpoint_metric=loss
cross_self_attention=False
validate_interval=1
tie_adaptive_weights=False
bpe=None
decoder_normalize_before=False
cpu=False
optimizer_overrides={}
quant_noise_pq=0
lr_scheduler=polynomial_decay
no_save_optimizer_state=False
train_subset=train
no_cross_attention=False
distributed_world_size=1
decoder_layerdrop=0
skip_invalid_size_inputs_valid_test=True
lr=[0.0005]
slowmo_momentum=None
log_interval=100
user_dir=./gectoolkit/model/SynGEC/src/src_syngec/syngec_model
min_loss_scale=0.0001
dual_aggregation_freeze=True
decoder_output_dim=1024
curriculum=0
scoring=bleu
optimizer=adam
adam_betas=(0.9,0.999)
share_decoder_input_output_embed=True
fp16_no_flatten_grads=False
distributed_backend=nccl
adaptive_input=False
dpd_suffix=['dpd']
attention_dropout=0.0
fp16=True
pipeline_checkpoint=never
fix_batches_to_gpus=False
fp16_scale_tolerance=0.0
valid_subset=valid
gen_subset=test
no_last_checkpoints=False
decoder_attention_heads=16
distributed_wrapper=DDP
activation_dropout=0.0
log_format=tqdm
decoder_embed_dim=1024
dual_aggregation_beta=0.5
disable_validation=False
quant_noise_scalar=0
use_bmuf=False
gat_encoder_layers=3
arch=syntax_enhanced_bart_large
eval_bleu_print_samples=False
no_scale_embedding=True
zero_sharding=none
pipeline_decoder_devices=None
save_interval_updates=0
localsgd_frequency=3
ignore_prefix_size=0
eval_bleu_args=None
encoder_layerdrop=0
syntax_type=['dep']
distributed_no_spawn=False
left_pad_source=True
decoder_layers=12
adaptive_softmax_cutoff=None
upsample_primary=1
ddp_backend=c10d
validate_after_updates=0
power=1.0
data_buffer_size=10
memory_efficient_bf16=False
num_batch_buckets=0
share_all_embeddings=True
alpha=1.0
gated_sum=False
distributed_init_method=None
report_accuracy=False
end_learning_rate=0.0
batch_size_valid=None
pipeline_devices=None
left_pad_target=False
source_word_dropout_probs=False
bf16=False
swm_suffix=swm
encoder_embed_dim=1024
force_anneal=None
no_epoch_checkpoints=False
syntax_encoder=GCN
encoder_ffn_embed_dim=4096
label_smoothing=0.1
num_shards=1
find_unused_parameters=True
no_progress_bar=False
load_alignments=False
use_old_adam=False
eval_bleu_detok_args=None
tensorboard_logdir=None
slowmo_algorithm=LocalSGD
fast_stat_sync=False
layernorm_embedding=True
encoder_layers_to_keep=None
eval_bleu_remove_bpe=None
scale_syntax_encoder_lr=None
eval_bleu=False
fp16_scale_window=None
pipeline_encoder_balance=None
pipeline_encoder_devices=None
relu_dropout=0.0
threshold_loss_scale=None
activation_fn=gelu
task=syntax-enhanced-translation
target_lang=tgt
bart_model_file_from_transformers=None
all_gather_list_size=16384
stop_time_hours=0
validate_interval_updates=0
save_interval=1
conll_suffix=['conll']
empty_cache_freq=0
encoder_learned_pos=True
tpu=False
nprocs_per_node=1
keep_last_epochs=10
device_id=0
source_lang_with_nt=src_nt
use_dpd=False
pipeline_chunks=0
cross_syntax_fuse=False
keep_interval_updates=-1
encoder_embed_path=None
adam_eps=1e-08
model_parallel_size=1
sentence_avg=False
encoder_layers=12
decoder_ffn_embed_dim=4096
dataset_impl=None
criterion=label_smoothed_cross_entropy
fixed_validation_seed=None
profile=False
distributed_rank=0
source_lang=src
eval_tokenized_bleu=False
source_word_dropout=0.2
adaptive_softmax_dropout=0
syntax_model_file=None
checkpoint_suffix=
required_seq_len_multiple=1
no_save=False
use_syntax=True
probs_suffix=['probs']
decoder_learned_pos=True
decoder_input_dim=1024
memory_efficient_fp16=False
decoder_layers_to_keep=None
gat_attention_heads=4
bucket_cap_mb=25
checkpoint_shard_count=1
pipeline_model_parallel=False
encoder_normalize_before=False
keep_best_checkpoints=-1
no_token_positional_embeddings=False
pooler_activation_fn=tanh
shard_id=0
only_dsa=False
max_update=0
encoder_attention_heads=16
freeze_bart_parameters=True
tokenizer=None
total_num_update=1000000
pipeline_decoder_balance=None
quantization_config_path=None
broadcast_buffers=False
batch_size=None
maximize_best_checkpoint_metric=False
pooler_dropout=0.0
warmup_updates=2000
min_lr=-1.0
only_gnn=True
eval_bleu_detok=space
no_seed_provided=False
truncate_source=False
pipeline_balance=None
model=SynGEC
dataset=handwritten
augment=none
device=cuda
map_location=cuda
gpu_nums=8


Sun 08 Sep 2024 09:07:30 INFO [src] dictionary: 21132 types
Sun 08 Sep 2024 09:07:30 INFO [tgt] dictionary: 21132 types
Sun 08 Sep 2024 09:07:30 INFO [syntax label0] dictionary: 51 types
Sun 08 Sep 2024 09:07:31 INFO [src] dictionary: 21132 types
Sun 08 Sep 2024 09:07:31 INFO [tgt] dictionary: 21132 types
Sun 08 Sep 2024 09:07:31 INFO [syntax label0] dictionary: 51 types
Sun 08 Sep 2024 09:07:31 INFO loaded 123 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/valid.src-tgt.src
Sun 08 Sep 2024 09:07:31 INFO loaded 123 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/valid.src-tgt.tgt
Sun 08 Sep 2024 09:07:31 INFO ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin valid src-tgt 123 examples
Sun 08 Sep 2024 09:07:31 INFO loaded 123 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/valid.conll.src-tgt.src
Sun 08 Sep 2024 09:07:31 INFO loaded 123 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/valid.dpd.src-tgt.src
Sun 08 Sep 2024 09:07:31 INFO loaded 123 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/valid.probs.src-tgt.src
Sun 08 Sep 2024 09:07:31 INFO success! syntax types: 1, source conll lines: 123
Sun 08 Sep 2024 09:07:31 INFO loaded 981 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/train.src-tgt.src
Sun 08 Sep 2024 09:07:31 INFO loaded 981 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/train.src-tgt.tgt
Sun 08 Sep 2024 09:07:31 INFO ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin train src-tgt 981 examples
Sun 08 Sep 2024 09:07:31 INFO loaded 981 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/train.conll.src-tgt.src
Sun 08 Sep 2024 09:07:31 INFO loaded 981 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/train.dpd.src-tgt.src
Sun 08 Sep 2024 09:07:31 INFO loaded 981 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/train.probs.src-tgt.src
Sun 08 Sep 2024 09:07:31 INFO success! syntax types: 1, source conll lines: 981
Sun 08 Sep 2024 09:07:31 INFO loaded 123 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_test_with_syntax_bart/bin/test.conll.src-tgt.src
Sun 08 Sep 2024 09:07:31 INFO loaded 123 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_test_with_syntax_bart/bin/test.dpd.src-tgt.src
Sun 08 Sep 2024 09:07:31 INFO loaded 123 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_test_with_syntax_bart/bin/test.probs.src-tgt.src
Sun 08 Sep 2024 09:07:31 INFO success! syntax types: 1, source conll lines: 123
Sun 08 Sep 2024 09:07:37 INFO detected shared parameter: encoder.sentence_encoder.embed_tokens.weight <- decoder.embed_tokens.weight
Sun 08 Sep 2024 09:07:37 INFO detected shared parameter: encoder.sentence_encoder.embed_tokens.weight <- decoder.output_projection.weight
Sun 08 Sep 2024 09:07:37 INFO ***********************CUDA enviroments for all 1 workers***********************
Sun 08 Sep 2024 09:07:37 INFO rank   0: capabilities =  8.0  ; total memory = 79.151 GB ; name = NVIDIA A800 80GB PCIe                   
Sun 08 Sep 2024 09:07:37 INFO ***********************CUDA enviroments for all 1 workers***********************
Sun 08 Sep 2024 09:07:37 INFO no existing checkpoint found ./gectoolkit/properties/model/SynGEC/preprocess/baseline_bart_model/chinese_bart_baseline.pt
Sun 08 Sep 2024 09:07:37 INFO loading train data for epoch 1
Sun 08 Sep 2024 09:07:37 INFO loaded 981 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/train.src-tgt.src
Sun 08 Sep 2024 09:07:37 INFO loaded 981 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/train.src-tgt.tgt
Sun 08 Sep 2024 09:07:37 INFO ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin train src-tgt 981 examples
Sun 08 Sep 2024 09:07:37 INFO loaded 981 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/train.conll.src-tgt.src
Sun 08 Sep 2024 09:07:37 INFO loaded 981 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/train.dpd.src-tgt.src
Sun 08 Sep 2024 09:07:37 INFO loaded 981 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/train.probs.src-tgt.src
Sun 08 Sep 2024 09:07:37 INFO success! syntax types: 1, source conll lines: 981
Sun 08 Sep 2024 09:07:38 INFO SynGEC(
  (model): SyntaxEnhancedBARTModel(
    (encoder): SyntaxEnhancedTransformerEncoder(
      (sentence_encoder): SyntaxEnhancedSentenceTransformerEncoder(
        (dropout_module): FairseqDropout()
        (embed_tokens): Embedding(21132, 1024, padding_idx=1)
        (embed_positions): LearnedPositionalEmbedding(514, 1024, padding_idx=1)
        (layernorm_embedding): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        (layers): ModuleList(
          (0-11): 12 x DSATransformerEncoderLayer(
            (self_attn): DSAMultiheadAttention(
              (dropout_module): FairseqDropout()
              (k_proj): Linear(in_features=1024, out_features=1024, bias=True)
              (v_proj): Linear(in_features=1024, out_features=1024, bias=True)
              (q_proj): Linear(in_features=1024, out_features=1024, bias=True)
              (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
            )
            (self_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
            (dropout_module): FairseqDropout()
            (activation_dropout_module): FairseqDropout()
            (fc1): Linear(in_features=1024, out_features=4096, bias=True)
            (fc2): Linear(in_features=4096, out_features=1024, bias=True)
            (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
      )
      (syntax_encoder): SyntaxEnhancedSyntaxGuidedTransformerEncoder(
        (dropout_module): FairseqDropout()
        (embed_tokens): Embedding(51, 1024, padding_idx=0)
        (layers): ModuleList(
          (0-2): 3 x GCNSyntaxGuidedTransformerEncoderLayer(
            (gcn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
            (dropout_module): FairseqDropout()
            (activation_dropout_module): FairseqDropout()
            (W_out): Linear(in_features=2048, out_features=1024, bias=True)
            (W_in): Linear(in_features=2048, out_features=1024, bias=True)
            (fc): Linear(in_features=1024, out_features=1024, bias=True)
            (fc1): Linear(in_features=1024, out_features=4096, bias=True)
            (fc2): Linear(in_features=4096, out_features=1024, bias=True)
            (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
      )
    )
    (decoder): SyntaxEnhancedTransformerDecoder(
      (dropout_module): FairseqDropout()
      (embed_tokens): Embedding(21132, 1024, padding_idx=1)
      (embed_positions): LearnedPositionalEmbedding(514, 1024, padding_idx=1)
      (layernorm_embedding): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      (layers): ModuleList(
        (0-11): 12 x TransformerDecoderLayer(
          (dropout_module): FairseqDropout()
          (self_attn): MultiheadAttention(
            (dropout_module): FairseqDropout()
            (k_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (v_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (q_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
          )
          (activation_dropout_module): FairseqDropout()
          (self_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          (encoder_attn): MultiheadAttention(
            (dropout_module): FairseqDropout()
            (k_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (v_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (q_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
          )
          (encoder_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          (fc1): Linear(in_features=1024, out_features=4096, bias=True)
          (fc2): Linear(in_features=4096, out_features=1024, bias=True)
          (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        )
      )
      (output_projection): Linear(in_features=1024, out_features=21132, bias=False)
    )
    (classification_heads): ModuleDict()
  )
  (criterion): LabelSmoothedCrossEntropyCriterion()
)
Sun 08 Sep 2024 09:07:38 INFO start training...
Sun 08 Sep 2024 09:07:44 INFO epoch [  1] train time 0h 0m 6s |  loss |[8560.020]
Sun 08 Sep 2024 09:08:08 INFO random_seed=2023
use_gpu=True
learning_rate=6e-05
train_batch_size=32
test_batch_size=1
epoch_nums=100
test_step=5
display_train_step=1
gpu_id=5
training_resume=False
load_best_config=False
supervising_mode=fully_supervised
validset_divide=True
test_only=False
shuffle=True
model_config_file=gectoolkit/properties/model/SynGEC.json
best_config_file=gectoolkit/properties/best_config/SynGEC_handwritten.json
dataset_config_file=gectoolkit/properties/dataset/handwritten.json
dataset_dir=dataset/handwritten
checkpoint_file=checkpoint/SynGEC-handwritten.pth
log_file=log/SynGEC-handwritten.log
output_dir=result/SynGEC-handwritten
checkpoint_dir=checkpoint/SynGEC-handwritten
min_word_keep=5
min_generate_keep=5
language=zh
fp16_init_scale=128
distributed_port=-1
decoder_embed_path=None
quant_noise_pq_block_size=8
best_checkpoint_metric=loss
cross_self_attention=False
validate_interval=1
tie_adaptive_weights=False
bpe=None
decoder_normalize_before=False
cpu=False
optimizer_overrides={}
quant_noise_pq=0
lr_scheduler=polynomial_decay
no_save_optimizer_state=False
train_subset=train
no_cross_attention=False
distributed_world_size=1
decoder_layerdrop=0
skip_invalid_size_inputs_valid_test=True
lr=[0.0005]
slowmo_momentum=None
log_interval=100
user_dir=./gectoolkit/model/SynGEC/src/src_syngec/syngec_model
min_loss_scale=0.0001
dual_aggregation_freeze=True
decoder_output_dim=1024
curriculum=0
scoring=bleu
optimizer=adam
adam_betas=(0.9,0.999)
share_decoder_input_output_embed=True
fp16_no_flatten_grads=False
distributed_backend=nccl
adaptive_input=False
dpd_suffix=['dpd']
attention_dropout=0.0
fp16=True
pipeline_checkpoint=never
fix_batches_to_gpus=False
fp16_scale_tolerance=0.0
valid_subset=valid
gen_subset=test
no_last_checkpoints=False
decoder_attention_heads=16
distributed_wrapper=DDP
activation_dropout=0.0
log_format=tqdm
decoder_embed_dim=1024
dual_aggregation_beta=0.5
disable_validation=False
quant_noise_scalar=0
use_bmuf=False
gat_encoder_layers=3
arch=syntax_enhanced_bart_large
eval_bleu_print_samples=False
no_scale_embedding=True
zero_sharding=none
pipeline_decoder_devices=None
save_interval_updates=0
localsgd_frequency=3
ignore_prefix_size=0
eval_bleu_args=None
encoder_layerdrop=0
syntax_type=['dep']
distributed_no_spawn=False
left_pad_source=True
decoder_layers=12
adaptive_softmax_cutoff=None
upsample_primary=1
ddp_backend=c10d
validate_after_updates=0
power=1.0
data_buffer_size=10
memory_efficient_bf16=False
num_batch_buckets=0
share_all_embeddings=True
alpha=1.0
gated_sum=False
distributed_init_method=None
report_accuracy=False
end_learning_rate=0.0
batch_size_valid=None
pipeline_devices=None
left_pad_target=False
source_word_dropout_probs=False
bf16=False
swm_suffix=swm
encoder_embed_dim=1024
force_anneal=None
no_epoch_checkpoints=False
syntax_encoder=GCN
encoder_ffn_embed_dim=4096
label_smoothing=0.1
num_shards=1
find_unused_parameters=True
no_progress_bar=False
load_alignments=False
use_old_adam=False
eval_bleu_detok_args=None
tensorboard_logdir=None
slowmo_algorithm=LocalSGD
fast_stat_sync=False
layernorm_embedding=True
encoder_layers_to_keep=None
eval_bleu_remove_bpe=None
scale_syntax_encoder_lr=None
eval_bleu=False
fp16_scale_window=None
pipeline_encoder_balance=None
pipeline_encoder_devices=None
relu_dropout=0.0
threshold_loss_scale=None
activation_fn=gelu
task=syntax-enhanced-translation
target_lang=tgt
bart_model_file_from_transformers=None
all_gather_list_size=16384
stop_time_hours=0
validate_interval_updates=0
save_interval=1
conll_suffix=['conll']
empty_cache_freq=0
encoder_learned_pos=True
tpu=False
nprocs_per_node=1
keep_last_epochs=10
device_id=0
source_lang_with_nt=src_nt
use_dpd=False
pipeline_chunks=0
cross_syntax_fuse=False
keep_interval_updates=-1
encoder_embed_path=None
adam_eps=1e-08
model_parallel_size=1
sentence_avg=False
encoder_layers=12
decoder_ffn_embed_dim=4096
dataset_impl=None
criterion=label_smoothed_cross_entropy
fixed_validation_seed=None
profile=False
distributed_rank=0
source_lang=src
eval_tokenized_bleu=False
source_word_dropout=0.2
adaptive_softmax_dropout=0
syntax_model_file=None
checkpoint_suffix=
required_seq_len_multiple=1
no_save=False
use_syntax=True
probs_suffix=['probs']
decoder_learned_pos=True
decoder_input_dim=1024
memory_efficient_fp16=False
decoder_layers_to_keep=None
gat_attention_heads=4
bucket_cap_mb=25
checkpoint_shard_count=1
pipeline_model_parallel=False
encoder_normalize_before=False
keep_best_checkpoints=-1
no_token_positional_embeddings=False
pooler_activation_fn=tanh
shard_id=0
only_dsa=False
max_update=0
encoder_attention_heads=16
freeze_bart_parameters=True
tokenizer=None
total_num_update=1000000
pipeline_decoder_balance=None
quantization_config_path=None
broadcast_buffers=False
batch_size=None
maximize_best_checkpoint_metric=False
pooler_dropout=0.0
warmup_updates=2000
min_lr=-1.0
only_gnn=True
eval_bleu_detok=space
no_seed_provided=False
truncate_source=False
pipeline_balance=None
model=SynGEC
dataset=handwritten
augment=none
device=cuda
map_location=cuda
gpu_nums=8


Sun 08 Sep 2024 09:08:08 INFO [src] dictionary: 21132 types
Sun 08 Sep 2024 09:08:08 INFO [tgt] dictionary: 21132 types
Sun 08 Sep 2024 09:08:08 INFO [syntax label0] dictionary: 51 types
Sun 08 Sep 2024 09:08:08 INFO [src] dictionary: 21132 types
Sun 08 Sep 2024 09:08:08 INFO [tgt] dictionary: 21132 types
Sun 08 Sep 2024 09:08:08 INFO [syntax label0] dictionary: 51 types
Sun 08 Sep 2024 09:08:08 INFO loaded 123 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/valid.src-tgt.src
Sun 08 Sep 2024 09:08:08 INFO loaded 123 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/valid.src-tgt.tgt
Sun 08 Sep 2024 09:08:08 INFO ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin valid src-tgt 123 examples
Sun 08 Sep 2024 09:08:08 INFO loaded 123 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/valid.conll.src-tgt.src
Sun 08 Sep 2024 09:08:08 INFO loaded 123 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/valid.dpd.src-tgt.src
Sun 08 Sep 2024 09:08:08 INFO loaded 123 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/valid.probs.src-tgt.src
Sun 08 Sep 2024 09:08:08 INFO success! syntax types: 1, source conll lines: 123
Sun 08 Sep 2024 09:08:08 INFO loaded 981 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/train.src-tgt.src
Sun 08 Sep 2024 09:08:08 INFO loaded 981 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/train.src-tgt.tgt
Sun 08 Sep 2024 09:08:08 INFO ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin train src-tgt 981 examples
Sun 08 Sep 2024 09:08:08 INFO loaded 981 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/train.conll.src-tgt.src
Sun 08 Sep 2024 09:08:08 INFO loaded 981 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/train.dpd.src-tgt.src
Sun 08 Sep 2024 09:08:08 INFO loaded 981 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/train.probs.src-tgt.src
Sun 08 Sep 2024 09:08:08 INFO success! syntax types: 1, source conll lines: 981
Sun 08 Sep 2024 09:08:08 INFO loaded 123 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_test_with_syntax_bart/bin/test.conll.src-tgt.src
Sun 08 Sep 2024 09:08:08 INFO loaded 123 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_test_with_syntax_bart/bin/test.dpd.src-tgt.src
Sun 08 Sep 2024 09:08:08 INFO loaded 123 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_test_with_syntax_bart/bin/test.probs.src-tgt.src
Sun 08 Sep 2024 09:08:08 INFO success! syntax types: 1, source conll lines: 123
Sun 08 Sep 2024 09:08:15 INFO detected shared parameter: encoder.sentence_encoder.embed_tokens.weight <- decoder.embed_tokens.weight
Sun 08 Sep 2024 09:08:15 INFO detected shared parameter: encoder.sentence_encoder.embed_tokens.weight <- decoder.output_projection.weight
Sun 08 Sep 2024 09:08:15 INFO ***********************CUDA enviroments for all 1 workers***********************
Sun 08 Sep 2024 09:08:15 INFO rank   0: capabilities =  8.0  ; total memory = 79.151 GB ; name = NVIDIA A800 80GB PCIe                   
Sun 08 Sep 2024 09:08:15 INFO ***********************CUDA enviroments for all 1 workers***********************
Sun 08 Sep 2024 09:08:15 INFO no existing checkpoint found ./gectoolkit/properties/model/SynGEC/preprocess/baseline_bart_model/chinese_bart_baseline.pt
Sun 08 Sep 2024 09:08:15 INFO loading train data for epoch 1
Sun 08 Sep 2024 09:08:15 INFO loaded 981 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/train.src-tgt.src
Sun 08 Sep 2024 09:08:15 INFO loaded 981 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/train.src-tgt.tgt
Sun 08 Sep 2024 09:08:15 INFO ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin train src-tgt 981 examples
Sun 08 Sep 2024 09:08:15 INFO loaded 981 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/train.conll.src-tgt.src
Sun 08 Sep 2024 09:08:15 INFO loaded 981 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/train.dpd.src-tgt.src
Sun 08 Sep 2024 09:08:15 INFO loaded 981 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/train.probs.src-tgt.src
Sun 08 Sep 2024 09:08:15 INFO success! syntax types: 1, source conll lines: 981
Sun 08 Sep 2024 09:08:16 INFO SynGEC(
  (model): SyntaxEnhancedBARTModel(
    (encoder): SyntaxEnhancedTransformerEncoder(
      (sentence_encoder): SyntaxEnhancedSentenceTransformerEncoder(
        (dropout_module): FairseqDropout()
        (embed_tokens): Embedding(21132, 1024, padding_idx=1)
        (embed_positions): LearnedPositionalEmbedding(514, 1024, padding_idx=1)
        (layernorm_embedding): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        (layers): ModuleList(
          (0-11): 12 x DSATransformerEncoderLayer(
            (self_attn): DSAMultiheadAttention(
              (dropout_module): FairseqDropout()
              (k_proj): Linear(in_features=1024, out_features=1024, bias=True)
              (v_proj): Linear(in_features=1024, out_features=1024, bias=True)
              (q_proj): Linear(in_features=1024, out_features=1024, bias=True)
              (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
            )
            (self_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
            (dropout_module): FairseqDropout()
            (activation_dropout_module): FairseqDropout()
            (fc1): Linear(in_features=1024, out_features=4096, bias=True)
            (fc2): Linear(in_features=4096, out_features=1024, bias=True)
            (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
      )
      (syntax_encoder): SyntaxEnhancedSyntaxGuidedTransformerEncoder(
        (dropout_module): FairseqDropout()
        (embed_tokens): Embedding(51, 1024, padding_idx=0)
        (layers): ModuleList(
          (0-2): 3 x GCNSyntaxGuidedTransformerEncoderLayer(
            (gcn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
            (dropout_module): FairseqDropout()
            (activation_dropout_module): FairseqDropout()
            (W_out): Linear(in_features=2048, out_features=1024, bias=True)
            (W_in): Linear(in_features=2048, out_features=1024, bias=True)
            (fc): Linear(in_features=1024, out_features=1024, bias=True)
            (fc1): Linear(in_features=1024, out_features=4096, bias=True)
            (fc2): Linear(in_features=4096, out_features=1024, bias=True)
            (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
      )
    )
    (decoder): SyntaxEnhancedTransformerDecoder(
      (dropout_module): FairseqDropout()
      (embed_tokens): Embedding(21132, 1024, padding_idx=1)
      (embed_positions): LearnedPositionalEmbedding(514, 1024, padding_idx=1)
      (layernorm_embedding): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      (layers): ModuleList(
        (0-11): 12 x TransformerDecoderLayer(
          (dropout_module): FairseqDropout()
          (self_attn): MultiheadAttention(
            (dropout_module): FairseqDropout()
            (k_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (v_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (q_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
          )
          (activation_dropout_module): FairseqDropout()
          (self_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          (encoder_attn): MultiheadAttention(
            (dropout_module): FairseqDropout()
            (k_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (v_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (q_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
          )
          (encoder_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          (fc1): Linear(in_features=1024, out_features=4096, bias=True)
          (fc2): Linear(in_features=4096, out_features=1024, bias=True)
          (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        )
      )
      (output_projection): Linear(in_features=1024, out_features=21132, bias=False)
    )
    (classification_heads): ModuleDict()
  )
  (criterion): LabelSmoothedCrossEntropyCriterion()
)
Sun 08 Sep 2024 09:08:16 INFO start training...
Sun 08 Sep 2024 09:08:22 INFO epoch [  1] train time 0h 0m 6s |  loss |[8560.020]
Sun 08 Sep 2024 09:12:36 INFO random_seed=2023
use_gpu=True
learning_rate=6e-05
train_batch_size=32
test_batch_size=1
epoch_nums=100
test_step=5
display_train_step=1
gpu_id=5
training_resume=False
load_best_config=False
supervising_mode=fully_supervised
validset_divide=True
test_only=False
shuffle=True
model_config_file=gectoolkit/properties/model/SynGEC.json
best_config_file=gectoolkit/properties/best_config/SynGEC_handwritten.json
dataset_config_file=gectoolkit/properties/dataset/handwritten.json
dataset_dir=dataset/handwritten
checkpoint_file=checkpoint/SynGEC-handwritten.pth
log_file=log/SynGEC-handwritten.log
output_dir=result/SynGEC-handwritten
checkpoint_dir=checkpoint/SynGEC-handwritten
min_word_keep=5
min_generate_keep=5
language=zh
fp16_init_scale=128
distributed_port=-1
decoder_embed_path=None
quant_noise_pq_block_size=8
best_checkpoint_metric=loss
cross_self_attention=False
validate_interval=1
tie_adaptive_weights=False
bpe=None
decoder_normalize_before=False
cpu=False
optimizer_overrides={}
quant_noise_pq=0
lr_scheduler=polynomial_decay
no_save_optimizer_state=False
train_subset=train
no_cross_attention=False
distributed_world_size=1
decoder_layerdrop=0
skip_invalid_size_inputs_valid_test=True
lr=[0.0005]
slowmo_momentum=None
log_interval=100
user_dir=./gectoolkit/model/SynGEC/src/src_syngec/syngec_model
min_loss_scale=0.0001
dual_aggregation_freeze=True
decoder_output_dim=1024
curriculum=0
scoring=bleu
optimizer=adam
adam_betas=(0.9,0.999)
share_decoder_input_output_embed=True
fp16_no_flatten_grads=False
distributed_backend=nccl
adaptive_input=False
dpd_suffix=['dpd']
attention_dropout=0.0
fp16=True
pipeline_checkpoint=never
fix_batches_to_gpus=False
fp16_scale_tolerance=0.0
valid_subset=valid
gen_subset=test
no_last_checkpoints=False
decoder_attention_heads=16
distributed_wrapper=DDP
activation_dropout=0.0
log_format=tqdm
decoder_embed_dim=1024
dual_aggregation_beta=0.5
disable_validation=False
quant_noise_scalar=0
use_bmuf=False
gat_encoder_layers=3
arch=syntax_enhanced_bart_large
eval_bleu_print_samples=False
no_scale_embedding=True
zero_sharding=none
pipeline_decoder_devices=None
save_interval_updates=0
localsgd_frequency=3
ignore_prefix_size=0
eval_bleu_args=None
encoder_layerdrop=0
syntax_type=['dep']
distributed_no_spawn=False
left_pad_source=True
decoder_layers=12
adaptive_softmax_cutoff=None
upsample_primary=1
ddp_backend=c10d
validate_after_updates=0
power=1.0
data_buffer_size=10
memory_efficient_bf16=False
num_batch_buckets=0
share_all_embeddings=True
alpha=1.0
gated_sum=False
distributed_init_method=None
report_accuracy=False
end_learning_rate=0.0
batch_size_valid=None
pipeline_devices=None
left_pad_target=False
source_word_dropout_probs=False
bf16=False
swm_suffix=swm
encoder_embed_dim=1024
force_anneal=None
no_epoch_checkpoints=False
syntax_encoder=GCN
encoder_ffn_embed_dim=4096
label_smoothing=0.1
num_shards=1
find_unused_parameters=True
no_progress_bar=False
load_alignments=False
use_old_adam=False
eval_bleu_detok_args=None
tensorboard_logdir=None
slowmo_algorithm=LocalSGD
fast_stat_sync=False
layernorm_embedding=True
encoder_layers_to_keep=None
eval_bleu_remove_bpe=None
scale_syntax_encoder_lr=None
eval_bleu=False
fp16_scale_window=None
pipeline_encoder_balance=None
pipeline_encoder_devices=None
relu_dropout=0.0
threshold_loss_scale=None
activation_fn=gelu
task=syntax-enhanced-translation
target_lang=tgt
bart_model_file_from_transformers=None
all_gather_list_size=16384
stop_time_hours=0
validate_interval_updates=0
save_interval=1
conll_suffix=['conll']
empty_cache_freq=0
encoder_learned_pos=True
tpu=False
nprocs_per_node=1
keep_last_epochs=10
device_id=0
source_lang_with_nt=src_nt
use_dpd=False
pipeline_chunks=0
cross_syntax_fuse=False
keep_interval_updates=-1
encoder_embed_path=None
adam_eps=1e-08
model_parallel_size=1
sentence_avg=False
encoder_layers=12
decoder_ffn_embed_dim=4096
dataset_impl=None
criterion=label_smoothed_cross_entropy
fixed_validation_seed=None
profile=False
distributed_rank=0
source_lang=src
eval_tokenized_bleu=False
source_word_dropout=0.2
adaptive_softmax_dropout=0
syntax_model_file=None
checkpoint_suffix=
required_seq_len_multiple=1
no_save=False
use_syntax=True
probs_suffix=['probs']
decoder_learned_pos=True
decoder_input_dim=1024
memory_efficient_fp16=False
decoder_layers_to_keep=None
gat_attention_heads=4
bucket_cap_mb=25
checkpoint_shard_count=1
pipeline_model_parallel=False
encoder_normalize_before=False
keep_best_checkpoints=-1
no_token_positional_embeddings=False
pooler_activation_fn=tanh
shard_id=0
only_dsa=False
max_update=0
encoder_attention_heads=16
freeze_bart_parameters=True
tokenizer=None
total_num_update=1000000
pipeline_decoder_balance=None
quantization_config_path=None
broadcast_buffers=False
batch_size=None
maximize_best_checkpoint_metric=False
pooler_dropout=0.0
warmup_updates=2000
min_lr=-1.0
only_gnn=True
eval_bleu_detok=space
no_seed_provided=False
truncate_source=False
pipeline_balance=None
model=SynGEC
dataset=handwritten
augment=none
device=cuda
map_location=cuda
gpu_nums=8


Sun 08 Sep 2024 09:12:36 INFO [src] dictionary: 21132 types
Sun 08 Sep 2024 09:12:36 INFO [tgt] dictionary: 21132 types
Sun 08 Sep 2024 09:12:36 INFO [syntax label0] dictionary: 51 types
Sun 08 Sep 2024 09:12:36 INFO [src] dictionary: 21132 types
Sun 08 Sep 2024 09:12:36 INFO [tgt] dictionary: 21132 types
Sun 08 Sep 2024 09:12:36 INFO [syntax label0] dictionary: 51 types
Sun 08 Sep 2024 09:12:36 INFO loaded 123 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/valid.src-tgt.src
Sun 08 Sep 2024 09:12:36 INFO loaded 123 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/valid.src-tgt.tgt
Sun 08 Sep 2024 09:12:36 INFO ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin valid src-tgt 123 examples
Sun 08 Sep 2024 09:12:36 INFO loaded 123 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/valid.conll.src-tgt.src
Sun 08 Sep 2024 09:12:36 INFO loaded 123 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/valid.dpd.src-tgt.src
Sun 08 Sep 2024 09:12:36 INFO loaded 123 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/valid.probs.src-tgt.src
Sun 08 Sep 2024 09:12:36 INFO success! syntax types: 1, source conll lines: 123
Sun 08 Sep 2024 09:12:36 INFO loaded 981 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/train.src-tgt.src
Sun 08 Sep 2024 09:12:36 INFO loaded 981 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/train.src-tgt.tgt
Sun 08 Sep 2024 09:12:36 INFO ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin train src-tgt 981 examples
Sun 08 Sep 2024 09:12:36 INFO loaded 981 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/train.conll.src-tgt.src
Sun 08 Sep 2024 09:12:36 INFO loaded 981 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/train.dpd.src-tgt.src
Sun 08 Sep 2024 09:12:36 INFO loaded 981 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/train.probs.src-tgt.src
Sun 08 Sep 2024 09:12:36 INFO success! syntax types: 1, source conll lines: 981
Sun 08 Sep 2024 09:12:36 INFO loaded 123 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_test_with_syntax_bart/bin/test.conll.src-tgt.src
Sun 08 Sep 2024 09:12:36 INFO loaded 123 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_test_with_syntax_bart/bin/test.dpd.src-tgt.src
Sun 08 Sep 2024 09:12:36 INFO loaded 123 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_test_with_syntax_bart/bin/test.probs.src-tgt.src
Sun 08 Sep 2024 09:12:36 INFO success! syntax types: 1, source conll lines: 123
Sun 08 Sep 2024 09:12:43 INFO detected shared parameter: encoder.sentence_encoder.embed_tokens.weight <- decoder.embed_tokens.weight
Sun 08 Sep 2024 09:12:43 INFO detected shared parameter: encoder.sentence_encoder.embed_tokens.weight <- decoder.output_projection.weight
Sun 08 Sep 2024 09:12:43 INFO ***********************CUDA enviroments for all 1 workers***********************
Sun 08 Sep 2024 09:12:43 INFO rank   0: capabilities =  8.0  ; total memory = 79.151 GB ; name = NVIDIA A800 80GB PCIe                   
Sun 08 Sep 2024 09:12:43 INFO ***********************CUDA enviroments for all 1 workers***********************
Sun 08 Sep 2024 09:12:43 INFO no existing checkpoint found ./gectoolkit/properties/model/SynGEC/preprocess/baseline_bart_model/chinese_bart_baseline.pt
Sun 08 Sep 2024 09:12:43 INFO loading train data for epoch 1
Sun 08 Sep 2024 09:12:43 INFO loaded 981 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/train.src-tgt.src
Sun 08 Sep 2024 09:12:43 INFO loaded 981 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/train.src-tgt.tgt
Sun 08 Sep 2024 09:12:43 INFO ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin train src-tgt 981 examples
Sun 08 Sep 2024 09:12:43 INFO loaded 981 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/train.conll.src-tgt.src
Sun 08 Sep 2024 09:12:43 INFO loaded 981 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/train.dpd.src-tgt.src
Sun 08 Sep 2024 09:12:43 INFO loaded 981 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/train.probs.src-tgt.src
Sun 08 Sep 2024 09:12:43 INFO success! syntax types: 1, source conll lines: 981
Sun 08 Sep 2024 09:12:44 INFO SynGEC(
  (model): SyntaxEnhancedBARTModel(
    (encoder): SyntaxEnhancedTransformerEncoder(
      (sentence_encoder): SyntaxEnhancedSentenceTransformerEncoder(
        (dropout_module): FairseqDropout()
        (embed_tokens): Embedding(21132, 1024, padding_idx=1)
        (embed_positions): LearnedPositionalEmbedding(514, 1024, padding_idx=1)
        (layernorm_embedding): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        (layers): ModuleList(
          (0-11): 12 x DSATransformerEncoderLayer(
            (self_attn): DSAMultiheadAttention(
              (dropout_module): FairseqDropout()
              (k_proj): Linear(in_features=1024, out_features=1024, bias=True)
              (v_proj): Linear(in_features=1024, out_features=1024, bias=True)
              (q_proj): Linear(in_features=1024, out_features=1024, bias=True)
              (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
            )
            (self_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
            (dropout_module): FairseqDropout()
            (activation_dropout_module): FairseqDropout()
            (fc1): Linear(in_features=1024, out_features=4096, bias=True)
            (fc2): Linear(in_features=4096, out_features=1024, bias=True)
            (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
      )
      (syntax_encoder): SyntaxEnhancedSyntaxGuidedTransformerEncoder(
        (dropout_module): FairseqDropout()
        (embed_tokens): Embedding(51, 1024, padding_idx=0)
        (layers): ModuleList(
          (0-2): 3 x GCNSyntaxGuidedTransformerEncoderLayer(
            (gcn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
            (dropout_module): FairseqDropout()
            (activation_dropout_module): FairseqDropout()
            (W_out): Linear(in_features=2048, out_features=1024, bias=True)
            (W_in): Linear(in_features=2048, out_features=1024, bias=True)
            (fc): Linear(in_features=1024, out_features=1024, bias=True)
            (fc1): Linear(in_features=1024, out_features=4096, bias=True)
            (fc2): Linear(in_features=4096, out_features=1024, bias=True)
            (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
      )
    )
    (decoder): SyntaxEnhancedTransformerDecoder(
      (dropout_module): FairseqDropout()
      (embed_tokens): Embedding(21132, 1024, padding_idx=1)
      (embed_positions): LearnedPositionalEmbedding(514, 1024, padding_idx=1)
      (layernorm_embedding): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      (layers): ModuleList(
        (0-11): 12 x TransformerDecoderLayer(
          (dropout_module): FairseqDropout()
          (self_attn): MultiheadAttention(
            (dropout_module): FairseqDropout()
            (k_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (v_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (q_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
          )
          (activation_dropout_module): FairseqDropout()
          (self_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          (encoder_attn): MultiheadAttention(
            (dropout_module): FairseqDropout()
            (k_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (v_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (q_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
          )
          (encoder_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          (fc1): Linear(in_features=1024, out_features=4096, bias=True)
          (fc2): Linear(in_features=4096, out_features=1024, bias=True)
          (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        )
      )
      (output_projection): Linear(in_features=1024, out_features=21132, bias=False)
    )
    (classification_heads): ModuleDict()
  )
  (criterion): LabelSmoothedCrossEntropyCriterion()
)
Sun 08 Sep 2024 09:12:44 INFO start training...
Sun 08 Sep 2024 09:12:50 INFO epoch [  1] train time 0h 0m 6s |  loss |[8560.020]
Sun 08 Sep 2024 09:13:36 INFO ---------- valid total [123] | valid precision [0.008] | valid recall [0.008] | valid f0.5 [0.008] | valid time 0h 0m 46s
Sun 08 Sep 2024 09:15:13 INFO ---------- test total [123] | test precision [0.000] | test recall [0.000] | test f0.5 [0.000] | test time 0h 1m 37s
Sun 08 Sep 2024 09:15:20 INFO epoch [  2] train time 0h 0m 5s |  loss |[8252.357]
Sun 08 Sep 2024 09:15:26 INFO epoch [  3] train time 0h 0m 5s |  loss |[8086.623]
Sun 08 Sep 2024 09:15:32 INFO epoch [  4] train time 0h 0m 5s |  loss |[8008.348]
Sun 08 Sep 2024 09:15:38 INFO epoch [  5] train time 0h 0m 5s |  loss |[7967.207]
Sun 08 Sep 2024 09:15:43 INFO epoch [  6] train time 0h 0m 5s |  loss |[7943.856]
Sun 08 Sep 2024 09:19:28 INFO random_seed=2023
use_gpu=True
learning_rate=6e-05
train_batch_size=32
test_batch_size=1
epoch_nums=200
test_step=10
display_train_step=1
gpu_id=5
training_resume=False
load_best_config=False
supervising_mode=fully_supervised
validset_divide=True
test_only=False
shuffle=True
model_config_file=gectoolkit/properties/model/SynGEC.json
best_config_file=gectoolkit/properties/best_config/SynGEC_handwritten.json
dataset_config_file=gectoolkit/properties/dataset/handwritten.json
dataset_dir=dataset/handwritten
checkpoint_file=checkpoint/SynGEC-handwritten.pth
log_file=log/SynGEC-handwritten.log
output_dir=result/SynGEC-handwritten
checkpoint_dir=checkpoint/SynGEC-handwritten
min_word_keep=5
min_generate_keep=5
language=zh
fp16_init_scale=128
distributed_port=-1
decoder_embed_path=None
quant_noise_pq_block_size=8
best_checkpoint_metric=loss
cross_self_attention=False
validate_interval=1
tie_adaptive_weights=False
bpe=None
decoder_normalize_before=False
cpu=False
optimizer_overrides={}
quant_noise_pq=0
lr_scheduler=polynomial_decay
no_save_optimizer_state=False
train_subset=train
no_cross_attention=False
distributed_world_size=1
decoder_layerdrop=0
skip_invalid_size_inputs_valid_test=True
lr=[0.0005]
slowmo_momentum=None
log_interval=100
user_dir=./gectoolkit/model/SynGEC/src/src_syngec/syngec_model
min_loss_scale=0.0001
dual_aggregation_freeze=True
decoder_output_dim=1024
curriculum=0
scoring=bleu
optimizer=adam
adam_betas=(0.9,0.999)
share_decoder_input_output_embed=True
fp16_no_flatten_grads=False
distributed_backend=nccl
adaptive_input=False
dpd_suffix=['dpd']
attention_dropout=0.0
fp16=True
pipeline_checkpoint=never
fix_batches_to_gpus=False
fp16_scale_tolerance=0.0
valid_subset=valid
gen_subset=test
no_last_checkpoints=False
decoder_attention_heads=16
distributed_wrapper=DDP
activation_dropout=0.0
log_format=tqdm
decoder_embed_dim=1024
dual_aggregation_beta=0.5
disable_validation=False
quant_noise_scalar=0
use_bmuf=False
gat_encoder_layers=3
arch=syntax_enhanced_bart_large
eval_bleu_print_samples=False
no_scale_embedding=True
zero_sharding=none
pipeline_decoder_devices=None
save_interval_updates=0
localsgd_frequency=3
ignore_prefix_size=0
eval_bleu_args=None
encoder_layerdrop=0
syntax_type=['dep']
distributed_no_spawn=False
left_pad_source=True
decoder_layers=12
adaptive_softmax_cutoff=None
upsample_primary=1
ddp_backend=c10d
validate_after_updates=0
power=1.0
data_buffer_size=10
memory_efficient_bf16=False
num_batch_buckets=0
share_all_embeddings=True
alpha=1.0
gated_sum=False
distributed_init_method=None
report_accuracy=False
end_learning_rate=0.0
batch_size_valid=None
pipeline_devices=None
left_pad_target=False
source_word_dropout_probs=False
bf16=False
swm_suffix=swm
encoder_embed_dim=1024
force_anneal=None
no_epoch_checkpoints=False
syntax_encoder=GCN
encoder_ffn_embed_dim=4096
label_smoothing=0.1
num_shards=1
find_unused_parameters=True
no_progress_bar=False
load_alignments=False
use_old_adam=False
eval_bleu_detok_args=None
tensorboard_logdir=None
slowmo_algorithm=LocalSGD
fast_stat_sync=False
layernorm_embedding=True
encoder_layers_to_keep=None
eval_bleu_remove_bpe=None
scale_syntax_encoder_lr=None
eval_bleu=False
fp16_scale_window=None
pipeline_encoder_balance=None
pipeline_encoder_devices=None
relu_dropout=0.0
threshold_loss_scale=None
activation_fn=gelu
task=syntax-enhanced-translation
target_lang=tgt
bart_model_file_from_transformers=None
all_gather_list_size=16384
stop_time_hours=0
validate_interval_updates=0
save_interval=1
conll_suffix=['conll']
empty_cache_freq=0
encoder_learned_pos=True
tpu=False
nprocs_per_node=1
keep_last_epochs=10
device_id=0
source_lang_with_nt=src_nt
use_dpd=False
pipeline_chunks=0
cross_syntax_fuse=False
keep_interval_updates=-1
encoder_embed_path=None
adam_eps=1e-08
model_parallel_size=1
sentence_avg=False
encoder_layers=12
decoder_ffn_embed_dim=4096
dataset_impl=None
criterion=label_smoothed_cross_entropy
fixed_validation_seed=None
profile=False
distributed_rank=0
source_lang=src
eval_tokenized_bleu=False
source_word_dropout=0.2
adaptive_softmax_dropout=0
syntax_model_file=None
checkpoint_suffix=
required_seq_len_multiple=1
no_save=False
use_syntax=True
probs_suffix=['probs']
decoder_learned_pos=True
decoder_input_dim=1024
memory_efficient_fp16=False
decoder_layers_to_keep=None
gat_attention_heads=4
bucket_cap_mb=25
checkpoint_shard_count=1
pipeline_model_parallel=False
encoder_normalize_before=False
keep_best_checkpoints=-1
no_token_positional_embeddings=False
pooler_activation_fn=tanh
shard_id=0
only_dsa=False
max_update=0
encoder_attention_heads=16
freeze_bart_parameters=True
tokenizer=None
total_num_update=1000000
pipeline_decoder_balance=None
quantization_config_path=None
broadcast_buffers=False
batch_size=None
maximize_best_checkpoint_metric=False
pooler_dropout=0.0
warmup_updates=2000
min_lr=-1.0
only_gnn=True
eval_bleu_detok=space
no_seed_provided=False
truncate_source=False
pipeline_balance=None
model=SynGEC
dataset=handwritten
augment=none
device=cuda
map_location=cuda
gpu_nums=1


Sun 08 Sep 2024 09:19:28 INFO [src] dictionary: 21132 types
Sun 08 Sep 2024 09:19:28 INFO [tgt] dictionary: 21132 types
Sun 08 Sep 2024 09:19:28 INFO [syntax label0] dictionary: 51 types
Sun 08 Sep 2024 09:19:28 INFO [src] dictionary: 21132 types
Sun 08 Sep 2024 09:19:28 INFO [tgt] dictionary: 21132 types
Sun 08 Sep 2024 09:19:28 INFO [syntax label0] dictionary: 51 types
Sun 08 Sep 2024 09:19:28 INFO loaded 123 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/valid.src-tgt.src
Sun 08 Sep 2024 09:19:28 INFO loaded 123 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/valid.src-tgt.tgt
Sun 08 Sep 2024 09:19:28 INFO ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin valid src-tgt 123 examples
Sun 08 Sep 2024 09:19:28 INFO loaded 123 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/valid.conll.src-tgt.src
Sun 08 Sep 2024 09:19:28 INFO loaded 123 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/valid.dpd.src-tgt.src
Sun 08 Sep 2024 09:19:28 INFO loaded 123 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/valid.probs.src-tgt.src
Sun 08 Sep 2024 09:19:28 INFO success! syntax types: 1, source conll lines: 123
Sun 08 Sep 2024 09:19:28 INFO loaded 981 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/train.src-tgt.src
Sun 08 Sep 2024 09:19:28 INFO loaded 981 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/train.src-tgt.tgt
Sun 08 Sep 2024 09:19:28 INFO ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin train src-tgt 981 examples
Sun 08 Sep 2024 09:19:28 INFO loaded 981 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/train.conll.src-tgt.src
Sun 08 Sep 2024 09:19:28 INFO loaded 981 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/train.dpd.src-tgt.src
Sun 08 Sep 2024 09:19:28 INFO loaded 981 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/train.probs.src-tgt.src
Sun 08 Sep 2024 09:19:28 INFO success! syntax types: 1, source conll lines: 981
Sun 08 Sep 2024 09:19:28 INFO loaded 123 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_test_with_syntax_bart/bin/test.conll.src-tgt.src
Sun 08 Sep 2024 09:19:28 INFO loaded 123 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_test_with_syntax_bart/bin/test.dpd.src-tgt.src
Sun 08 Sep 2024 09:19:28 INFO loaded 123 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_test_with_syntax_bart/bin/test.probs.src-tgt.src
Sun 08 Sep 2024 09:19:28 INFO success! syntax types: 1, source conll lines: 123
Sun 08 Sep 2024 09:19:34 INFO detected shared parameter: encoder.sentence_encoder.embed_tokens.weight <- decoder.embed_tokens.weight
Sun 08 Sep 2024 09:19:34 INFO detected shared parameter: encoder.sentence_encoder.embed_tokens.weight <- decoder.output_projection.weight
Sun 08 Sep 2024 09:19:34 INFO ***********************CUDA enviroments for all 1 workers***********************
Sun 08 Sep 2024 09:19:34 INFO rank   0: capabilities =  8.0  ; total memory = 79.151 GB ; name = NVIDIA A800 80GB PCIe                   
Sun 08 Sep 2024 09:19:34 INFO ***********************CUDA enviroments for all 1 workers***********************
Sun 08 Sep 2024 09:19:34 INFO no existing checkpoint found ./gectoolkit/properties/model/SynGEC/preprocess/baseline_bart_model/chinese_bart_baseline.pt
Sun 08 Sep 2024 09:19:34 INFO loading train data for epoch 1
Sun 08 Sep 2024 09:19:34 INFO loaded 981 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/train.src-tgt.src
Sun 08 Sep 2024 09:19:34 INFO loaded 981 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/train.src-tgt.tgt
Sun 08 Sep 2024 09:19:34 INFO ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin train src-tgt 981 examples
Sun 08 Sep 2024 09:19:34 INFO loaded 981 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/train.conll.src-tgt.src
Sun 08 Sep 2024 09:19:34 INFO loaded 981 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/train.dpd.src-tgt.src
Sun 08 Sep 2024 09:19:34 INFO loaded 981 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/train.probs.src-tgt.src
Sun 08 Sep 2024 09:19:34 INFO success! syntax types: 1, source conll lines: 981
Sun 08 Sep 2024 09:19:35 INFO SynGEC(
  (model): SyntaxEnhancedBARTModel(
    (encoder): SyntaxEnhancedTransformerEncoder(
      (sentence_encoder): SyntaxEnhancedSentenceTransformerEncoder(
        (dropout_module): FairseqDropout()
        (embed_tokens): Embedding(21132, 1024, padding_idx=1)
        (embed_positions): LearnedPositionalEmbedding(514, 1024, padding_idx=1)
        (layernorm_embedding): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        (layers): ModuleList(
          (0-11): 12 x DSATransformerEncoderLayer(
            (self_attn): DSAMultiheadAttention(
              (dropout_module): FairseqDropout()
              (k_proj): Linear(in_features=1024, out_features=1024, bias=True)
              (v_proj): Linear(in_features=1024, out_features=1024, bias=True)
              (q_proj): Linear(in_features=1024, out_features=1024, bias=True)
              (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
            )
            (self_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
            (dropout_module): FairseqDropout()
            (activation_dropout_module): FairseqDropout()
            (fc1): Linear(in_features=1024, out_features=4096, bias=True)
            (fc2): Linear(in_features=4096, out_features=1024, bias=True)
            (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
      )
      (syntax_encoder): SyntaxEnhancedSyntaxGuidedTransformerEncoder(
        (dropout_module): FairseqDropout()
        (embed_tokens): Embedding(51, 1024, padding_idx=0)
        (layers): ModuleList(
          (0-2): 3 x GCNSyntaxGuidedTransformerEncoderLayer(
            (gcn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
            (dropout_module): FairseqDropout()
            (activation_dropout_module): FairseqDropout()
            (W_out): Linear(in_features=2048, out_features=1024, bias=True)
            (W_in): Linear(in_features=2048, out_features=1024, bias=True)
            (fc): Linear(in_features=1024, out_features=1024, bias=True)
            (fc1): Linear(in_features=1024, out_features=4096, bias=True)
            (fc2): Linear(in_features=4096, out_features=1024, bias=True)
            (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
      )
    )
    (decoder): SyntaxEnhancedTransformerDecoder(
      (dropout_module): FairseqDropout()
      (embed_tokens): Embedding(21132, 1024, padding_idx=1)
      (embed_positions): LearnedPositionalEmbedding(514, 1024, padding_idx=1)
      (layernorm_embedding): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      (layers): ModuleList(
        (0-11): 12 x TransformerDecoderLayer(
          (dropout_module): FairseqDropout()
          (self_attn): MultiheadAttention(
            (dropout_module): FairseqDropout()
            (k_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (v_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (q_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
          )
          (activation_dropout_module): FairseqDropout()
          (self_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          (encoder_attn): MultiheadAttention(
            (dropout_module): FairseqDropout()
            (k_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (v_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (q_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
          )
          (encoder_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          (fc1): Linear(in_features=1024, out_features=4096, bias=True)
          (fc2): Linear(in_features=4096, out_features=1024, bias=True)
          (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        )
      )
      (output_projection): Linear(in_features=1024, out_features=21132, bias=False)
    )
    (classification_heads): ModuleDict()
  )
  (criterion): LabelSmoothedCrossEntropyCriterion()
)
Sun 08 Sep 2024 09:19:35 INFO start training...
Sun 08 Sep 2024 09:19:42 INFO epoch [  1] train time 0h 0m 6s |  loss |[8560.020]
Sun 08 Sep 2024 09:20:28 INFO ---------- valid total [123] | valid precision [0.008] | valid recall [0.008] | valid f0.5 [0.008] | valid time 0h 0m 46s
Sun 08 Sep 2024 09:22:06 INFO ---------- test total [123] | test precision [0.000] | test recall [0.000] | test f0.5 [0.000] | test time 0h 1m 37s
Sun 08 Sep 2024 09:22:13 INFO epoch [  2] train time 0h 0m 5s |  loss |[8252.357]
Sun 08 Sep 2024 09:22:19 INFO epoch [  3] train time 0h 0m 5s |  loss |[8086.623]
Sun 08 Sep 2024 09:22:25 INFO epoch [  4] train time 0h 0m 5s |  loss |[8008.348]
Sun 08 Sep 2024 09:22:31 INFO epoch [  5] train time 0h 0m 5s |  loss |[7967.207]
Sun 08 Sep 2024 09:22:36 INFO epoch [  6] train time 0h 0m 5s |  loss |[7943.856]
Sun 08 Sep 2024 09:22:42 INFO epoch [  7] train time 0h 0m 5s |  loss |[7933.452]
Sun 08 Sep 2024 09:22:48 INFO epoch [  8] train time 0h 0m 5s |  loss |[7925.243]
Sun 08 Sep 2024 09:22:54 INFO epoch [  9] train time 0h 0m 5s |  loss |[7918.116]
Sun 08 Sep 2024 09:23:00 INFO epoch [ 10] train time 0h 0m 5s |  loss |[7915.193]
Sun 08 Sep 2024 09:23:05 INFO epoch [ 11] train time 0h 0m 5s |  loss |[7911.503]
Sun 08 Sep 2024 19:07:31 INFO ---------- valid total [123] | valid precision [0.008] | valid recall [0.008] | valid f0.5 [0.008] | valid time 9h 44m 25s
Sun 08 Sep 2024 19:08:04 INFO ---------- test total [123] | test precision [0.000] | test recall [0.000] | test f0.5 [0.000] | test time 0h 0m 32s
Sun 08 Sep 2024 19:08:11 INFO epoch [ 12] train time 0h 0m 5s |  loss |[7913.749]
Sun 08 Sep 2024 19:08:17 INFO epoch [ 13] train time 0h 0m 5s |  loss |[7911.667]
Sun 08 Sep 2024 19:08:23 INFO epoch [ 14] train time 0h 0m 5s |  loss |[7907.852]
Sun 08 Sep 2024 19:08:28 INFO epoch [ 15] train time 0h 0m 5s |  loss |[7908.816]
Sun 08 Sep 2024 19:08:34 INFO epoch [ 16] train time 0h 0m 5s |  loss |[7904.113]
Sun 08 Sep 2024 19:08:40 INFO epoch [ 17] train time 0h 0m 5s |  loss |[7904.551]
Sun 08 Sep 2024 19:08:46 INFO epoch [ 18] train time 0h 0m 5s |  loss |[7905.489]
Sun 08 Sep 2024 19:08:52 INFO epoch [ 19] train time 0h 0m 5s |  loss |[7901.260]
Sun 08 Sep 2024 19:08:57 INFO epoch [ 20] train time 0h 0m 5s |  loss |[7900.394]
Sun 08 Sep 2024 19:09:03 INFO epoch [ 21] train time 0h 0m 5s |  loss |[7900.936]
Sun 08 Sep 2024 21:18:50 INFO random_seed=2023
use_gpu=True
learning_rate=6e-05
train_batch_size=32
test_batch_size=1
epoch_nums=200
test_step=30
display_train_step=1
gpu_id=5
training_resume=False
load_best_config=False
supervising_mode=fully_supervised
validset_divide=True
test_only=False
shuffle=True
model_config_file=gectoolkit/properties/model/SynGEC.json
best_config_file=gectoolkit/properties/best_config/SynGEC_handwritten.json
dataset_config_file=gectoolkit/properties/dataset/handwritten.json
dataset_dir=dataset/handwritten
checkpoint_file=checkpoint/SynGEC-handwritten.pth
log_file=log/SynGEC-handwritten.log
output_dir=result/SynGEC-handwritten
checkpoint_dir=checkpoint/SynGEC-handwritten
min_word_keep=5
min_generate_keep=5
language=zh
fp16_init_scale=128
distributed_port=-1
decoder_embed_path=None
quant_noise_pq_block_size=8
best_checkpoint_metric=loss
cross_self_attention=False
validate_interval=1
tie_adaptive_weights=False
bpe=None
decoder_normalize_before=False
cpu=False
optimizer_overrides={}
quant_noise_pq=0
lr_scheduler=polynomial_decay
no_save_optimizer_state=False
train_subset=train
no_cross_attention=False
distributed_world_size=1
decoder_layerdrop=0
skip_invalid_size_inputs_valid_test=True
lr=[0.0005]
slowmo_momentum=None
log_interval=100
user_dir=./gectoolkit/model/SynGEC/src/src_syngec/syngec_model
min_loss_scale=0.0001
dual_aggregation_freeze=True
decoder_output_dim=1024
curriculum=0
scoring=bleu
optimizer=adam
adam_betas=(0.9,0.999)
share_decoder_input_output_embed=True
fp16_no_flatten_grads=False
distributed_backend=nccl
adaptive_input=False
dpd_suffix=['dpd']
attention_dropout=0.0
fp16=True
pipeline_checkpoint=never
fix_batches_to_gpus=False
fp16_scale_tolerance=0.0
valid_subset=valid
gen_subset=test
no_last_checkpoints=False
decoder_attention_heads=16
distributed_wrapper=DDP
activation_dropout=0.0
log_format=tqdm
decoder_embed_dim=1024
dual_aggregation_beta=0.5
disable_validation=False
quant_noise_scalar=0
use_bmuf=False
gat_encoder_layers=3
arch=syntax_enhanced_bart_large
eval_bleu_print_samples=False
no_scale_embedding=True
zero_sharding=none
pipeline_decoder_devices=None
save_interval_updates=0
localsgd_frequency=3
ignore_prefix_size=0
eval_bleu_args=None
encoder_layerdrop=0
syntax_type=['dep']
distributed_no_spawn=False
left_pad_source=True
decoder_layers=12
adaptive_softmax_cutoff=None
upsample_primary=1
ddp_backend=c10d
validate_after_updates=0
power=1.0
data_buffer_size=10
memory_efficient_bf16=False
num_batch_buckets=0
share_all_embeddings=True
alpha=1.0
gated_sum=False
distributed_init_method=None
report_accuracy=False
end_learning_rate=0.0
batch_size_valid=None
pipeline_devices=None
left_pad_target=False
source_word_dropout_probs=False
bf16=False
swm_suffix=swm
encoder_embed_dim=1024
force_anneal=None
no_epoch_checkpoints=False
syntax_encoder=GCN
encoder_ffn_embed_dim=4096
label_smoothing=0.1
num_shards=1
find_unused_parameters=True
no_progress_bar=False
load_alignments=False
use_old_adam=False
eval_bleu_detok_args=None
tensorboard_logdir=None
slowmo_algorithm=LocalSGD
fast_stat_sync=False
layernorm_embedding=True
encoder_layers_to_keep=None
eval_bleu_remove_bpe=None
scale_syntax_encoder_lr=None
eval_bleu=False
fp16_scale_window=None
pipeline_encoder_balance=None
pipeline_encoder_devices=None
relu_dropout=0.0
threshold_loss_scale=None
activation_fn=gelu
task=syntax-enhanced-translation
target_lang=tgt
bart_model_file_from_transformers=None
all_gather_list_size=16384
stop_time_hours=0
validate_interval_updates=0
save_interval=1
conll_suffix=['conll']
empty_cache_freq=0
encoder_learned_pos=True
tpu=False
nprocs_per_node=1
keep_last_epochs=10
device_id=0
source_lang_with_nt=src_nt
use_dpd=False
pipeline_chunks=0
cross_syntax_fuse=False
keep_interval_updates=-1
encoder_embed_path=None
adam_eps=1e-08
model_parallel_size=1
sentence_avg=False
encoder_layers=12
decoder_ffn_embed_dim=4096
dataset_impl=None
criterion=label_smoothed_cross_entropy
fixed_validation_seed=None
profile=False
distributed_rank=0
source_lang=src
eval_tokenized_bleu=False
source_word_dropout=0.2
adaptive_softmax_dropout=0
syntax_model_file=None
checkpoint_suffix=
required_seq_len_multiple=1
no_save=False
use_syntax=True
probs_suffix=['probs']
decoder_learned_pos=True
decoder_input_dim=1024
memory_efficient_fp16=False
decoder_layers_to_keep=None
gat_attention_heads=4
bucket_cap_mb=25
checkpoint_shard_count=1
pipeline_model_parallel=False
encoder_normalize_before=False
keep_best_checkpoints=-1
no_token_positional_embeddings=False
pooler_activation_fn=tanh
shard_id=0
only_dsa=False
max_update=0
encoder_attention_heads=16
freeze_bart_parameters=True
tokenizer=None
total_num_update=1000000
pipeline_decoder_balance=None
quantization_config_path=None
broadcast_buffers=False
batch_size=None
maximize_best_checkpoint_metric=False
pooler_dropout=0.0
warmup_updates=2000
min_lr=-1.0
only_gnn=True
eval_bleu_detok=space
no_seed_provided=False
truncate_source=False
pipeline_balance=None
model=SynGEC
dataset=handwritten
augment=none
device=cuda
map_location=cuda
gpu_nums=1


Sun 08 Sep 2024 21:18:50 INFO [src] dictionary: 21132 types
Sun 08 Sep 2024 21:18:50 INFO [tgt] dictionary: 21132 types
Sun 08 Sep 2024 21:18:50 INFO [syntax label0] dictionary: 51 types
Sun 08 Sep 2024 21:18:50 INFO [src] dictionary: 21132 types
Sun 08 Sep 2024 21:18:50 INFO [tgt] dictionary: 21132 types
Sun 08 Sep 2024 21:18:50 INFO [syntax label0] dictionary: 51 types
Sun 08 Sep 2024 21:18:50 INFO loaded 123 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/valid.src-tgt.src
Sun 08 Sep 2024 21:18:50 INFO loaded 123 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/valid.src-tgt.tgt
Sun 08 Sep 2024 21:18:50 INFO ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin valid src-tgt 123 examples
Sun 08 Sep 2024 21:18:50 INFO loaded 123 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/valid.conll.src-tgt.src
Sun 08 Sep 2024 21:18:50 INFO loaded 123 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/valid.dpd.src-tgt.src
Sun 08 Sep 2024 21:18:50 INFO loaded 123 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/valid.probs.src-tgt.src
Sun 08 Sep 2024 21:18:50 INFO success! syntax types: 1, source conll lines: 123
Sun 08 Sep 2024 21:18:50 INFO loaded 981 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/train.src-tgt.src
Sun 08 Sep 2024 21:18:50 INFO loaded 981 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/train.src-tgt.tgt
Sun 08 Sep 2024 21:18:50 INFO ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin train src-tgt 981 examples
Sun 08 Sep 2024 21:18:50 INFO loaded 981 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/train.conll.src-tgt.src
Sun 08 Sep 2024 21:18:50 INFO loaded 981 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/train.dpd.src-tgt.src
Sun 08 Sep 2024 21:18:50 INFO loaded 981 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/train.probs.src-tgt.src
Sun 08 Sep 2024 21:18:50 INFO success! syntax types: 1, source conll lines: 981
Sun 08 Sep 2024 21:18:50 INFO loaded 123 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_test_with_syntax_bart/bin/test.conll.src-tgt.src
Sun 08 Sep 2024 21:18:50 INFO loaded 123 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_test_with_syntax_bart/bin/test.dpd.src-tgt.src
Sun 08 Sep 2024 21:18:50 INFO loaded 123 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_test_with_syntax_bart/bin/test.probs.src-tgt.src
Sun 08 Sep 2024 21:18:50 INFO success! syntax types: 1, source conll lines: 123
Sun 08 Sep 2024 21:18:57 INFO detected shared parameter: encoder.sentence_encoder.embed_tokens.weight <- decoder.embed_tokens.weight
Sun 08 Sep 2024 21:18:57 INFO detected shared parameter: encoder.sentence_encoder.embed_tokens.weight <- decoder.output_projection.weight
Sun 08 Sep 2024 21:18:57 INFO ***********************CUDA enviroments for all 1 workers***********************
Sun 08 Sep 2024 21:18:57 INFO rank   0: capabilities =  8.0  ; total memory = 79.151 GB ; name = NVIDIA A800 80GB PCIe                   
Sun 08 Sep 2024 21:18:57 INFO ***********************CUDA enviroments for all 1 workers***********************
Sun 08 Sep 2024 21:18:57 INFO no existing checkpoint found ./gectoolkit/properties/model/SynGEC/preprocess/baseline_bart_model/chinese_bart_baseline.pt
Sun 08 Sep 2024 21:18:57 INFO loading train data for epoch 1
Sun 08 Sep 2024 21:18:57 INFO loaded 981 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/train.src-tgt.src
Sun 08 Sep 2024 21:18:57 INFO loaded 981 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/train.src-tgt.tgt
Sun 08 Sep 2024 21:18:57 INFO ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin train src-tgt 981 examples
Sun 08 Sep 2024 21:18:57 INFO loaded 981 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/train.conll.src-tgt.src
Sun 08 Sep 2024 21:18:57 INFO loaded 981 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/train.dpd.src-tgt.src
Sun 08 Sep 2024 21:18:57 INFO loaded 981 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/train.probs.src-tgt.src
Sun 08 Sep 2024 21:18:57 INFO success! syntax types: 1, source conll lines: 981
Sun 08 Sep 2024 21:18:58 INFO SynGEC(
  (model): SyntaxEnhancedBARTModel(
    (encoder): SyntaxEnhancedTransformerEncoder(
      (sentence_encoder): SyntaxEnhancedSentenceTransformerEncoder(
        (dropout_module): FairseqDropout()
        (embed_tokens): Embedding(21132, 1024, padding_idx=1)
        (embed_positions): LearnedPositionalEmbedding(514, 1024, padding_idx=1)
        (layernorm_embedding): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        (layers): ModuleList(
          (0-11): 12 x DSATransformerEncoderLayer(
            (self_attn): DSAMultiheadAttention(
              (dropout_module): FairseqDropout()
              (k_proj): Linear(in_features=1024, out_features=1024, bias=True)
              (v_proj): Linear(in_features=1024, out_features=1024, bias=True)
              (q_proj): Linear(in_features=1024, out_features=1024, bias=True)
              (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
            )
            (self_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
            (dropout_module): FairseqDropout()
            (activation_dropout_module): FairseqDropout()
            (fc1): Linear(in_features=1024, out_features=4096, bias=True)
            (fc2): Linear(in_features=4096, out_features=1024, bias=True)
            (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
      )
      (syntax_encoder): SyntaxEnhancedSyntaxGuidedTransformerEncoder(
        (dropout_module): FairseqDropout()
        (embed_tokens): Embedding(51, 1024, padding_idx=0)
        (layers): ModuleList(
          (0-2): 3 x GCNSyntaxGuidedTransformerEncoderLayer(
            (gcn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
            (dropout_module): FairseqDropout()
            (activation_dropout_module): FairseqDropout()
            (W_out): Linear(in_features=2048, out_features=1024, bias=True)
            (W_in): Linear(in_features=2048, out_features=1024, bias=True)
            (fc): Linear(in_features=1024, out_features=1024, bias=True)
            (fc1): Linear(in_features=1024, out_features=4096, bias=True)
            (fc2): Linear(in_features=4096, out_features=1024, bias=True)
            (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
      )
    )
    (decoder): SyntaxEnhancedTransformerDecoder(
      (dropout_module): FairseqDropout()
      (embed_tokens): Embedding(21132, 1024, padding_idx=1)
      (embed_positions): LearnedPositionalEmbedding(514, 1024, padding_idx=1)
      (layernorm_embedding): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      (layers): ModuleList(
        (0-11): 12 x TransformerDecoderLayer(
          (dropout_module): FairseqDropout()
          (self_attn): MultiheadAttention(
            (dropout_module): FairseqDropout()
            (k_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (v_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (q_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
          )
          (activation_dropout_module): FairseqDropout()
          (self_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          (encoder_attn): MultiheadAttention(
            (dropout_module): FairseqDropout()
            (k_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (v_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (q_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
          )
          (encoder_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          (fc1): Linear(in_features=1024, out_features=4096, bias=True)
          (fc2): Linear(in_features=4096, out_features=1024, bias=True)
          (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        )
      )
      (output_projection): Linear(in_features=1024, out_features=21132, bias=False)
    )
    (classification_heads): ModuleDict()
  )
  (criterion): LabelSmoothedCrossEntropyCriterion()
)
Sun 08 Sep 2024 21:18:58 INFO start training...
Sun 08 Sep 2024 21:19:04 INFO epoch [  1] train time 0h 0m 6s |  loss |[8560.020]
Sun 08 Sep 2024 21:19:51 INFO ---------- valid total [123] | valid precision [0.008] | valid recall [0.008] | valid f0.5 [0.008] | valid time 0h 0m 46s
Sun 08 Sep 2024 21:21:28 INFO ---------- test total [123] | test precision [0.000] | test recall [0.000] | test f0.5 [0.000] | test time 0h 1m 37s
Sun 08 Sep 2024 21:21:36 INFO epoch [  2] train time 0h 0m 5s |  loss |[8252.357]
Sun 08 Sep 2024 21:21:42 INFO epoch [  3] train time 0h 0m 5s |  loss |[8086.623]
Sun 08 Sep 2024 21:21:47 INFO epoch [  4] train time 0h 0m 5s |  loss |[8008.348]
Sun 08 Sep 2024 21:21:53 INFO epoch [  5] train time 0h 0m 5s |  loss |[7967.207]
Sun 08 Sep 2024 21:21:59 INFO epoch [  6] train time 0h 0m 5s |  loss |[7943.856]
Sun 08 Sep 2024 21:22:05 INFO epoch [  7] train time 0h 0m 5s |  loss |[7933.452]
Sun 08 Sep 2024 21:22:10 INFO epoch [  8] train time 0h 0m 5s |  loss |[7925.243]
Sun 08 Sep 2024 21:22:16 INFO epoch [  9] train time 0h 0m 5s |  loss |[7918.116]
Sun 08 Sep 2024 21:22:22 INFO epoch [ 10] train time 0h 0m 5s |  loss |[7915.193]
Sun 08 Sep 2024 21:22:28 INFO epoch [ 11] train time 0h 0m 5s |  loss |[7911.503]
Sun 08 Sep 2024 21:22:34 INFO epoch [ 12] train time 0h 0m 5s |  loss |[7913.749]
Sun 08 Sep 2024 21:22:40 INFO epoch [ 13] train time 0h 0m 5s |  loss |[7911.667]
Sun 08 Sep 2024 21:22:45 INFO epoch [ 14] train time 0h 0m 5s |  loss |[7907.852]
Sun 08 Sep 2024 21:22:51 INFO epoch [ 15] train time 0h 0m 5s |  loss |[7908.816]
Sun 08 Sep 2024 21:22:57 INFO epoch [ 16] train time 0h 0m 5s |  loss |[7904.113]
Sun 08 Sep 2024 21:23:03 INFO epoch [ 17] train time 0h 0m 5s |  loss |[7904.551]
Sun 08 Sep 2024 21:23:09 INFO epoch [ 18] train time 0h 0m 5s |  loss |[7905.489]
Sun 08 Sep 2024 21:23:15 INFO epoch [ 19] train time 0h 0m 5s |  loss |[7901.260]
Sun 08 Sep 2024 21:23:21 INFO epoch [ 20] train time 0h 0m 5s |  loss |[7900.394]
Sun 08 Sep 2024 21:23:27 INFO epoch [ 21] train time 0h 0m 5s |  loss |[7900.936]
Sun 08 Sep 2024 21:23:33 INFO epoch [ 22] train time 0h 0m 5s |  loss |[7899.575]
Sun 08 Sep 2024 21:23:39 INFO epoch [ 23] train time 0h 0m 5s |  loss |[7897.528]
Sun 08 Sep 2024 21:23:45 INFO epoch [ 24] train time 0h 0m 5s |  loss |[7896.151]
Sun 08 Sep 2024 21:23:51 INFO epoch [ 25] train time 0h 0m 5s |  loss |[7896.741]
Sun 08 Sep 2024 21:23:57 INFO epoch [ 26] train time 0h 0m 5s |  loss |[7895.205]
Sun 08 Sep 2024 21:24:03 INFO epoch [ 27] train time 0h 0m 5s |  loss |[7892.552]
Sun 08 Sep 2024 21:24:08 INFO epoch [ 28] train time 0h 0m 5s |  loss |[7893.099]
Sun 08 Sep 2024 21:24:14 INFO epoch [ 29] train time 0h 0m 5s |  loss |[7893.425]
Sun 08 Sep 2024 21:24:20 INFO epoch [ 30] train time 0h 0m 5s |  loss |[7892.284]
Sun 08 Sep 2024 21:24:26 INFO epoch [ 31] train time 0h 0m 5s |  loss |[7893.933]
Sun 08 Sep 2024 21:25:14 INFO ---------- valid total [123] | valid precision [0.008] | valid recall [0.008] | valid f0.5 [0.008] | valid time 0h 0m 47s
Sun 08 Sep 2024 21:25:52 INFO ---------- test total [123] | test precision [0.000] | test recall [0.000] | test f0.5 [0.000] | test time 0h 0m 38s
Sun 08 Sep 2024 21:26:00 INFO epoch [ 32] train time 0h 0m 5s |  loss |[7891.361]
Sun 08 Sep 2024 21:26:06 INFO epoch [ 33] train time 0h 0m 5s |  loss |[7887.463]
Sun 08 Sep 2024 21:26:12 INFO epoch [ 34] train time 0h 0m 5s |  loss |[7886.508]
Sun 08 Sep 2024 21:26:17 INFO epoch [ 35] train time 0h 0m 5s |  loss |[7885.006]
Sun 08 Sep 2024 21:26:23 INFO epoch [ 36] train time 0h 0m 5s |  loss |[7880.520]
Sun 08 Sep 2024 21:26:29 INFO epoch [ 37] train time 0h 0m 5s |  loss |[7883.492]
Sun 08 Sep 2024 21:26:35 INFO epoch [ 38] train time 0h 0m 5s |  loss |[7880.649]
Sun 08 Sep 2024 21:26:41 INFO epoch [ 39] train time 0h 0m 5s |  loss |[7876.226]
Sun 08 Sep 2024 21:26:46 INFO epoch [ 40] train time 0h 0m 5s |  loss |[7873.205]
Sun 08 Sep 2024 21:26:52 INFO epoch [ 41] train time 0h 0m 5s |  loss |[7871.186]
Sun 08 Sep 2024 21:26:58 INFO epoch [ 42] train time 0h 0m 5s |  loss |[7868.907]
Sun 08 Sep 2024 21:27:04 INFO epoch [ 43] train time 0h 0m 5s |  loss |[7867.099]
Sun 08 Sep 2024 21:27:10 INFO epoch [ 44] train time 0h 0m 5s |  loss |[7862.537]
Sun 08 Sep 2024 21:27:16 INFO epoch [ 45] train time 0h 0m 5s |  loss |[7861.476]
Sun 08 Sep 2024 21:27:22 INFO epoch [ 46] train time 0h 0m 5s |  loss |[7860.731]
Sun 08 Sep 2024 21:27:28 INFO epoch [ 47] train time 0h 0m 5s |  loss |[7856.243]
Sun 08 Sep 2024 21:27:34 INFO epoch [ 48] train time 0h 0m 5s |  loss |[7853.275]
Sun 08 Sep 2024 21:27:40 INFO epoch [ 49] train time 0h 0m 5s |  loss |[7851.359]
Sun 08 Sep 2024 21:27:46 INFO epoch [ 50] train time 0h 0m 5s |  loss |[7850.374]
Sun 08 Sep 2024 21:27:52 INFO epoch [ 51] train time 0h 0m 5s |  loss |[7846.240]
Sun 08 Sep 2024 21:27:58 INFO epoch [ 52] train time 0h 0m 5s |  loss |[7843.171]
Sun 08 Sep 2024 21:28:04 INFO epoch [ 53] train time 0h 0m 5s |  loss |[7841.393]
Sun 08 Sep 2024 21:28:10 INFO epoch [ 54] train time 0h 0m 5s |  loss |[7839.674]
Sun 08 Sep 2024 21:28:15 INFO epoch [ 55] train time 0h 0m 5s |  loss |[7836.675]
Sun 08 Sep 2024 21:28:21 INFO epoch [ 56] train time 0h 0m 5s |  loss |[7833.692]
Sun 08 Sep 2024 21:28:27 INFO epoch [ 57] train time 0h 0m 5s |  loss |[7834.376]
Sun 08 Sep 2024 21:28:33 INFO epoch [ 58] train time 0h 0m 5s |  loss |[7834.336]
Sun 08 Sep 2024 21:28:39 INFO epoch [ 59] train time 0h 0m 5s |  loss |[7832.566]
Sun 08 Sep 2024 21:28:45 INFO epoch [ 60] train time 0h 0m 5s |  loss |[7824.988]
Sun 08 Sep 2024 21:28:51 INFO epoch [ 61] train time 0h 0m 5s |  loss |[7826.825]
Sun 08 Sep 2024 21:29:30 INFO ---------- valid total [123] | valid precision [0.008] | valid recall [0.008] | valid f0.5 [0.008] | valid time 0h 0m 38s
Sun 08 Sep 2024 21:30:13 INFO ---------- test total [123] | test precision [0.000] | test recall [0.000] | test f0.5 [0.000] | test time 0h 0m 43s
Sun 08 Sep 2024 21:30:20 INFO epoch [ 62] train time 0h 0m 5s |  loss |[7818.154]
Sun 08 Sep 2024 21:30:26 INFO epoch [ 63] train time 0h 0m 5s |  loss |[7820.459]
Sun 08 Sep 2024 21:30:32 INFO epoch [ 64] train time 0h 0m 5s |  loss |[7820.777]
Sun 08 Sep 2024 21:30:38 INFO epoch [ 65] train time 0h 0m 5s |  loss |[7818.211]
Sun 08 Sep 2024 21:30:44 INFO epoch [ 66] train time 0h 0m 5s |  loss |[7818.472]
Sun 08 Sep 2024 21:30:49 INFO epoch [ 67] train time 0h 0m 5s |  loss |[7812.772]
Sun 08 Sep 2024 21:30:55 INFO epoch [ 68] train time 0h 0m 5s |  loss |[7811.085]
Sun 08 Sep 2024 21:31:01 INFO epoch [ 69] train time 0h 0m 5s |  loss |[7809.947]
Sun 08 Sep 2024 21:31:07 INFO epoch [ 70] train time 0h 0m 5s |  loss |[7810.017]
Sun 08 Sep 2024 21:31:13 INFO epoch [ 71] train time 0h 0m 5s |  loss |[7808.222]
Sun 08 Sep 2024 21:31:19 INFO epoch [ 72] train time 0h 0m 5s |  loss |[7808.799]
Sun 08 Sep 2024 21:31:25 INFO epoch [ 73] train time 0h 0m 5s |  loss |[7804.976]
Sun 08 Sep 2024 21:31:31 INFO epoch [ 74] train time 0h 0m 5s |  loss |[7801.121]
Sun 08 Sep 2024 21:31:37 INFO epoch [ 75] train time 0h 0m 5s |  loss |[7799.450]
Sun 08 Sep 2024 21:31:42 INFO epoch [ 76] train time 0h 0m 5s |  loss |[7798.730]
Sun 08 Sep 2024 21:31:48 INFO epoch [ 77] train time 0h 0m 5s |  loss |[7797.353]
Sun 08 Sep 2024 21:31:54 INFO epoch [ 78] train time 0h 0m 5s |  loss |[7798.106]
Sun 08 Sep 2024 21:32:00 INFO epoch [ 79] train time 0h 0m 5s |  loss |[7790.957]
Sun 08 Sep 2024 21:32:06 INFO epoch [ 80] train time 0h 0m 5s |  loss |[7792.135]
Sun 08 Sep 2024 21:32:12 INFO epoch [ 81] train time 0h 0m 5s |  loss |[7789.982]
Sun 08 Sep 2024 21:32:18 INFO epoch [ 82] train time 0h 0m 5s |  loss |[7788.451]
Sun 08 Sep 2024 21:32:24 INFO epoch [ 83] train time 0h 0m 5s |  loss |[7790.871]
Sun 08 Sep 2024 21:32:30 INFO epoch [ 84] train time 0h 0m 5s |  loss |[7785.219]
Sun 08 Sep 2024 21:32:36 INFO epoch [ 85] train time 0h 0m 5s |  loss |[7782.043]
Sun 08 Sep 2024 21:32:42 INFO epoch [ 86] train time 0h 0m 5s |  loss |[7781.752]
Sun 08 Sep 2024 21:32:48 INFO epoch [ 87] train time 0h 0m 5s |  loss |[7785.471]
Sun 08 Sep 2024 21:32:54 INFO epoch [ 88] train time 0h 0m 5s |  loss |[7778.313]
Sun 08 Sep 2024 21:33:00 INFO epoch [ 89] train time 0h 0m 5s |  loss |[7779.290]
Sun 08 Sep 2024 21:33:06 INFO epoch [ 90] train time 0h 0m 5s |  loss |[7774.700]
Sun 08 Sep 2024 21:33:12 INFO epoch [ 91] train time 0h 0m 5s |  loss |[7777.172]
Sun 08 Sep 2024 21:35:43 INFO ---------- valid total [123] | valid precision [0.008] | valid recall [0.008] | valid f0.5 [0.008] | valid time 0h 2m 31s
Sun 08 Sep 2024 21:36:28 INFO ---------- test total [123] | test precision [0.000] | test recall [0.000] | test f0.5 [0.000] | test time 0h 0m 44s
Sun 08 Sep 2024 21:36:36 INFO epoch [ 92] train time 0h 0m 5s |  loss |[7774.663]
Sun 08 Sep 2024 21:36:42 INFO epoch [ 93] train time 0h 0m 5s |  loss |[7774.624]
Sun 08 Sep 2024 21:36:47 INFO epoch [ 94] train time 0h 0m 5s |  loss |[7771.415]
Sun 08 Sep 2024 21:36:53 INFO epoch [ 95] train time 0h 0m 5s |  loss |[7771.450]
Sun 08 Sep 2024 21:36:59 INFO epoch [ 96] train time 0h 0m 5s |  loss |[7768.665]
Sun 08 Sep 2024 21:37:05 INFO epoch [ 97] train time 0h 0m 5s |  loss |[7766.460]
Sun 08 Sep 2024 21:37:11 INFO epoch [ 98] train time 0h 0m 5s |  loss |[7765.749]
Sun 08 Sep 2024 21:37:17 INFO epoch [ 99] train time 0h 0m 5s |  loss |[7766.015]
Sun 08 Sep 2024 21:37:22 INFO epoch [100] train time 0h 0m 5s |  loss |[7760.639]
Sun 08 Sep 2024 21:37:28 INFO epoch [101] train time 0h 0m 5s |  loss |[7760.958]
Sun 08 Sep 2024 21:37:34 INFO epoch [102] train time 0h 0m 5s |  loss |[7760.191]
Sun 08 Sep 2024 21:37:40 INFO epoch [103] train time 0h 0m 5s |  loss |[7759.571]
Sun 08 Sep 2024 21:37:46 INFO epoch [104] train time 0h 0m 5s |  loss |[7758.850]
Sun 08 Sep 2024 21:37:52 INFO epoch [105] train time 0h 0m 5s |  loss |[7759.146]
Sun 08 Sep 2024 21:37:58 INFO epoch [106] train time 0h 0m 5s |  loss |[7757.826]
Sun 08 Sep 2024 21:38:04 INFO epoch [107] train time 0h 0m 5s |  loss |[7756.325]
Sun 08 Sep 2024 21:38:10 INFO epoch [108] train time 0h 0m 5s |  loss |[7753.323]
Sun 08 Sep 2024 21:38:16 INFO epoch [109] train time 0h 0m 6s |  loss |[7753.416]
Sun 08 Sep 2024 21:38:22 INFO epoch [110] train time 0h 0m 5s |  loss |[7748.907]
Sun 08 Sep 2024 21:38:28 INFO epoch [111] train time 0h 0m 5s |  loss |[7750.001]
Sun 08 Sep 2024 21:38:34 INFO epoch [112] train time 0h 0m 5s |  loss |[7747.908]
Sun 08 Sep 2024 21:38:40 INFO epoch [113] train time 0h 0m 5s |  loss |[7748.547]
Sun 08 Sep 2024 21:38:46 INFO epoch [114] train time 0h 0m 5s |  loss |[7743.328]
Sun 08 Sep 2024 21:38:52 INFO epoch [115] train time 0h 0m 5s |  loss |[7744.679]
Sun 08 Sep 2024 21:38:58 INFO epoch [116] train time 0h 0m 5s |  loss |[7745.061]
Sun 08 Sep 2024 21:39:03 INFO epoch [117] train time 0h 0m 5s |  loss |[7741.541]
Sun 08 Sep 2024 21:39:09 INFO epoch [118] train time 0h 0m 5s |  loss |[7745.038]
Sun 08 Sep 2024 21:39:15 INFO epoch [119] train time 0h 0m 5s |  loss |[7741.864]
Sun 08 Sep 2024 21:39:21 INFO epoch [120] train time 0h 0m 5s |  loss |[7741.843]
Sun 08 Sep 2024 21:39:27 INFO epoch [121] train time 0h 0m 5s |  loss |[7740.238]
Sun 08 Sep 2024 22:05:18 INFO ---------- valid total [123] | valid precision [0.008] | valid recall [0.008] | valid f0.5 [0.008] | valid time 0h 25m 50s
Sun 08 Sep 2024 22:05:54 INFO ---------- test total [123] | test precision [0.000] | test recall [0.000] | test f0.5 [0.000] | test time 0h 0m 36s
Sun 08 Sep 2024 22:06:02 INFO epoch [122] train time 0h 0m 5s |  loss |[7737.362]
Sun 08 Sep 2024 22:06:08 INFO epoch [123] train time 0h 0m 5s |  loss |[7733.869]
Sun 08 Sep 2024 22:06:14 INFO epoch [124] train time 0h 0m 5s |  loss |[7735.258]
Sun 08 Sep 2024 22:06:19 INFO epoch [125] train time 0h 0m 5s |  loss |[7732.025]
Sun 08 Sep 2024 22:06:25 INFO epoch [126] train time 0h 0m 5s |  loss |[7735.110]
Sun 08 Sep 2024 22:06:31 INFO epoch [127] train time 0h 0m 5s |  loss |[7733.058]
Sun 08 Sep 2024 22:06:37 INFO epoch [128] train time 0h 0m 5s |  loss |[7730.816]
Sun 08 Sep 2024 22:06:43 INFO epoch [129] train time 0h 0m 5s |  loss |[7729.512]
Sun 08 Sep 2024 22:06:49 INFO epoch [130] train time 0h 0m 5s |  loss |[7730.064]
Sun 08 Sep 2024 22:06:54 INFO epoch [131] train time 0h 0m 5s |  loss |[7726.781]
Sun 08 Sep 2024 22:07:00 INFO epoch [132] train time 0h 0m 5s |  loss |[7729.768]
Sun 08 Sep 2024 22:07:06 INFO epoch [133] train time 0h 0m 5s |  loss |[7728.422]
Sun 08 Sep 2024 22:07:12 INFO epoch [134] train time 0h 0m 5s |  loss |[7727.760]
Sun 08 Sep 2024 22:07:18 INFO epoch [135] train time 0h 0m 5s |  loss |[7724.481]
Sun 08 Sep 2024 22:07:24 INFO epoch [136] train time 0h 0m 5s |  loss |[7722.651]
Sun 08 Sep 2024 22:07:30 INFO epoch [137] train time 0h 0m 5s |  loss |[7719.143]
Sun 08 Sep 2024 22:07:36 INFO epoch [138] train time 0h 0m 5s |  loss |[7722.562]
Sun 08 Sep 2024 22:07:42 INFO epoch [139] train time 0h 0m 5s |  loss |[7721.321]
Sun 08 Sep 2024 22:07:48 INFO epoch [140] train time 0h 0m 5s |  loss |[7718.389]
Sun 08 Sep 2024 22:07:54 INFO epoch [141] train time 0h 0m 6s |  loss |[7723.908]
Sun 08 Sep 2024 22:08:00 INFO epoch [142] train time 0h 0m 5s |  loss |[7714.478]
Sun 08 Sep 2024 22:08:06 INFO epoch [143] train time 0h 0m 5s |  loss |[7718.406]
Sun 08 Sep 2024 22:08:12 INFO epoch [144] train time 0h 0m 5s |  loss |[7714.566]
Sun 08 Sep 2024 22:08:18 INFO epoch [145] train time 0h 0m 5s |  loss |[7716.486]
Sun 08 Sep 2024 22:08:24 INFO epoch [146] train time 0h 0m 5s |  loss |[7712.208]
Sun 08 Sep 2024 22:08:30 INFO epoch [147] train time 0h 0m 5s |  loss |[7712.995]
Sun 08 Sep 2024 22:08:36 INFO epoch [148] train time 0h 0m 5s |  loss |[7711.674]
Sun 08 Sep 2024 22:08:42 INFO epoch [149] train time 0h 0m 5s |  loss |[7711.758]
Sun 08 Sep 2024 22:08:47 INFO epoch [150] train time 0h 0m 5s |  loss |[7713.593]
Sun 08 Sep 2024 22:08:53 INFO epoch [151] train time 0h 0m 5s |  loss |[7707.643]
Sun 08 Sep 2024 22:09:34 INFO ---------- valid total [123] | valid precision [0.008] | valid recall [0.008] | valid f0.5 [0.008] | valid time 0h 0m 40s
Sun 08 Sep 2024 22:10:23 INFO ---------- test total [123] | test precision [0.000] | test recall [0.000] | test f0.5 [0.000] | test time 0h 0m 48s
Sun 08 Sep 2024 22:10:31 INFO epoch [152] train time 0h 0m 5s |  loss |[7708.620]
Sun 08 Sep 2024 22:10:36 INFO epoch [153] train time 0h 0m 5s |  loss |[7710.096]
Sun 08 Sep 2024 22:10:42 INFO epoch [154] train time 0h 0m 5s |  loss |[7706.577]
Sun 08 Sep 2024 22:10:48 INFO epoch [155] train time 0h 0m 5s |  loss |[7707.754]
Sun 08 Sep 2024 22:10:54 INFO epoch [156] train time 0h 0m 5s |  loss |[7710.558]
Sun 08 Sep 2024 22:11:00 INFO epoch [157] train time 0h 0m 5s |  loss |[7705.372]
Sun 08 Sep 2024 22:11:05 INFO epoch [158] train time 0h 0m 5s |  loss |[7706.150]
Sun 08 Sep 2024 22:11:11 INFO epoch [159] train time 0h 0m 5s |  loss |[7703.170]
Sun 08 Sep 2024 22:11:17 INFO epoch [160] train time 0h 0m 5s |  loss |[7700.945]
Sun 08 Sep 2024 22:11:23 INFO epoch [161] train time 0h 0m 5s |  loss |[7701.723]
Sun 08 Sep 2024 22:11:29 INFO epoch [162] train time 0h 0m 5s |  loss |[7703.927]
Sun 08 Sep 2024 22:11:35 INFO epoch [163] train time 0h 0m 5s |  loss |[7701.604]
Sun 08 Sep 2024 22:11:41 INFO epoch [164] train time 0h 0m 5s |  loss |[7700.010]
Sun 08 Sep 2024 22:11:47 INFO epoch [165] train time 0h 0m 5s |  loss |[7701.008]
Sun 08 Sep 2024 22:11:53 INFO epoch [166] train time 0h 0m 5s |  loss |[7698.201]
Sun 08 Sep 2024 22:11:59 INFO epoch [167] train time 0h 0m 5s |  loss |[7701.727]
Sun 08 Sep 2024 22:12:04 INFO epoch [168] train time 0h 0m 5s |  loss |[7698.077]
Sun 08 Sep 2024 22:12:10 INFO epoch [169] train time 0h 0m 5s |  loss |[7696.249]
Sun 08 Sep 2024 22:12:16 INFO epoch [170] train time 0h 0m 5s |  loss |[7696.898]
Sun 08 Sep 2024 22:12:22 INFO epoch [171] train time 0h 0m 5s |  loss |[7693.939]
Sun 08 Sep 2024 22:12:28 INFO epoch [172] train time 0h 0m 5s |  loss |[7695.156]
Sun 08 Sep 2024 22:12:34 INFO epoch [173] train time 0h 0m 5s |  loss |[7694.628]
Sun 08 Sep 2024 22:12:40 INFO epoch [174] train time 0h 0m 5s |  loss |[7695.504]
Sun 08 Sep 2024 22:12:46 INFO epoch [175] train time 0h 0m 5s |  loss |[7691.692]
Sun 08 Sep 2024 22:12:52 INFO epoch [176] train time 0h 0m 5s |  loss |[7692.008]
Sun 08 Sep 2024 22:12:58 INFO epoch [177] train time 0h 0m 5s |  loss |[7693.659]
Sun 08 Sep 2024 22:13:04 INFO epoch [178] train time 0h 0m 5s |  loss |[7691.312]
Sun 08 Sep 2024 22:13:10 INFO epoch [179] train time 0h 0m 5s |  loss |[7691.462]
Sun 08 Sep 2024 22:13:16 INFO epoch [180] train time 0h 0m 5s |  loss |[7688.768]
Sun 08 Sep 2024 22:13:22 INFO epoch [181] train time 0h 0m 5s |  loss |[7689.656]
Sun 08 Sep 2024 22:14:05 INFO ---------- valid total [123] | valid precision [0.008] | valid recall [0.008] | valid f0.5 [0.008] | valid time 0h 0m 43s
Sun 08 Sep 2024 22:14:50 INFO ---------- test total [123] | test precision [0.000] | test recall [0.000] | test f0.5 [0.000] | test time 0h 0m 44s
Sun 08 Sep 2024 22:14:57 INFO epoch [182] train time 0h 0m 5s |  loss |[7689.903]
Sun 08 Sep 2024 22:15:03 INFO epoch [183] train time 0h 0m 5s |  loss |[7687.836]
Sun 08 Sep 2024 22:15:09 INFO epoch [184] train time 0h 0m 5s |  loss |[7685.378]
Sun 08 Sep 2024 22:15:15 INFO epoch [185] train time 0h 0m 5s |  loss |[7682.232]
Sun 08 Sep 2024 22:15:20 INFO epoch [186] train time 0h 0m 5s |  loss |[7683.472]
Sun 08 Sep 2024 22:15:26 INFO epoch [187] train time 0h 0m 5s |  loss |[7683.942]
Sun 08 Sep 2024 22:15:32 INFO epoch [188] train time 0h 0m 5s |  loss |[7683.948]
Sun 08 Sep 2024 22:15:38 INFO epoch [189] train time 0h 0m 5s |  loss |[7684.236]
Sun 08 Sep 2024 22:15:44 INFO epoch [190] train time 0h 0m 5s |  loss |[7682.009]
Sun 08 Sep 2024 22:15:50 INFO epoch [191] train time 0h 0m 5s |  loss |[7684.699]
Sun 08 Sep 2024 22:15:56 INFO epoch [192] train time 0h 0m 5s |  loss |[7679.637]
Sun 08 Sep 2024 22:16:01 INFO epoch [193] train time 0h 0m 5s |  loss |[7684.140]
Sun 08 Sep 2024 22:16:07 INFO epoch [194] train time 0h 0m 5s |  loss |[7678.802]
Sun 08 Sep 2024 22:16:13 INFO epoch [195] train time 0h 0m 5s |  loss |[7681.745]
Sun 08 Sep 2024 22:16:19 INFO epoch [196] train time 0h 0m 5s |  loss |[7676.418]
Sun 08 Sep 2024 22:16:25 INFO epoch [197] train time 0h 0m 5s |  loss |[7676.384]
Sun 08 Sep 2024 22:41:09 INFO ---------- valid total [123] | valid precision [0.008] | valid recall [0.008] | valid f0.5 [0.008] | valid time 0h 24m 43s
Sun 08 Sep 2024 22:41:52 INFO ---------- test total [123] | test precision [0.000] | test recall [0.000] | test f0.5 [0.000] | test time 0h 0m 43s
Sun 08 Sep 2024 22:42:00 INFO epoch [198] train time 0h 0m 5s |  loss |[7677.329]
Sun 08 Sep 2024 23:06:43 INFO ---------- valid total [123] | valid precision [0.008] | valid recall [0.008] | valid f0.5 [0.008] | valid time 0h 24m 43s
Sun 08 Sep 2024 23:07:23 INFO ---------- test total [123] | test precision [0.000] | test recall [0.000] | test f0.5 [0.000] | test time 0h 0m 39s
Sun 08 Sep 2024 23:07:31 INFO epoch [199] train time 0h 0m 5s |  loss |[7674.590]
Sun 08 Sep 2024 23:32:38 INFO ---------- valid total [123] | valid precision [0.008] | valid recall [0.008] | valid f0.5 [0.008] | valid time 0h 25m 7s
Sun 08 Sep 2024 23:33:16 INFO ---------- test total [123] | test precision [0.000] | test recall [0.000] | test f0.5 [0.000] | test time 0h 0m 37s
Sun 08 Sep 2024 23:33:23 INFO epoch [200] train time 0h 0m 5s |  loss |[7675.089]
Sun 08 Sep 2024 23:58:30 INFO ---------- valid total [123] | valid precision [0.008] | valid recall [0.008] | valid f0.5 [0.008] | valid time 0h 25m 6s
Sun 08 Sep 2024 23:59:07 INFO ---------- test total [123] | test precision [0.000] | test recall [0.000] | test f0.5 [0.000] | test time 0h 0m 37s
Sun 08 Sep 2024 23:59:09 INFO training finished.
                            best valid result: precision [0.008] | recall [0.008] | F0.5 [0.008]
                            best test result : precision [0.000] | recall [0.000] | F0.5 [0.000]
Tue 10 Sep 2024 21:40:14 INFO random_seed=2023
use_gpu=True
learning_rate=6e-05
train_batch_size=32
test_batch_size=1
epoch_nums=200
test_step=30
display_train_step=1
gpu_id=5
training_resume=False
load_best_config=False
supervising_mode=fully_supervised
validset_divide=True
test_only=False
shuffle=True
model_config_file=gectoolkit/properties/model/SynGEC.json
best_config_file=gectoolkit/properties/best_config/SynGEC_handwritten.json
dataset_config_file=gectoolkit/properties/dataset/handwritten.json
dataset_dir=dataset/handwritten
checkpoint_file=checkpoint/SynGEC-handwritten.pth
log_file=log/SynGEC-handwritten.log
output_dir=result/SynGEC-handwritten
checkpoint_dir=checkpoint/SynGEC-handwritten
min_word_keep=5
min_generate_keep=5
language=zh
fp16_init_scale=128
distributed_port=-1
decoder_embed_path=None
quant_noise_pq_block_size=8
best_checkpoint_metric=loss
cross_self_attention=False
validate_interval=1
tie_adaptive_weights=False
bpe=None
decoder_normalize_before=False
cpu=False
optimizer_overrides={}
quant_noise_pq=0
lr_scheduler=polynomial_decay
no_save_optimizer_state=False
train_subset=train
no_cross_attention=False
distributed_world_size=1
decoder_layerdrop=0
skip_invalid_size_inputs_valid_test=True
lr=[0.0005]
slowmo_momentum=None
log_interval=100
user_dir=./gectoolkit/model/SynGEC/src/src_syngec/syngec_model
min_loss_scale=0.0001
dual_aggregation_freeze=True
decoder_output_dim=1024
curriculum=0
scoring=bleu
optimizer=adam
adam_betas=(0.9,0.999)
share_decoder_input_output_embed=True
fp16_no_flatten_grads=False
distributed_backend=nccl
adaptive_input=False
dpd_suffix=['dpd']
attention_dropout=0.0
fp16=True
pipeline_checkpoint=never
fix_batches_to_gpus=False
fp16_scale_tolerance=0.0
valid_subset=valid
gen_subset=test
no_last_checkpoints=False
decoder_attention_heads=16
distributed_wrapper=DDP
activation_dropout=0.0
log_format=tqdm
decoder_embed_dim=1024
dual_aggregation_beta=0.5
disable_validation=False
quant_noise_scalar=0
use_bmuf=False
gat_encoder_layers=3
arch=syntax_enhanced_bart_large
eval_bleu_print_samples=False
no_scale_embedding=True
zero_sharding=none
pipeline_decoder_devices=None
save_interval_updates=0
localsgd_frequency=3
ignore_prefix_size=0
eval_bleu_args=None
encoder_layerdrop=0
syntax_type=['dep']
distributed_no_spawn=False
left_pad_source=True
decoder_layers=12
adaptive_softmax_cutoff=None
upsample_primary=1
ddp_backend=c10d
validate_after_updates=0
power=1.0
data_buffer_size=10
memory_efficient_bf16=False
num_batch_buckets=0
share_all_embeddings=True
alpha=1.0
gated_sum=False
distributed_init_method=None
report_accuracy=False
end_learning_rate=0.0
batch_size_valid=None
pipeline_devices=None
left_pad_target=False
source_word_dropout_probs=False
bf16=False
swm_suffix=swm
encoder_embed_dim=1024
force_anneal=None
no_epoch_checkpoints=False
syntax_encoder=GCN
encoder_ffn_embed_dim=4096
label_smoothing=0.1
num_shards=1
find_unused_parameters=True
no_progress_bar=False
load_alignments=False
use_old_adam=False
eval_bleu_detok_args=None
tensorboard_logdir=None
slowmo_algorithm=LocalSGD
fast_stat_sync=False
layernorm_embedding=True
encoder_layers_to_keep=None
eval_bleu_remove_bpe=None
scale_syntax_encoder_lr=None
eval_bleu=False
fp16_scale_window=None
pipeline_encoder_balance=None
pipeline_encoder_devices=None
relu_dropout=0.0
threshold_loss_scale=None
activation_fn=gelu
task=syntax-enhanced-translation
target_lang=tgt
bart_model_file_from_transformers=None
all_gather_list_size=16384
stop_time_hours=0
validate_interval_updates=0
save_interval=1
conll_suffix=['conll']
empty_cache_freq=0
encoder_learned_pos=True
tpu=False
nprocs_per_node=1
keep_last_epochs=10
device_id=0
source_lang_with_nt=src_nt
use_dpd=False
pipeline_chunks=0
cross_syntax_fuse=False
keep_interval_updates=-1
encoder_embed_path=None
adam_eps=1e-08
model_parallel_size=1
sentence_avg=False
encoder_layers=12
decoder_ffn_embed_dim=4096
dataset_impl=None
criterion=label_smoothed_cross_entropy
fixed_validation_seed=None
profile=False
distributed_rank=0
source_lang=src
eval_tokenized_bleu=False
source_word_dropout=0.2
adaptive_softmax_dropout=0
syntax_model_file=None
checkpoint_suffix=
required_seq_len_multiple=1
no_save=False
use_syntax=True
probs_suffix=['probs']
decoder_learned_pos=True
decoder_input_dim=1024
memory_efficient_fp16=False
decoder_layers_to_keep=None
gat_attention_heads=4
bucket_cap_mb=25
checkpoint_shard_count=1
pipeline_model_parallel=False
encoder_normalize_before=False
keep_best_checkpoints=-1
no_token_positional_embeddings=False
pooler_activation_fn=tanh
shard_id=0
only_dsa=False
max_update=0
encoder_attention_heads=16
freeze_bart_parameters=True
tokenizer=None
total_num_update=1000000
pipeline_decoder_balance=None
quantization_config_path=None
broadcast_buffers=False
batch_size=None
maximize_best_checkpoint_metric=False
pooler_dropout=0.0
warmup_updates=2000
min_lr=-1.0
only_gnn=True
eval_bleu_detok=space
no_seed_provided=False
truncate_source=False
pipeline_balance=None
model=SynGEC
dataset=handwritten
augment=none
device=cuda
map_location=cuda
gpu_nums=8


Tue 10 Sep 2024 21:40:14 INFO [src] dictionary: 21132 types
Tue 10 Sep 2024 21:40:14 INFO [tgt] dictionary: 21132 types
Tue 10 Sep 2024 21:40:14 INFO [syntax label0] dictionary: 51 types
Tue 10 Sep 2024 21:40:14 INFO [src] dictionary: 21132 types
Tue 10 Sep 2024 21:40:14 INFO [tgt] dictionary: 21132 types
Tue 10 Sep 2024 21:40:14 INFO [syntax label0] dictionary: 51 types
Tue 10 Sep 2024 21:40:14 INFO loaded 123 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/valid.src-tgt.src
Tue 10 Sep 2024 21:40:14 INFO loaded 123 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/valid.src-tgt.tgt
Tue 10 Sep 2024 21:40:14 INFO ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin valid src-tgt 123 examples
Tue 10 Sep 2024 21:40:14 INFO loaded 123 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/valid.conll.src-tgt.src
Tue 10 Sep 2024 21:40:14 INFO loaded 123 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/valid.dpd.src-tgt.src
Tue 10 Sep 2024 21:40:14 INFO loaded 123 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/valid.probs.src-tgt.src
Tue 10 Sep 2024 21:40:14 INFO success! syntax types: 1, source conll lines: 123
Tue 10 Sep 2024 21:40:14 INFO loaded 981 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/train.src-tgt.src
Tue 10 Sep 2024 21:40:14 INFO loaded 981 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/train.src-tgt.tgt
Tue 10 Sep 2024 21:40:14 INFO ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin train src-tgt 981 examples
Tue 10 Sep 2024 21:40:14 INFO loaded 981 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/train.conll.src-tgt.src
Tue 10 Sep 2024 21:40:14 INFO loaded 981 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/train.dpd.src-tgt.src
Tue 10 Sep 2024 21:40:14 INFO loaded 981 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/train.probs.src-tgt.src
Tue 10 Sep 2024 21:40:14 INFO success! syntax types: 1, source conll lines: 981
Tue 10 Sep 2024 21:40:14 INFO loaded 123 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_test_with_syntax_bart/bin/test.conll.src-tgt.src
Tue 10 Sep 2024 21:40:14 INFO loaded 123 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_test_with_syntax_bart/bin/test.dpd.src-tgt.src
Tue 10 Sep 2024 21:40:14 INFO loaded 123 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_test_with_syntax_bart/bin/test.probs.src-tgt.src
Tue 10 Sep 2024 21:40:14 INFO success! syntax types: 1, source conll lines: 123
Tue 10 Sep 2024 21:40:23 INFO detected shared parameter: encoder.sentence_encoder.embed_tokens.weight <- decoder.embed_tokens.weight
Tue 10 Sep 2024 21:40:23 INFO detected shared parameter: encoder.sentence_encoder.embed_tokens.weight <- decoder.output_projection.weight
Tue 10 Sep 2024 21:40:23 INFO ***********************CUDA enviroments for all 1 workers***********************
Tue 10 Sep 2024 21:40:23 INFO rank   0: capabilities =  8.0  ; total memory = 79.151 GB ; name = NVIDIA A800 80GB PCIe                   
Tue 10 Sep 2024 21:40:23 INFO ***********************CUDA enviroments for all 1 workers***********************
Tue 10 Sep 2024 21:40:27 INFO loaded checkpoint ./gectoolkit/properties/model/SynGEC/preprocess/gopar/chinese_handwritten_bart_baseline/checkpoint_best.pt (epoch 25 @ 881 updates)
Tue 10 Sep 2024 21:40:27 INFO loading train data for epoch 25
Tue 10 Sep 2024 21:40:27 INFO loaded 981 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/train.src-tgt.src
Tue 10 Sep 2024 21:40:27 INFO loaded 981 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/train.src-tgt.tgt
Tue 10 Sep 2024 21:40:27 INFO ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin train src-tgt 981 examples
Tue 10 Sep 2024 21:40:27 INFO loaded 981 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/train.conll.src-tgt.src
Tue 10 Sep 2024 21:40:27 INFO loaded 981 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/train.dpd.src-tgt.src
Tue 10 Sep 2024 21:40:27 INFO loaded 981 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/train.probs.src-tgt.src
Tue 10 Sep 2024 21:40:27 INFO success! syntax types: 1, source conll lines: 981
Tue 10 Sep 2024 21:40:28 INFO SynGEC(
  (model): SyntaxEnhancedBARTModel(
    (encoder): SyntaxEnhancedTransformerEncoder(
      (sentence_encoder): SyntaxEnhancedSentenceTransformerEncoder(
        (dropout_module): FairseqDropout()
        (embed_tokens): Embedding(21132, 1024, padding_idx=1)
        (embed_positions): LearnedPositionalEmbedding(514, 1024, padding_idx=1)
        (layernorm_embedding): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        (layers): ModuleList(
          (0-11): 12 x DSATransformerEncoderLayer(
            (self_attn): DSAMultiheadAttention(
              (dropout_module): FairseqDropout()
              (k_proj): Linear(in_features=1024, out_features=1024, bias=True)
              (v_proj): Linear(in_features=1024, out_features=1024, bias=True)
              (q_proj): Linear(in_features=1024, out_features=1024, bias=True)
              (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
            )
            (self_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
            (dropout_module): FairseqDropout()
            (activation_dropout_module): FairseqDropout()
            (fc1): Linear(in_features=1024, out_features=4096, bias=True)
            (fc2): Linear(in_features=4096, out_features=1024, bias=True)
            (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
      )
      (syntax_encoder): SyntaxEnhancedSyntaxGuidedTransformerEncoder(
        (dropout_module): FairseqDropout()
        (embed_tokens): Embedding(51, 1024, padding_idx=0)
        (layers): ModuleList(
          (0-2): 3 x GCNSyntaxGuidedTransformerEncoderLayer(
            (gcn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
            (dropout_module): FairseqDropout()
            (activation_dropout_module): FairseqDropout()
            (W_out): Linear(in_features=2048, out_features=1024, bias=True)
            (W_in): Linear(in_features=2048, out_features=1024, bias=True)
            (fc): Linear(in_features=1024, out_features=1024, bias=True)
            (fc1): Linear(in_features=1024, out_features=4096, bias=True)
            (fc2): Linear(in_features=4096, out_features=1024, bias=True)
            (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
      )
    )
    (decoder): SyntaxEnhancedTransformerDecoder(
      (dropout_module): FairseqDropout()
      (embed_tokens): Embedding(21132, 1024, padding_idx=1)
      (embed_positions): LearnedPositionalEmbedding(514, 1024, padding_idx=1)
      (layernorm_embedding): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      (layers): ModuleList(
        (0-11): 12 x TransformerDecoderLayer(
          (dropout_module): FairseqDropout()
          (self_attn): MultiheadAttention(
            (dropout_module): FairseqDropout()
            (k_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (v_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (q_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
          )
          (activation_dropout_module): FairseqDropout()
          (self_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          (encoder_attn): MultiheadAttention(
            (dropout_module): FairseqDropout()
            (k_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (v_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (q_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
          )
          (encoder_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          (fc1): Linear(in_features=1024, out_features=4096, bias=True)
          (fc2): Linear(in_features=4096, out_features=1024, bias=True)
          (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        )
      )
      (output_projection): Linear(in_features=1024, out_features=21132, bias=False)
    )
    (classification_heads): ModuleDict()
  )
  (criterion): LabelSmoothedCrossEntropyCriterion()
)
Tue 10 Sep 2024 21:40:28 INFO start training...
Tue 10 Sep 2024 21:40:29 INFO | supervised_trainer |NOTE: overflow detected, setting loss scale to: 64.0
Tue 10 Sep 2024 21:40:30 INFO | supervised_trainer |NOTE: overflow detected, setting loss scale to: 32.0
Tue 10 Sep 2024 21:40:30 INFO | supervised_trainer |NOTE: overflow detected, setting loss scale to: 16.0
Tue 10 Sep 2024 21:40:32 INFO | supervised_trainer |NOTE: overflow detected, setting loss scale to: 8.0
Tue 10 Sep 2024 21:40:32 INFO | supervised_trainer |NOTE: overflow detected, setting loss scale to: 4.0
Tue 10 Sep 2024 21:40:34 INFO epoch [  1] train time 0h 0m 6s |  loss |[6870.534]
Tue 10 Sep 2024 21:43:13 INFO random_seed=2023
use_gpu=True
learning_rate=6e-05
train_batch_size=32
test_batch_size=1
epoch_nums=200
test_step=10
display_train_step=1
gpu_id=5
training_resume=False
load_best_config=False
supervising_mode=fully_supervised
validset_divide=True
test_only=False
shuffle=True
model_config_file=gectoolkit/properties/model/SynGEC.json
best_config_file=gectoolkit/properties/best_config/SynGEC_handwritten.json
dataset_config_file=gectoolkit/properties/dataset/handwritten.json
dataset_dir=dataset/handwritten
checkpoint_file=checkpoint/SynGEC-handwritten.pth
log_file=log/SynGEC-handwritten.log
output_dir=result/SynGEC-handwritten
checkpoint_dir=checkpoint/SynGEC-handwritten
min_word_keep=5
min_generate_keep=5
language=zh
fp16_init_scale=128
distributed_port=-1
decoder_embed_path=None
quant_noise_pq_block_size=8
best_checkpoint_metric=loss
cross_self_attention=False
validate_interval=1
tie_adaptive_weights=False
bpe=None
decoder_normalize_before=False
cpu=False
optimizer_overrides={}
quant_noise_pq=0
lr_scheduler=polynomial_decay
no_save_optimizer_state=False
train_subset=train
no_cross_attention=False
distributed_world_size=1
decoder_layerdrop=0
skip_invalid_size_inputs_valid_test=True
lr=[0.0005]
slowmo_momentum=None
log_interval=100
user_dir=./gectoolkit/model/SynGEC/src/src_syngec/syngec_model
min_loss_scale=0.0001
dual_aggregation_freeze=True
decoder_output_dim=1024
curriculum=0
scoring=bleu
optimizer=adam
adam_betas=(0.9,0.999)
share_decoder_input_output_embed=True
fp16_no_flatten_grads=False
distributed_backend=nccl
adaptive_input=False
dpd_suffix=['dpd']
attention_dropout=0.0
fp16=True
pipeline_checkpoint=never
fix_batches_to_gpus=False
fp16_scale_tolerance=0.0
valid_subset=valid
gen_subset=test
no_last_checkpoints=False
decoder_attention_heads=16
distributed_wrapper=DDP
activation_dropout=0.0
log_format=tqdm
decoder_embed_dim=1024
dual_aggregation_beta=0.5
disable_validation=False
quant_noise_scalar=0
use_bmuf=False
gat_encoder_layers=3
arch=syntax_enhanced_bart_large
eval_bleu_print_samples=False
no_scale_embedding=True
zero_sharding=none
pipeline_decoder_devices=None
save_interval_updates=0
localsgd_frequency=3
ignore_prefix_size=0
eval_bleu_args=None
encoder_layerdrop=0
syntax_type=['dep']
distributed_no_spawn=False
left_pad_source=True
decoder_layers=12
adaptive_softmax_cutoff=None
upsample_primary=1
ddp_backend=c10d
validate_after_updates=0
power=1.0
data_buffer_size=10
memory_efficient_bf16=False
num_batch_buckets=0
share_all_embeddings=True
alpha=1.0
gated_sum=False
distributed_init_method=None
report_accuracy=False
end_learning_rate=0.0
batch_size_valid=None
pipeline_devices=None
left_pad_target=False
source_word_dropout_probs=False
bf16=False
swm_suffix=swm
encoder_embed_dim=1024
force_anneal=None
no_epoch_checkpoints=False
syntax_encoder=GCN
encoder_ffn_embed_dim=4096
label_smoothing=0.1
num_shards=1
find_unused_parameters=True
no_progress_bar=False
load_alignments=False
use_old_adam=False
eval_bleu_detok_args=None
tensorboard_logdir=None
slowmo_algorithm=LocalSGD
fast_stat_sync=False
layernorm_embedding=True
encoder_layers_to_keep=None
eval_bleu_remove_bpe=None
scale_syntax_encoder_lr=None
eval_bleu=False
fp16_scale_window=None
pipeline_encoder_balance=None
pipeline_encoder_devices=None
relu_dropout=0.0
threshold_loss_scale=None
activation_fn=gelu
task=syntax-enhanced-translation
target_lang=tgt
bart_model_file_from_transformers=None
all_gather_list_size=16384
stop_time_hours=0
validate_interval_updates=0
save_interval=1
conll_suffix=['conll']
empty_cache_freq=0
encoder_learned_pos=True
tpu=False
nprocs_per_node=1
keep_last_epochs=10
device_id=0
source_lang_with_nt=src_nt
use_dpd=False
pipeline_chunks=0
cross_syntax_fuse=False
keep_interval_updates=-1
encoder_embed_path=None
adam_eps=1e-08
model_parallel_size=1
sentence_avg=False
encoder_layers=12
decoder_ffn_embed_dim=4096
dataset_impl=None
criterion=label_smoothed_cross_entropy
fixed_validation_seed=None
profile=False
distributed_rank=0
source_lang=src
eval_tokenized_bleu=False
source_word_dropout=0.2
adaptive_softmax_dropout=0
syntax_model_file=None
checkpoint_suffix=
required_seq_len_multiple=1
no_save=False
use_syntax=True
probs_suffix=['probs']
decoder_learned_pos=True
decoder_input_dim=1024
memory_efficient_fp16=False
decoder_layers_to_keep=None
gat_attention_heads=4
bucket_cap_mb=25
checkpoint_shard_count=1
pipeline_model_parallel=False
encoder_normalize_before=False
keep_best_checkpoints=-1
no_token_positional_embeddings=False
pooler_activation_fn=tanh
shard_id=0
only_dsa=False
max_update=0
encoder_attention_heads=16
freeze_bart_parameters=True
tokenizer=None
total_num_update=1000000
pipeline_decoder_balance=None
quantization_config_path=None
broadcast_buffers=False
batch_size=None
maximize_best_checkpoint_metric=False
pooler_dropout=0.0
warmup_updates=2000
min_lr=-1.0
only_gnn=True
eval_bleu_detok=space
no_seed_provided=False
truncate_source=False
pipeline_balance=None
model=SynGEC
dataset=handwritten
augment=none
device=cuda
map_location=cuda
gpu_nums=8


Tue 10 Sep 2024 21:43:13 INFO [src] dictionary: 21132 types
Tue 10 Sep 2024 21:43:13 INFO [tgt] dictionary: 21132 types
Tue 10 Sep 2024 21:43:13 INFO [syntax label0] dictionary: 51 types
Tue 10 Sep 2024 21:43:13 INFO [src] dictionary: 21132 types
Tue 10 Sep 2024 21:43:13 INFO [tgt] dictionary: 21132 types
Tue 10 Sep 2024 21:43:13 INFO [syntax label0] dictionary: 51 types
Tue 10 Sep 2024 21:43:13 INFO loaded 123 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/valid.src-tgt.src
Tue 10 Sep 2024 21:43:13 INFO loaded 123 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/valid.src-tgt.tgt
Tue 10 Sep 2024 21:43:13 INFO ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin valid src-tgt 123 examples
Tue 10 Sep 2024 21:43:13 INFO loaded 123 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/valid.conll.src-tgt.src
Tue 10 Sep 2024 21:43:13 INFO loaded 123 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/valid.dpd.src-tgt.src
Tue 10 Sep 2024 21:43:13 INFO loaded 123 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/valid.probs.src-tgt.src
Tue 10 Sep 2024 21:43:13 INFO success! syntax types: 1, source conll lines: 123
Tue 10 Sep 2024 21:43:13 INFO loaded 981 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/train.src-tgt.src
Tue 10 Sep 2024 21:43:13 INFO loaded 981 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/train.src-tgt.tgt
Tue 10 Sep 2024 21:43:13 INFO ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin train src-tgt 981 examples
Tue 10 Sep 2024 21:43:13 INFO loaded 981 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/train.conll.src-tgt.src
Tue 10 Sep 2024 21:43:13 INFO loaded 981 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/train.dpd.src-tgt.src
Tue 10 Sep 2024 21:43:13 INFO loaded 981 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/train.probs.src-tgt.src
Tue 10 Sep 2024 21:43:13 INFO success! syntax types: 1, source conll lines: 981
Tue 10 Sep 2024 21:43:13 INFO loaded 123 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_test_with_syntax_bart/bin/test.conll.src-tgt.src
Tue 10 Sep 2024 21:43:13 INFO loaded 123 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_test_with_syntax_bart/bin/test.dpd.src-tgt.src
Tue 10 Sep 2024 21:43:13 INFO loaded 123 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_test_with_syntax_bart/bin/test.probs.src-tgt.src
Tue 10 Sep 2024 21:43:13 INFO success! syntax types: 1, source conll lines: 123
Tue 10 Sep 2024 21:43:22 INFO detected shared parameter: encoder.sentence_encoder.embed_tokens.weight <- decoder.embed_tokens.weight
Tue 10 Sep 2024 21:43:22 INFO detected shared parameter: encoder.sentence_encoder.embed_tokens.weight <- decoder.output_projection.weight
Tue 10 Sep 2024 21:43:22 INFO ***********************CUDA enviroments for all 1 workers***********************
Tue 10 Sep 2024 21:43:22 INFO rank   0: capabilities =  8.0  ; total memory = 79.151 GB ; name = NVIDIA A800 80GB PCIe                   
Tue 10 Sep 2024 21:43:22 INFO ***********************CUDA enviroments for all 1 workers***********************
Tue 10 Sep 2024 21:43:26 INFO loaded checkpoint ./gectoolkit/properties/model/SynGEC/preprocess/gopar/chinese_handwritten_bart_baseline/checkpoint_best.pt (epoch 25 @ 881 updates)
Tue 10 Sep 2024 21:43:26 INFO loading train data for epoch 25
Tue 10 Sep 2024 21:43:26 INFO loaded 981 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/train.src-tgt.src
Tue 10 Sep 2024 21:43:26 INFO loaded 981 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/train.src-tgt.tgt
Tue 10 Sep 2024 21:43:26 INFO ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin train src-tgt 981 examples
Tue 10 Sep 2024 21:43:26 INFO loaded 981 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/train.conll.src-tgt.src
Tue 10 Sep 2024 21:43:26 INFO loaded 981 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/train.dpd.src-tgt.src
Tue 10 Sep 2024 21:43:26 INFO loaded 981 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/train.probs.src-tgt.src
Tue 10 Sep 2024 21:43:26 INFO success! syntax types: 1, source conll lines: 981
Tue 10 Sep 2024 21:43:28 INFO SynGEC(
  (model): SyntaxEnhancedBARTModel(
    (encoder): SyntaxEnhancedTransformerEncoder(
      (sentence_encoder): SyntaxEnhancedSentenceTransformerEncoder(
        (dropout_module): FairseqDropout()
        (embed_tokens): Embedding(21132, 1024, padding_idx=1)
        (embed_positions): LearnedPositionalEmbedding(514, 1024, padding_idx=1)
        (layernorm_embedding): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        (layers): ModuleList(
          (0-11): 12 x DSATransformerEncoderLayer(
            (self_attn): DSAMultiheadAttention(
              (dropout_module): FairseqDropout()
              (k_proj): Linear(in_features=1024, out_features=1024, bias=True)
              (v_proj): Linear(in_features=1024, out_features=1024, bias=True)
              (q_proj): Linear(in_features=1024, out_features=1024, bias=True)
              (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
            )
            (self_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
            (dropout_module): FairseqDropout()
            (activation_dropout_module): FairseqDropout()
            (fc1): Linear(in_features=1024, out_features=4096, bias=True)
            (fc2): Linear(in_features=4096, out_features=1024, bias=True)
            (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
      )
      (syntax_encoder): SyntaxEnhancedSyntaxGuidedTransformerEncoder(
        (dropout_module): FairseqDropout()
        (embed_tokens): Embedding(51, 1024, padding_idx=0)
        (layers): ModuleList(
          (0-2): 3 x GCNSyntaxGuidedTransformerEncoderLayer(
            (gcn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
            (dropout_module): FairseqDropout()
            (activation_dropout_module): FairseqDropout()
            (W_out): Linear(in_features=2048, out_features=1024, bias=True)
            (W_in): Linear(in_features=2048, out_features=1024, bias=True)
            (fc): Linear(in_features=1024, out_features=1024, bias=True)
            (fc1): Linear(in_features=1024, out_features=4096, bias=True)
            (fc2): Linear(in_features=4096, out_features=1024, bias=True)
            (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
      )
    )
    (decoder): SyntaxEnhancedTransformerDecoder(
      (dropout_module): FairseqDropout()
      (embed_tokens): Embedding(21132, 1024, padding_idx=1)
      (embed_positions): LearnedPositionalEmbedding(514, 1024, padding_idx=1)
      (layernorm_embedding): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      (layers): ModuleList(
        (0-11): 12 x TransformerDecoderLayer(
          (dropout_module): FairseqDropout()
          (self_attn): MultiheadAttention(
            (dropout_module): FairseqDropout()
            (k_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (v_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (q_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
          )
          (activation_dropout_module): FairseqDropout()
          (self_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          (encoder_attn): MultiheadAttention(
            (dropout_module): FairseqDropout()
            (k_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (v_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (q_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
          )
          (encoder_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          (fc1): Linear(in_features=1024, out_features=4096, bias=True)
          (fc2): Linear(in_features=4096, out_features=1024, bias=True)
          (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        )
      )
      (output_projection): Linear(in_features=1024, out_features=21132, bias=False)
    )
    (classification_heads): ModuleDict()
  )
  (criterion): LabelSmoothedCrossEntropyCriterion()
)
Tue 10 Sep 2024 21:43:28 INFO start training...
Tue 10 Sep 2024 21:43:28 INFO | supervised_trainer |NOTE: overflow detected, setting loss scale to: 64.0
Tue 10 Sep 2024 21:43:29 INFO | supervised_trainer |NOTE: overflow detected, setting loss scale to: 32.0
Tue 10 Sep 2024 21:43:29 INFO | supervised_trainer |NOTE: overflow detected, setting loss scale to: 16.0
Tue 10 Sep 2024 21:43:31 INFO | supervised_trainer |NOTE: overflow detected, setting loss scale to: 8.0
Tue 10 Sep 2024 21:43:32 INFO | supervised_trainer |NOTE: overflow detected, setting loss scale to: 4.0
Tue 10 Sep 2024 21:43:34 INFO epoch [  1] train time 0h 0m 6s |  loss |[6870.534]
Tue 10 Sep 2024 21:46:56 INFO random_seed=2023
use_gpu=True
learning_rate=6e-05
train_batch_size=32
test_batch_size=1
epoch_nums=200
test_step=10
display_train_step=1
gpu_id=5
training_resume=False
load_best_config=False
supervising_mode=fully_supervised
validset_divide=True
test_only=False
shuffle=True
model_config_file=gectoolkit/properties/model/SynGEC.json
best_config_file=gectoolkit/properties/best_config/SynGEC_handwritten.json
dataset_config_file=gectoolkit/properties/dataset/handwritten.json
dataset_dir=dataset/handwritten
checkpoint_file=checkpoint/SynGEC-handwritten.pth
log_file=log/SynGEC-handwritten.log
output_dir=result/SynGEC-handwritten
checkpoint_dir=checkpoint/SynGEC-handwritten
min_word_keep=5
min_generate_keep=5
language=zh
fp16_init_scale=128
distributed_port=-1
decoder_embed_path=None
quant_noise_pq_block_size=8
best_checkpoint_metric=loss
cross_self_attention=False
validate_interval=1
tie_adaptive_weights=False
bpe=None
decoder_normalize_before=False
cpu=False
optimizer_overrides={}
quant_noise_pq=0
lr_scheduler=polynomial_decay
no_save_optimizer_state=False
train_subset=train
no_cross_attention=False
distributed_world_size=1
decoder_layerdrop=0
skip_invalid_size_inputs_valid_test=True
lr=[0.0005]
slowmo_momentum=None
log_interval=100
user_dir=./gectoolkit/model/SynGEC/src/src_syngec/syngec_model
min_loss_scale=0.0001
dual_aggregation_freeze=True
decoder_output_dim=1024
curriculum=0
scoring=bleu
optimizer=adam
adam_betas=(0.9,0.999)
share_decoder_input_output_embed=True
fp16_no_flatten_grads=False
distributed_backend=nccl
adaptive_input=False
dpd_suffix=['dpd']
attention_dropout=0.0
fp16=True
pipeline_checkpoint=never
fix_batches_to_gpus=False
fp16_scale_tolerance=0.0
valid_subset=valid
gen_subset=test
no_last_checkpoints=False
decoder_attention_heads=16
distributed_wrapper=DDP
activation_dropout=0.0
log_format=tqdm
decoder_embed_dim=1024
dual_aggregation_beta=0.5
disable_validation=False
quant_noise_scalar=0
use_bmuf=False
gat_encoder_layers=3
arch=syntax_enhanced_bart_large
eval_bleu_print_samples=False
no_scale_embedding=True
zero_sharding=none
pipeline_decoder_devices=None
save_interval_updates=0
localsgd_frequency=3
ignore_prefix_size=0
eval_bleu_args=None
encoder_layerdrop=0
syntax_type=['dep']
distributed_no_spawn=False
left_pad_source=True
decoder_layers=12
adaptive_softmax_cutoff=None
upsample_primary=1
ddp_backend=c10d
validate_after_updates=0
power=1.0
data_buffer_size=10
memory_efficient_bf16=False
num_batch_buckets=0
share_all_embeddings=True
alpha=1.0
gated_sum=False
distributed_init_method=None
report_accuracy=False
end_learning_rate=0.0
batch_size_valid=None
pipeline_devices=None
left_pad_target=False
source_word_dropout_probs=False
bf16=False
swm_suffix=swm
encoder_embed_dim=1024
force_anneal=None
no_epoch_checkpoints=False
syntax_encoder=GCN
encoder_ffn_embed_dim=4096
label_smoothing=0.1
num_shards=1
find_unused_parameters=True
no_progress_bar=False
load_alignments=False
use_old_adam=False
eval_bleu_detok_args=None
tensorboard_logdir=None
slowmo_algorithm=LocalSGD
fast_stat_sync=False
layernorm_embedding=True
encoder_layers_to_keep=None
eval_bleu_remove_bpe=None
scale_syntax_encoder_lr=None
eval_bleu=False
fp16_scale_window=None
pipeline_encoder_balance=None
pipeline_encoder_devices=None
relu_dropout=0.0
threshold_loss_scale=None
activation_fn=gelu
task=syntax-enhanced-translation
target_lang=tgt
bart_model_file_from_transformers=None
all_gather_list_size=16384
stop_time_hours=0
validate_interval_updates=0
save_interval=1
conll_suffix=['conll']
empty_cache_freq=0
encoder_learned_pos=True
tpu=False
nprocs_per_node=1
keep_last_epochs=10
device_id=0
source_lang_with_nt=src_nt
use_dpd=False
pipeline_chunks=0
cross_syntax_fuse=False
keep_interval_updates=-1
encoder_embed_path=None
adam_eps=1e-08
model_parallel_size=1
sentence_avg=False
encoder_layers=12
decoder_ffn_embed_dim=4096
dataset_impl=None
criterion=label_smoothed_cross_entropy
fixed_validation_seed=None
profile=False
distributed_rank=0
source_lang=src
eval_tokenized_bleu=False
source_word_dropout=0.2
adaptive_softmax_dropout=0
syntax_model_file=None
checkpoint_suffix=
required_seq_len_multiple=1
no_save=False
use_syntax=True
probs_suffix=['probs']
decoder_learned_pos=True
decoder_input_dim=1024
memory_efficient_fp16=False
decoder_layers_to_keep=None
gat_attention_heads=4
bucket_cap_mb=25
checkpoint_shard_count=1
pipeline_model_parallel=False
encoder_normalize_before=False
keep_best_checkpoints=-1
no_token_positional_embeddings=False
pooler_activation_fn=tanh
shard_id=0
only_dsa=False
max_update=0
encoder_attention_heads=16
freeze_bart_parameters=True
tokenizer=None
total_num_update=1000000
pipeline_decoder_balance=None
quantization_config_path=None
broadcast_buffers=False
batch_size=None
maximize_best_checkpoint_metric=False
pooler_dropout=0.0
warmup_updates=2000
min_lr=-1.0
only_gnn=True
eval_bleu_detok=space
no_seed_provided=False
truncate_source=False
pipeline_balance=None
model=SynGEC
dataset=handwritten
augment=none
device=cuda
map_location=cuda
gpu_nums=8


Tue 10 Sep 2024 21:46:56 INFO [src] dictionary: 21132 types
Tue 10 Sep 2024 21:46:56 INFO [tgt] dictionary: 21132 types
Tue 10 Sep 2024 21:46:56 INFO [syntax label0] dictionary: 51 types
Tue 10 Sep 2024 21:46:56 INFO [src] dictionary: 21132 types
Tue 10 Sep 2024 21:46:56 INFO [tgt] dictionary: 21132 types
Tue 10 Sep 2024 21:46:56 INFO [syntax label0] dictionary: 51 types
Tue 10 Sep 2024 21:46:56 INFO loaded 123 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/valid.src-tgt.src
Tue 10 Sep 2024 21:46:56 INFO loaded 123 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/valid.src-tgt.tgt
Tue 10 Sep 2024 21:46:56 INFO ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin valid src-tgt 123 examples
Tue 10 Sep 2024 21:46:56 INFO loaded 123 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/valid.conll.src-tgt.src
Tue 10 Sep 2024 21:46:56 INFO loaded 123 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/valid.dpd.src-tgt.src
Tue 10 Sep 2024 21:46:56 INFO loaded 123 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/valid.probs.src-tgt.src
Tue 10 Sep 2024 21:46:56 INFO success! syntax types: 1, source conll lines: 123
Tue 10 Sep 2024 21:46:56 INFO loaded 981 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/train.src-tgt.src
Tue 10 Sep 2024 21:46:56 INFO loaded 981 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/train.src-tgt.tgt
Tue 10 Sep 2024 21:46:56 INFO ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin train src-tgt 981 examples
Tue 10 Sep 2024 21:46:56 INFO loaded 981 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/train.conll.src-tgt.src
Tue 10 Sep 2024 21:46:56 INFO loaded 981 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/train.dpd.src-tgt.src
Tue 10 Sep 2024 21:46:56 INFO loaded 981 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/train.probs.src-tgt.src
Tue 10 Sep 2024 21:46:56 INFO success! syntax types: 1, source conll lines: 981
Tue 10 Sep 2024 21:46:56 INFO loaded 123 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_test_with_syntax_bart/bin/test.conll.src-tgt.src
Tue 10 Sep 2024 21:46:56 INFO loaded 123 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_test_with_syntax_bart/bin/test.dpd.src-tgt.src
Tue 10 Sep 2024 21:46:56 INFO loaded 123 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_test_with_syntax_bart/bin/test.probs.src-tgt.src
Tue 10 Sep 2024 21:46:56 INFO success! syntax types: 1, source conll lines: 123
Tue 10 Sep 2024 21:47:05 INFO detected shared parameter: encoder.sentence_encoder.embed_tokens.weight <- decoder.embed_tokens.weight
Tue 10 Sep 2024 21:47:05 INFO detected shared parameter: encoder.sentence_encoder.embed_tokens.weight <- decoder.output_projection.weight
Tue 10 Sep 2024 21:47:05 INFO ***********************CUDA enviroments for all 1 workers***********************
Tue 10 Sep 2024 21:47:05 INFO rank   0: capabilities =  8.0  ; total memory = 79.151 GB ; name = NVIDIA A800 80GB PCIe                   
Tue 10 Sep 2024 21:47:05 INFO ***********************CUDA enviroments for all 1 workers***********************
Tue 10 Sep 2024 21:47:09 INFO loaded checkpoint ./gectoolkit/properties/model/SynGEC/preprocess/gopar/chinese_handwritten_bart_baseline/checkpoint_best.pt (epoch 25 @ 881 updates)
Tue 10 Sep 2024 21:47:09 INFO loading train data for epoch 25
Tue 10 Sep 2024 21:47:09 INFO loaded 981 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/train.src-tgt.src
Tue 10 Sep 2024 21:47:09 INFO loaded 981 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/train.src-tgt.tgt
Tue 10 Sep 2024 21:47:09 INFO ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin train src-tgt 981 examples
Tue 10 Sep 2024 21:47:09 INFO loaded 981 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/train.conll.src-tgt.src
Tue 10 Sep 2024 21:47:09 INFO loaded 981 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/train.dpd.src-tgt.src
Tue 10 Sep 2024 21:47:09 INFO loaded 981 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/train.probs.src-tgt.src
Tue 10 Sep 2024 21:47:09 INFO success! syntax types: 1, source conll lines: 981
Tue 10 Sep 2024 21:47:10 INFO SynGEC(
  (model): SyntaxEnhancedBARTModel(
    (encoder): SyntaxEnhancedTransformerEncoder(
      (sentence_encoder): SyntaxEnhancedSentenceTransformerEncoder(
        (dropout_module): FairseqDropout()
        (embed_tokens): Embedding(21132, 1024, padding_idx=1)
        (embed_positions): LearnedPositionalEmbedding(514, 1024, padding_idx=1)
        (layernorm_embedding): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        (layers): ModuleList(
          (0-11): 12 x DSATransformerEncoderLayer(
            (self_attn): DSAMultiheadAttention(
              (dropout_module): FairseqDropout()
              (k_proj): Linear(in_features=1024, out_features=1024, bias=True)
              (v_proj): Linear(in_features=1024, out_features=1024, bias=True)
              (q_proj): Linear(in_features=1024, out_features=1024, bias=True)
              (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
            )
            (self_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
            (dropout_module): FairseqDropout()
            (activation_dropout_module): FairseqDropout()
            (fc1): Linear(in_features=1024, out_features=4096, bias=True)
            (fc2): Linear(in_features=4096, out_features=1024, bias=True)
            (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
      )
      (syntax_encoder): SyntaxEnhancedSyntaxGuidedTransformerEncoder(
        (dropout_module): FairseqDropout()
        (embed_tokens): Embedding(51, 1024, padding_idx=0)
        (layers): ModuleList(
          (0-2): 3 x GCNSyntaxGuidedTransformerEncoderLayer(
            (gcn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
            (dropout_module): FairseqDropout()
            (activation_dropout_module): FairseqDropout()
            (W_out): Linear(in_features=2048, out_features=1024, bias=True)
            (W_in): Linear(in_features=2048, out_features=1024, bias=True)
            (fc): Linear(in_features=1024, out_features=1024, bias=True)
            (fc1): Linear(in_features=1024, out_features=4096, bias=True)
            (fc2): Linear(in_features=4096, out_features=1024, bias=True)
            (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
      )
    )
    (decoder): SyntaxEnhancedTransformerDecoder(
      (dropout_module): FairseqDropout()
      (embed_tokens): Embedding(21132, 1024, padding_idx=1)
      (embed_positions): LearnedPositionalEmbedding(514, 1024, padding_idx=1)
      (layernorm_embedding): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      (layers): ModuleList(
        (0-11): 12 x TransformerDecoderLayer(
          (dropout_module): FairseqDropout()
          (self_attn): MultiheadAttention(
            (dropout_module): FairseqDropout()
            (k_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (v_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (q_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
          )
          (activation_dropout_module): FairseqDropout()
          (self_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          (encoder_attn): MultiheadAttention(
            (dropout_module): FairseqDropout()
            (k_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (v_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (q_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
          )
          (encoder_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          (fc1): Linear(in_features=1024, out_features=4096, bias=True)
          (fc2): Linear(in_features=4096, out_features=1024, bias=True)
          (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        )
      )
      (output_projection): Linear(in_features=1024, out_features=21132, bias=False)
    )
    (classification_heads): ModuleDict()
  )
  (criterion): LabelSmoothedCrossEntropyCriterion()
)
Tue 10 Sep 2024 21:47:10 INFO start training...
Tue 10 Sep 2024 21:47:11 INFO | supervised_trainer |NOTE: overflow detected, setting loss scale to: 64.0
Tue 10 Sep 2024 21:47:12 INFO | supervised_trainer |NOTE: overflow detected, setting loss scale to: 32.0
Tue 10 Sep 2024 21:47:12 INFO | supervised_trainer |NOTE: overflow detected, setting loss scale to: 16.0
Tue 10 Sep 2024 21:47:14 INFO | supervised_trainer |NOTE: overflow detected, setting loss scale to: 8.0
Tue 10 Sep 2024 21:47:15 INFO | supervised_trainer |NOTE: overflow detected, setting loss scale to: 4.0
Tue 10 Sep 2024 21:47:17 INFO epoch [  1] train time 0h 0m 6s |  loss |[6870.534]
Tue 10 Sep 2024 21:57:10 INFO random_seed=2023
use_gpu=True
learning_rate=6e-05
train_batch_size=32
test_batch_size=1
epoch_nums=200
test_step=10
display_train_step=1
gpu_id=5
training_resume=False
load_best_config=False
supervising_mode=fully_supervised
validset_divide=True
test_only=False
shuffle=True
model_config_file=gectoolkit/properties/model/SynGEC.json
best_config_file=gectoolkit/properties/best_config/SynGEC_handwritten.json
dataset_config_file=gectoolkit/properties/dataset/handwritten.json
dataset_dir=dataset/handwritten
checkpoint_file=checkpoint/SynGEC-handwritten.pth
log_file=log/SynGEC-handwritten.log
output_dir=result/SynGEC-handwritten
checkpoint_dir=checkpoint/SynGEC-handwritten
min_word_keep=5
min_generate_keep=5
language=zh
fp16_init_scale=128
distributed_port=-1
decoder_embed_path=None
quant_noise_pq_block_size=8
best_checkpoint_metric=loss
cross_self_attention=False
validate_interval=1
tie_adaptive_weights=False
bpe=None
decoder_normalize_before=False
cpu=False
optimizer_overrides={}
quant_noise_pq=0
lr_scheduler=polynomial_decay
no_save_optimizer_state=False
train_subset=train
no_cross_attention=False
distributed_world_size=1
decoder_layerdrop=0
skip_invalid_size_inputs_valid_test=True
lr=[0.0005]
slowmo_momentum=None
log_interval=100
user_dir=./gectoolkit/model/SynGEC/src/src_syngec/syngec_model
min_loss_scale=0.0001
dual_aggregation_freeze=True
decoder_output_dim=1024
curriculum=0
scoring=bleu
optimizer=adam
adam_betas=(0.9,0.999)
share_decoder_input_output_embed=True
fp16_no_flatten_grads=False
distributed_backend=nccl
adaptive_input=False
dpd_suffix=['dpd']
attention_dropout=0.0
fp16=True
pipeline_checkpoint=never
fix_batches_to_gpus=False
fp16_scale_tolerance=0.0
valid_subset=valid
gen_subset=test
no_last_checkpoints=False
decoder_attention_heads=16
distributed_wrapper=DDP
activation_dropout=0.0
log_format=tqdm
decoder_embed_dim=1024
dual_aggregation_beta=0.5
disable_validation=False
quant_noise_scalar=0
use_bmuf=False
gat_encoder_layers=3
arch=syntax_enhanced_bart_large
eval_bleu_print_samples=False
no_scale_embedding=True
zero_sharding=none
pipeline_decoder_devices=None
save_interval_updates=0
localsgd_frequency=3
ignore_prefix_size=0
eval_bleu_args=None
encoder_layerdrop=0
syntax_type=['dep']
distributed_no_spawn=False
left_pad_source=True
decoder_layers=12
adaptive_softmax_cutoff=None
upsample_primary=1
ddp_backend=c10d
validate_after_updates=0
power=1.0
data_buffer_size=10
memory_efficient_bf16=False
num_batch_buckets=0
share_all_embeddings=True
alpha=1.0
gated_sum=False
distributed_init_method=None
report_accuracy=False
end_learning_rate=0.0
batch_size_valid=None
pipeline_devices=None
left_pad_target=False
source_word_dropout_probs=False
bf16=False
swm_suffix=swm
encoder_embed_dim=1024
force_anneal=None
no_epoch_checkpoints=False
syntax_encoder=GCN
encoder_ffn_embed_dim=4096
label_smoothing=0.1
num_shards=1
find_unused_parameters=True
no_progress_bar=False
load_alignments=False
use_old_adam=False
eval_bleu_detok_args=None
tensorboard_logdir=None
slowmo_algorithm=LocalSGD
fast_stat_sync=False
layernorm_embedding=True
encoder_layers_to_keep=None
eval_bleu_remove_bpe=None
scale_syntax_encoder_lr=None
eval_bleu=False
fp16_scale_window=None
pipeline_encoder_balance=None
pipeline_encoder_devices=None
relu_dropout=0.0
threshold_loss_scale=None
activation_fn=gelu
task=syntax-enhanced-translation
target_lang=tgt
bart_model_file_from_transformers=None
all_gather_list_size=16384
stop_time_hours=0
validate_interval_updates=0
save_interval=1
conll_suffix=['conll']
empty_cache_freq=0
encoder_learned_pos=True
tpu=False
nprocs_per_node=1
keep_last_epochs=10
device_id=0
source_lang_with_nt=src_nt
use_dpd=False
pipeline_chunks=0
cross_syntax_fuse=False
keep_interval_updates=-1
encoder_embed_path=None
adam_eps=1e-08
model_parallel_size=1
sentence_avg=False
encoder_layers=12
decoder_ffn_embed_dim=4096
dataset_impl=None
criterion=label_smoothed_cross_entropy
fixed_validation_seed=None
profile=False
distributed_rank=0
source_lang=src
eval_tokenized_bleu=False
source_word_dropout=0.2
adaptive_softmax_dropout=0
syntax_model_file=None
checkpoint_suffix=
required_seq_len_multiple=1
no_save=False
use_syntax=True
probs_suffix=['probs']
decoder_learned_pos=True
decoder_input_dim=1024
memory_efficient_fp16=False
decoder_layers_to_keep=None
gat_attention_heads=4
bucket_cap_mb=25
checkpoint_shard_count=1
pipeline_model_parallel=False
encoder_normalize_before=False
keep_best_checkpoints=-1
no_token_positional_embeddings=False
pooler_activation_fn=tanh
shard_id=0
only_dsa=False
max_update=0
encoder_attention_heads=16
freeze_bart_parameters=True
tokenizer=None
total_num_update=1000000
pipeline_decoder_balance=None
quantization_config_path=None
broadcast_buffers=False
batch_size=None
maximize_best_checkpoint_metric=False
pooler_dropout=0.0
warmup_updates=2000
min_lr=-1.0
only_gnn=True
eval_bleu_detok=space
no_seed_provided=False
truncate_source=False
pipeline_balance=None
model=SynGEC
dataset=handwritten
augment=none
device=cuda
map_location=cuda
gpu_nums=8


Tue 10 Sep 2024 21:57:10 INFO [src] dictionary: 21132 types
Tue 10 Sep 2024 21:57:10 INFO [tgt] dictionary: 21132 types
Tue 10 Sep 2024 21:57:10 INFO [syntax label0] dictionary: 51 types
Tue 10 Sep 2024 21:57:10 INFO [src] dictionary: 21132 types
Tue 10 Sep 2024 21:57:10 INFO [tgt] dictionary: 21132 types
Tue 10 Sep 2024 21:57:10 INFO [syntax label0] dictionary: 51 types
Tue 10 Sep 2024 21:57:10 INFO loaded 123 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/valid.src-tgt.src
Tue 10 Sep 2024 21:57:10 INFO loaded 123 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/valid.src-tgt.tgt
Tue 10 Sep 2024 21:57:10 INFO ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin valid src-tgt 123 examples
Tue 10 Sep 2024 21:57:10 INFO loaded 123 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/valid.conll.src-tgt.src
Tue 10 Sep 2024 21:57:10 INFO loaded 123 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/valid.dpd.src-tgt.src
Tue 10 Sep 2024 21:57:10 INFO loaded 123 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/valid.probs.src-tgt.src
Tue 10 Sep 2024 21:57:10 INFO success! syntax types: 1, source conll lines: 123
Tue 10 Sep 2024 21:57:10 INFO loaded 981 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/train.src-tgt.src
Tue 10 Sep 2024 21:57:10 INFO loaded 981 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/train.src-tgt.tgt
Tue 10 Sep 2024 21:57:10 INFO ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin train src-tgt 981 examples
Tue 10 Sep 2024 21:57:10 INFO loaded 981 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/train.conll.src-tgt.src
Tue 10 Sep 2024 21:57:10 INFO loaded 981 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/train.dpd.src-tgt.src
Tue 10 Sep 2024 21:57:10 INFO loaded 981 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/train.probs.src-tgt.src
Tue 10 Sep 2024 21:57:10 INFO success! syntax types: 1, source conll lines: 981
Tue 10 Sep 2024 21:57:10 INFO loaded 123 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_test_with_syntax_bart/bin/test.conll.src-tgt.src
Tue 10 Sep 2024 21:57:10 INFO loaded 123 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_test_with_syntax_bart/bin/test.dpd.src-tgt.src
Tue 10 Sep 2024 21:57:10 INFO loaded 123 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_test_with_syntax_bart/bin/test.probs.src-tgt.src
Tue 10 Sep 2024 21:57:10 INFO success! syntax types: 1, source conll lines: 123
Tue 10 Sep 2024 21:57:19 INFO detected shared parameter: encoder.sentence_encoder.embed_tokens.weight <- decoder.embed_tokens.weight
Tue 10 Sep 2024 21:57:19 INFO detected shared parameter: encoder.sentence_encoder.embed_tokens.weight <- decoder.output_projection.weight
Tue 10 Sep 2024 21:57:19 INFO ***********************CUDA enviroments for all 1 workers***********************
Tue 10 Sep 2024 21:57:19 INFO rank   0: capabilities =  8.0  ; total memory = 79.151 GB ; name = NVIDIA A800 80GB PCIe                   
Tue 10 Sep 2024 21:57:19 INFO ***********************CUDA enviroments for all 1 workers***********************
Tue 10 Sep 2024 21:57:23 INFO loaded checkpoint ./gectoolkit/properties/model/SynGEC/preprocess/gopar/chinese_handwritten_bart_baseline/checkpoint_best.pt (epoch 25 @ 881 updates)
Tue 10 Sep 2024 21:57:23 INFO loading train data for epoch 25
Tue 10 Sep 2024 21:57:23 INFO loaded 981 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/train.src-tgt.src
Tue 10 Sep 2024 21:57:23 INFO loaded 981 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/train.src-tgt.tgt
Tue 10 Sep 2024 21:57:23 INFO ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin train src-tgt 981 examples
Tue 10 Sep 2024 21:57:23 INFO loaded 981 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/train.conll.src-tgt.src
Tue 10 Sep 2024 21:57:23 INFO loaded 981 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/train.dpd.src-tgt.src
Tue 10 Sep 2024 21:57:23 INFO loaded 981 examples from: ./gectoolkit/properties/model/SynGEC/preprocess/preprocess_data/chinese_handwritten_with_syntax_bart/bin/train.probs.src-tgt.src
Tue 10 Sep 2024 21:57:23 INFO success! syntax types: 1, source conll lines: 981
Tue 10 Sep 2024 21:57:24 INFO SynGEC(
  (model): SyntaxEnhancedBARTModel(
    (encoder): SyntaxEnhancedTransformerEncoder(
      (sentence_encoder): SyntaxEnhancedSentenceTransformerEncoder(
        (dropout_module): FairseqDropout()
        (embed_tokens): Embedding(21132, 1024, padding_idx=1)
        (embed_positions): LearnedPositionalEmbedding(514, 1024, padding_idx=1)
        (layernorm_embedding): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        (layers): ModuleList(
          (0-11): 12 x DSATransformerEncoderLayer(
            (self_attn): DSAMultiheadAttention(
              (dropout_module): FairseqDropout()
              (k_proj): Linear(in_features=1024, out_features=1024, bias=True)
              (v_proj): Linear(in_features=1024, out_features=1024, bias=True)
              (q_proj): Linear(in_features=1024, out_features=1024, bias=True)
              (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
            )
            (self_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
            (dropout_module): FairseqDropout()
            (activation_dropout_module): FairseqDropout()
            (fc1): Linear(in_features=1024, out_features=4096, bias=True)
            (fc2): Linear(in_features=4096, out_features=1024, bias=True)
            (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
      )
      (syntax_encoder): SyntaxEnhancedSyntaxGuidedTransformerEncoder(
        (dropout_module): FairseqDropout()
        (embed_tokens): Embedding(51, 1024, padding_idx=0)
        (layers): ModuleList(
          (0-2): 3 x GCNSyntaxGuidedTransformerEncoderLayer(
            (gcn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
            (dropout_module): FairseqDropout()
            (activation_dropout_module): FairseqDropout()
            (W_out): Linear(in_features=2048, out_features=1024, bias=True)
            (W_in): Linear(in_features=2048, out_features=1024, bias=True)
            (fc): Linear(in_features=1024, out_features=1024, bias=True)
            (fc1): Linear(in_features=1024, out_features=4096, bias=True)
            (fc2): Linear(in_features=4096, out_features=1024, bias=True)
            (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
      )
    )
    (decoder): SyntaxEnhancedTransformerDecoder(
      (dropout_module): FairseqDropout()
      (embed_tokens): Embedding(21132, 1024, padding_idx=1)
      (embed_positions): LearnedPositionalEmbedding(514, 1024, padding_idx=1)
      (layernorm_embedding): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      (layers): ModuleList(
        (0-11): 12 x TransformerDecoderLayer(
          (dropout_module): FairseqDropout()
          (self_attn): MultiheadAttention(
            (dropout_module): FairseqDropout()
            (k_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (v_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (q_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
          )
          (activation_dropout_module): FairseqDropout()
          (self_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          (encoder_attn): MultiheadAttention(
            (dropout_module): FairseqDropout()
            (k_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (v_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (q_proj): Linear(in_features=1024, out_features=1024, bias=True)
            (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
          )
          (encoder_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          (fc1): Linear(in_features=1024, out_features=4096, bias=True)
          (fc2): Linear(in_features=4096, out_features=1024, bias=True)
          (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        )
      )
      (output_projection): Linear(in_features=1024, out_features=21132, bias=False)
    )
    (classification_heads): ModuleDict()
  )
  (criterion): LabelSmoothedCrossEntropyCriterion()
)
Tue 10 Sep 2024 21:57:24 INFO start training...
Tue 10 Sep 2024 21:57:25 INFO | supervised_trainer |NOTE: overflow detected, setting loss scale to: 64.0
Tue 10 Sep 2024 21:57:26 INFO | supervised_trainer |NOTE: overflow detected, setting loss scale to: 32.0
Tue 10 Sep 2024 21:57:26 INFO | supervised_trainer |NOTE: overflow detected, setting loss scale to: 16.0
Tue 10 Sep 2024 21:57:28 INFO | supervised_trainer |NOTE: overflow detected, setting loss scale to: 8.0
Tue 10 Sep 2024 21:57:29 INFO | supervised_trainer |NOTE: overflow detected, setting loss scale to: 4.0
Tue 10 Sep 2024 21:57:31 INFO epoch [  1] train time 0h 0m 6s |  loss |[6870.534]
